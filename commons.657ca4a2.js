(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{"+AAq":function(e,t,s){"use strict";s.d(t,"a",(function(){return r}));var o=s("Hs9Z"),i=s("/G9H"),n=s("yun6");const r=e=>{const{beatmap:t,modifier:s,showConvertMode:r=!1,showTitle:a=!0}=e,l=Object(n.d)(t.difficulty_rating),c=t.convert&&!r?"osu":t.mode;let u="beatmap-icon";null!=s&&(u+=` beatmap-icon--${s}`),a&&(u+=" beatmap-icon--with-hover js-beatmap-tooltip");const d=osu.diffColour(l);return i.createElement("div",{className:u,"data-beatmap-title":a?t.version:null,"data-difficulty":l,"data-stars":o.round(t.difficulty_rating,2),style:d},i.createElement("i",{className:`fal fa-extra-mode-${c}`}))}},"+FrL":function(e,t,s){"use strict";s.d(t,"a",(function(){return n}));s("/G9H");var o,i=s("I8Ok");o="value-display";var n=function(e){var t,s,n,r;return s=e.label,r=e.value,t=e.description,n=e.modifiers,Object(i.div)({className:osu.classWithModifiers(o,n)},Object(i.div)({className:o+"__label"},s),Object(i.div)({className:o+"__value"},r),null!=t?Object(i.div)({className:o+"__description"},t):void 0)}},"/cCk":function(e,t,s){"use strict";s.d(t,"a",(function(){return i}));var o=s("/G9H");class i extends o.PureComponent{constructor(){super(...arguments),this.eventId=`admin-menu-${osu.uuid()}`}render(){if(null==currentUser.id||!currentUser.is_admin)return null;const e=this.props.items.map(e=>o.createElement(e.component,Object.assign({key:`${e.icon}-${e.text}`,className:"admin-menu-item"},e.props),o.createElement("span",{className:"admin-menu-item__content"},o.createElement("span",{className:"admin-menu-item__label admin-menu-item__label--icon"},o.createElement("span",{className:e.icon})),o.createElement("span",{className:"admin-menu-item__label admin-menu-item__label--text"},e.text))));return o.createElement("div",{className:"admin-menu"},o.createElement("button",{className:"admin-menu__button js-menu","data-menu-target":`admin-menu-${this.eventId}`},o.createElement("span",{className:"fas fa-angle-up"}),o.createElement("span",{className:"admin-menu__button-icon fas fa-tools"})),o.createElement("div",{className:"admin-menu__menu js-menu","data-menu-id":`admin-menu-${this.eventId}`,"data-visibility":"hidden"},e))}}},"/cS6":function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return c}));var o=s("Hs9Z"),i=s("vcN5"),n=s("/G9H"),r=s("tSlR"),a=s("dTpI"),l=s("ss8h");class c extends n.Component{constructor(){super(...arguments),this.bn="beatmap-discussion-editor-insertion-menu",this.insertRef=n.createRef(),this.mouseOver=!1,this.throttledContainerMouseExit=o.throttle(()=>{setTimeout(this.hideMenu.bind(this),100)},10),this.throttledContainerMouseMove=o.throttle(this.containerMouseMove.bind(this),10),this.throttledMenuMouseEnter=o.throttle(this.menuMouseEnter.bind(this),10),this.throttledMenuMouseExit=o.throttle(this.menuMouseLeave.bind(this),10),this.throttledScroll=o.throttle(this.forceHideMenu.bind(this),10),this.uuid=osu.uuid(),this.insertBlock=e=>{var t,s,o,i,n,l;const c=this.context,u=null===(t=this.hoveredBlock)||void 0===t?void 0:t.lastChild,d=e.currentTarget.dataset.discussionType,p=null===(s=this.props.currentBeatmap)||void 0===s?void 0:s.id;let h;switch(d){case"suggestion":case"problem":case"praise":h={beatmapId:p,children:[{text:""}],discussionType:d,type:"embed"};break;case"paragraph":h={children:[{text:""}],type:"paragraph"}}if(!h||!u)return;let m,f=a.b.toSlateNode(c,u);if(r.g.isText(f)&&""===f.text||r.b.isElement(f)&&r.a.isEmpty(c,f))if("above"===this.insertPosition){const e=null===(i=null===(o=this.hoveredBlock)||void 0===o?void 0:o.previousSibling)||void 0===i?void 0:i.lastChild;null!=e?(f=a.b.toSlateNode(c,e),m=r.a.end(c,a.b.findPath(c,f))):m={path:[],offset:0}}else{const e=null===(l=null===(n=this.hoveredBlock)||void 0===n?void 0:n.previousSibling)||void 0===l?void 0:l.lastChild;null!=e?(f=a.b.toSlateNode(c,e),m=r.a.start(c,a.b.findPath(c,f))):m=r.a.end(c,[])}else{const e=a.b.findPath(c,f);m="above"===this.insertPosition?r.a.start(c,e):r.a.end(c,e)}r.h.insertNodes(c,h,{at:m})},this.insertButton=e=>{let t="fas fa-question";switch(e){case"praise":case"problem":case"suggestion":t=BeatmapDiscussionHelper.messageType.icon[e];break;case"paragraph":t="fas fa-indent"}return n.createElement("button",{className:`${this.bn}__menu-button ${this.bn}__menu-button--${e}`,"data-discussion-type":e,onClick:this.insertBlock,title:osu.trans(`beatmaps.discussions.review.insert-block.${e}`),type:"button"},n.createElement("i",{className:t}))}}componentDidMount(){this.insertRef.current&&(e(this.insertRef.current).on(`mouseenter.${this.uuid}`,this.throttledMenuMouseEnter),e(this.insertRef.current).on(`mouseleave.${this.uuid}`,this.throttledMenuMouseExit)),e(window).on(`scroll.${this.uuid}`,this.throttledScroll)}componentDidUpdate(){this.forceHideMenu()}componentWillUnmount(){e(window).off(`.${this.uuid}`),this.scrollContainer&&e(this.scrollContainer).off(`.${this.uuid}`),this.insertRef.current&&e(this.insertRef.current).off(`.${this.uuid}`)}containerMouseMove(e){if(!e.originalEvent)return;const t=e.originalEvent.clientY,s=this.scrollContainer.children[0].children;let o=0;for(const n of s){if(t<n.getBoundingClientRect().top){if(o>0){const e=s[o-1];t<e.getBoundingClientRect().top+e.getBoundingClientRect().height/2&&o--}break}o<s.length-1&&o++}this.hoveredBlock=s[o];const i=this.hoveredBlock.getBoundingClientRect();t>i.top+i.height/2?this.insertPosition="below":this.insertPosition="above",this.updatePosition(),this.showMenu(),this.startHideTimer()}forceHideMenu(){this.mouseOver=!1,this.hideMenu()}hideMenu(){this.insertRef.current&&!this.mouseOver&&(this.insertRef.current.style.display="none")}menuMouseEnter(){this.mouseOver=!0}menuMouseLeave(){this.mouseOver=!1,this.startHideTimer()}render(){return n.createElement(i.a,null,n.createElement("div",{ref:this.insertRef,className:`${this.bn}`},n.createElement("div",{className:`${this.bn}__body`},n.createElement("i",{className:"fas fa-plus"}),n.createElement("div",{className:`${this.bn}__buttons`},this.insertButton("suggestion"),this.insertButton("problem"),this.insertButton("praise"),this.insertButton("paragraph")))))}setScrollContainer(t){this.scrollContainer&&e(this.scrollContainer).off(`.${this.uuid}`),this.scrollContainer=t,e(this.scrollContainer).on(`mousemove.${this.uuid}`,this.throttledContainerMouseMove),e(this.scrollContainer).on(`mouseleave.${this.uuid}`,this.throttledContainerMouseExit),e(this.scrollContainer).on(`scroll.${this.uuid}`,this.throttledScroll)}showMenu(){this.insertRef.current&&(this.insertRef.current.style.display="flex")}startHideTimer(){this.hideInsertMenuTimer&&window.clearTimeout(this.hideInsertMenuTimer),this.hideInsertMenuTimer=window.setTimeout(this.hideMenu.bind(this),2e3)}updatePosition(){if(!this.scrollContainer||!this.hoveredBlock||!this.insertRef.current)return;const e=this.hoveredBlock.getBoundingClientRect(),t=this.scrollContainer.getBoundingClientRect();this.insertRef.current.style.left=`${t.left+15}px`,this.insertRef.current.style.width=`${t.width-30}px`,"above"===this.insertPosition?this.insertRef.current.style.top=`${e.top-10}px`:"below"===this.insertPosition&&(this.insertRef.current.style.top=`${e.top+e.height-10}px`)}}c.contextType=l.a}).call(this,s("5wds"))},"/jJF":function(e,t,s){"use strict";s.d(t,"a",(function(){return n})),s.d(t,"b",(function(){return r})),s.d(t,"c",(function(){return a})),s.d(t,"d",(function(){return l}));var o=s("f4vq"),i=s("phBA");const n=(e,t,s)=>{"abort"!==t&&(o.a.userLogin.showOnError(e,s)||o.a.userVerification.showOnError(e,s)||osu.popup(osu.xhrErrorMessage(e),"danger"))},r=(e,t)=>{n(t.jqXHR,t.textStatus,()=>{var e;return null===(e=t.submit)||void 0===e?void 0:e.call(t)})},a=e=>(t,s)=>{n(t,s,e)},l=e=>a(Object(i.a)(e))},"0EjP":function(e,t,s){"use strict";(function(e){var o=s("/G9H"),i=s("I8Ok"),n=function(e,t){return function(){return e.apply(t,arguments)}},r={}.hasOwnProperty;o.createElement,t.a=function(t){function s(){return this.renderToolbar=n(this.renderToolbar,this),this.sendOnChange=n(this.sendOnChange,this),this._save=n(this._save,this),this._cancel=n(this._cancel,this),this.onKeyDown=n(this.onKeyDown,this),this.setSizeSelect=n(this.setSizeSelect,this),this.setBody=n(this.setBody,this),this.toolbarButton=n(this.toolbarButton,this),this.actionButton=n(this.actionButton,this),this.render=n(this.render,this),this.componentDidMount=n(this.componentDidMount,this),s.__super__.constructor.apply(this,arguments)}return function(e,t){for(var s in t)r.call(t,s)&&(e[s]=t[s]);function o(){this.constructor=e}o.prototype=t.prototype,e.prototype=new o,e.__super__=t.prototype}(s,t),s.prototype.componentDidMount=function(){return this.sizeSelect.value="",this.body.selectionEnd=0,this.body.focus()},s.prototype.render=function(){var e;return e=osu.classWithModifiers("bbcode-editor",this.props.modifiers),e+=" js-bbcode-preview--form",Object(i.form)({className:e,"data-state":"write"},Object(i.div)({className:"bbcode-editor__content"},Object(i.textarea)({className:"bbcode-editor__body js-bbcode-preview--body",name:"body",placeholder:this.props.placeholder,defaultValue:this.props.rawValue,disabled:this.props.disabled,onKeyDown:this.onKeyDown,ref:this.setBody}),Object(i.div)({className:"bbcode-editor__preview"},Object(i.div)({className:"forum-post-content js-bbcode-preview--preview"})),Object(i.div)({className:"bbcode-editor__buttons-bar"},Object(i.div)({className:"bbcode-editor__buttons bbcode-editor__buttons--toolbar"},this.renderToolbar()),Object(i.div)({className:"bbcode-editor__buttons bbcode-editor__buttons--actions"},Object(i.div)({className:"bbcode-editor__button bbcode-editor__button--cancel"},this.actionButton(this._cancel,osu.trans("common.buttons.cancel"))),Object(i.div)({className:"bbcode-editor__button bbcode-editor__button--hide-on-write"},this.renderPreviewHideButton()),Object(i.div)({className:"bbcode-editor__button bbcode-editor__button--hide-on-preview"},this.renderPreviewShowButton()),Object(i.div)({className:"bbcode-editor__button"},this.actionButton(this._save,osu.trans("common.buttons.save"),"forum-primary"))))))},s.prototype.actionButton=function(e,t,s){return null==s&&(s="forum-secondary"),Object(i.button)({className:"btn-osu-big btn-osu-big--"+s,disabled:this.props.disabled,type:"button",onClick:e},t)},s.prototype.toolbarButton=function(t,s){return Object(i.button)({className:"btn-circle btn-circle--bbcode js-bbcode-btn--"+t,disabled:this.props.disabled,title:osu.trans("bbcode."+e.snakeCase(t)),type:"button"},Object(i.span)({className:"btn-circle__content"},s))},s.prototype.setBody=function(e){return this.body=e},s.prototype.setSizeSelect=function(e){return this.sizeSelect=e},s.prototype.onKeyDown=function(e){return 27===e.keyCode&&this._cancel()},s.prototype._cancel=function(e){if(this.body.value===this.props.rawValue||confirm(osu.trans("common.confirmation_unsaved")))return this.body.value=this.props.rawValue,this.sendOnChange({event:e,type:"cancel"})},s.prototype._save=function(e){return this.sendOnChange({event:e,type:"save"})},s.prototype.sendOnChange=function(e){var t,s,o;return s=e.event,o=e.type,"function"==typeof(t=this.props).onChange?t.onChange({event:s,type:o,value:this.body.value,hasChanged:this.body.value!==this.props.rawValue}):void 0},s.prototype.renderPreviewHideButton=function(){return Object(i.button)({type:"button",className:"js-bbcode-preview--hide btn-osu-big btn-osu-big--forum-secondary",disabled:this.props.disabled},osu.trans("forum.topic.create.preview_hide"))},s.prototype.renderPreviewShowButton=function(){return Object(i.button)({type:"button",className:"js-bbcode-preview--show btn-osu-big btn-osu-big--forum-secondary",disabled:this.props.disabled},osu.trans("forum.topic.create.preview"))},s.prototype.renderToolbar=function(){return Object(i.div)({className:"post-box-toolbar"},this.toolbarButton("bold",Object(i.i)({className:"fas fa-bold"})),this.toolbarButton("italic",Object(i.i)({className:"fas fa-italic"})),this.toolbarButton("strikethrough",Object(i.i)({className:"fas fa-strikethrough"})),this.toolbarButton("heading",Object(i.i)({className:"fas fa-heading"})),this.toolbarButton("link",Object(i.i)({className:"fas fa-link"})),this.toolbarButton("spoilerbox",Object(i.i)({className:"fas fa-barcode"})),this.toolbarButton("list-numbered",Object(i.i)({className:"fas fa-list-ol"})),this.toolbarButton("list",Object(i.i)({className:"fas fa-list"})),this.toolbarButton("image",Object(i.i)({className:"fas fa-image"})),Object(i.label)({className:"bbcode-size-select",title:osu.trans("bbcode.size._")},Object(i.span)({className:"bbcode-size-select__label"},osu.trans("bbcode.size._")),Object(i.i)({className:"fas fa-chevron-down"}),Object(i.select)({className:"bbcode-size-select__select js-bbcode-btn--size",disabled:this.props.disabled,ref:this.setSizeSelect},Object(i.option)({value:"50"},osu.trans("bbcode.size.tiny")),Object(i.option)({value:"85"},osu.trans("bbcode.size.small")),Object(i.option)({value:"100"},osu.trans("bbcode.size.normal")),Object(i.option)({value:"150"},osu.trans("bbcode.size.large")))))},s}(o.Component)}).call(this,s("Hs9Z"))},"0KrW":function(e,t,s){"use strict";(function(e,o){s.d(t,"a",(function(){return c}));var i=s("/G9H"),n=s("I8Ok"),r=s("yun6"),a=function(e,t){return function(){return e.apply(t,arguments)}},l={}.hasOwnProperty,c=function(t){function s(){return this.switchMode=a(this.switchMode,this),this.count=a(this.count,this),this.render=a(this.render,this),s.__super__.constructor.apply(this,arguments)}return function(e,t){for(var s in t)l.call(t,s)&&(e[s]=t[s]);function o(){this.constructor=e}o.prototype=t.prototype,e.prototype=new o,e.__super__=t.prototype}(s,t),s.prototype.render=function(){var e,t,s,o,i;return Object(n.div)({className:"game-mode game-mode--beatmapsets"},Object(n.ul)({className:"game-mode__items"},function(){var a,l,c,u,d;for(d=[],l=0,c=r.g.length;l<c;l++)i=r.g[l],s=!(this.props.enableAll||null!=this.props.beatmaps[i]),e=i===this.props.currentMode,o="game-mode-link",e&&(o+=" game-mode-link--active"),s&&(o+=" game-mode-link--disabled"),t=this.count(i),d.push(Object(n.li)({className:"game-mode__item",key:i},Object(n.a)({className:o,onClick:this.switchMode,href:null!=(u="function"==typeof(a=this.props).hrefFunc?a.hrefFunc(i):void 0)?u:"#","data-mode":i,"data-disabled":s},osu.trans("beatmaps.mode."+i),null!=t?Object(n.span)({className:"game-mode-link__badge"},t):void 0)));return d}.call(this)))},s.prototype.count=function(t){var s,o;return null!=(null!=(o=this.props.counts)?o[t]:void 0)?this.props.counts[t]:this.props.showCounts&&(s=Number(e.sumBy(this.props.beatmaps[t],(function(e){return!e.convert}))))>0?s:void 0},s.prototype.switchMode=function(e){var t,s;if(e.preventDefault(),t=(s=e.currentTarget).dataset.mode,this.props.currentMode!==t&&null!=t&&"true"!==s.dataset.disabled)return o.publish("playmode:set",{mode:t})},s}(i.Component)}).call(this,s("Hs9Z"),s("5wds"))},"0VTr":function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return p}));var o=s("bpgk"),i=s("WLnA"),n=s("0h6b"),r=s("Hs9Z"),a=s("EaLk"),l=s("tz7b"),c=function(e,t,s,o){var i,n=arguments.length,r=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,s):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,s,o);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(r=(n<3?i(r):n>3?i(t,s,r):i(t,s))||r);return n>3&&r&&Object.defineProperty(t,s,r),r};const u=e=>"logout"===e.event,d=e=>"verified"===e.event;class p{constructor(){this.connectionStatus="disconnected",this.hasConnectedOnce=!1,this.userId=null,this.active=!1,this.timeout={},this.xhr={},this.xhrLoadingState={},this.handleNewEvent=t=>{let s;try{s=JSON.parse(t.data)}catch(n){return void console.debug("Failed parsing data:",t.data)}u(s)?(this.destroy(),Object(i.a)(new o.b)):d(s)?e.publish("user-verification:success"):Object(i.a)(new l.a(s))},this.reconnectWebSocket=()=>{this.connectionStatus="disconnected",this.active&&(this.timeout.connectWebSocket=window.setTimeout(Object(a.d)(()=>{this.ws=null,this.connectWebSocket()}),Object(r.random)(5e3,2e4)))},this.startWebSocket=()=>null!=this.endpoint?this.connectWebSocket():this.xhrLoadingState.startWebSocket?void 0:(window.clearTimeout(this.timeout.startWebSocket),this.xhrLoadingState.startWebSocket=!0,this.xhr.startWebSocket=e.get(Object(n.route)("notifications.endpoint")).done(Object(a.d)(e=>{this.xhrLoadingState.startWebSocket=!1,this.endpoint=e.url,this.connectWebSocket()})).fail(Object(a.d)(()=>{this.timeout.startWebSocket=window.setTimeout(this.startWebSocket,1e4)})))}get isConnected(){return"connected"===this.connectionStatus}boot(){this.active=null!=this.userId,this.active&&this.startWebSocket()}setUserId(e){e!==this.userId&&(this.active&&this.destroy(),this.userId=e,this.boot())}connectWebSocket(){if(!this.active||null==this.endpoint||null!=this.ws)return;this.connectionStatus="connecting",window.clearTimeout(this.timeout.connectWebSocket);const e=document.querySelector("meta[name=csrf-token]");if(null==e)return;const t=e.getAttribute("content");this.ws=new WebSocket(`${this.endpoint}?csrf=${t}`),this.ws.addEventListener("open",()=>{this.connectionStatus="connected",this.hasConnectedOnce=!0}),this.ws.addEventListener("close",this.reconnectWebSocket),this.ws.addEventListener("message",this.handleNewEvent)}destroy(){this.connectionStatus="disconnecting",this.userId=null,this.active=!1,Object(r.forEach)(this.xhr,e=>null==e?void 0:e.abort()),Object(r.forEach)(this.timeout,e=>window.clearTimeout(e)),null!=this.ws&&(this.ws.close(),this.ws=null),this.connectionStatus="disconnected"}}c([a.m],p.prototype,"connectionStatus",void 0),c([a.m],p.prototype,"hasConnectedOnce",void 0),c([a.m],p.prototype,"active",void 0),c([a.e],p.prototype,"isConnected",null),c([a.d],p.prototype,"connectWebSocket",null),c([a.d],p.prototype,"destroy",null),c([a.d],p.prototype,"reconnectWebSocket",void 0)}).call(this,s("5wds"))},"0h6b":function(e,t,s){"use strict";s.r(t),s.d(t,"route",(function(){return a})),s.d(t,"link_to_route",(function(){return l}));var o=s("Hs9Z");const i={url:"https://osu.ppy.sh",port:null,defaults:{},routes:{"admin.beatmapsets.covers":{uri:"admin/beatmapsets/{beatmapset}/covers",methods:["GET","HEAD"]},"admin.beatmapsets.covers.regenerate":{uri:"admin/beatmapsets/{beatmapset}/covers/regenerate",methods:["POST"]},"admin.beatmapsets.covers.remove":{uri:"admin/beatmapsets/{beatmapset}/covers/remove",methods:["POST"]},"admin.beatmapsets.show":{uri:"admin/beatmapsets/{beatmapset}",methods:["GET","HEAD"]},"admin.beatmapsets.update":{uri:"admin/beatmapsets/{beatmapset}",methods:["PUT","PATCH"]},"admin.contests.get-zip":{uri:"admin/contests/{contest}/zip",methods:["POST"]},"admin.contests.index":{uri:"admin/contests",methods:["GET","HEAD"]},"admin.contests.show":{uri:"admin/contests/{contest}",methods:["GET","HEAD"]},"admin.user-contest-entries.destroy":{uri:"admin/user-contest-entries/{user_contest_entry}",methods:["DELETE"]},"admin.user-contest-entries.restore":{uri:"admin/user-contest-entries/{user_contest_entry}/restore",methods:["POST"]},"admin.logs.index":{uri:"admin/logs",methods:["GET","HEAD"]},"admin.root":{uri:"admin",methods:["GET","HEAD"]},"admin.forum.forum-covers.index":{uri:"admin/forum/forum-covers",methods:["GET","HEAD"]},"admin.forum.forum-covers.store":{uri:"admin/forum/forum-covers",methods:["POST"]},"admin.forum.forum-covers.update":{uri:"admin/forum/forum-covers/{forum_cover}",methods:["PUT","PATCH"]},"admin.store.addresses.update":{uri:"admin/store/addresses/{address}",methods:["PUT","PATCH"]},"admin.store.orders.ship":{uri:"admin/store/orders/ship",methods:["POST"]},"admin.store.orders.index":{uri:"admin/store/orders",methods:["GET","HEAD"]},"admin.store.orders.show":{uri:"admin/store/orders/{order}",methods:["GET","HEAD"]},"admin.store.orders.update":{uri:"admin/store/orders/{order}",methods:["PUT","PATCH"]},"admin.store.orders.items.update":{uri:"admin/store/orders/{order}/items/{item}",methods:["PUT","PATCH"]},"admin.store.redirect:admin.store.orders.index":{uri:"admin/store",methods:["GET","HEAD"]},"artists.index":{uri:"beatmaps/artists",methods:["GET","HEAD"]},"artists.show":{uri:"beatmaps/artists/{artist}",methods:["GET","HEAD"]},"packs.index":{uri:"beatmaps/packs",methods:["GET","HEAD"]},"packs.show":{uri:"beatmaps/packs/{pack}",methods:["GET","HEAD"]},"packs.raw":{uri:"beatmaps/packs/{pack}/raw",methods:["GET","HEAD"]},"beatmaps.":{uri:"beatmaps/{beatmap}/scores/users/{user}",methods:["GET","HEAD"]},"beatmaps.scores":{uri:"beatmaps/{beatmap}/scores",methods:["GET","HEAD"]},"beatmaps.show":{uri:"beatmaps/{beatmap}",methods:["GET","HEAD"]},"redirect:beatmapsets.discussions.index":{uri:"beatmapsets/beatmap-discussions",methods:["GET","HEAD"]},"redirect:beatmapsets.discussions.destroy":{uri:"beatmapsets/beatmap-discussions/{beatmap_discussion}",methods:["DELETE"]},"redirect:beatmapsets.discussions.show":{uri:"beatmapsets/beatmap-discussions/{beatmap_discussion}",methods:["GET","HEAD"]},"redirect:beatmapsets.discussions.vote":{uri:"beatmapsets/beatmap-discussions/{beatmap_discussion}/vote",methods:["PUT"]},"redirect:beatmapsets.discussions.restore":{uri:"beatmapsets/beatmap-discussions/{beatmap_discussion}/restore",methods:["POST"]},"redirect:beatmapsets.discussions.deny-kudosu":{uri:"beatmapsets/beatmap-discussions/{beatmap_discussion}/deny-kudosu",methods:["POST"]},"redirect:beatmapsets.discussions.allow-kudosu":{uri:"beatmapsets/beatmap-discussions/{beatmap_discussion}/allow-kudosu",methods:["POST"]},"redirect:beatmapsets.discussions.posts.destroy":{uri:"beatmapsets/beatmap-discussion-posts/{beatmap_discussion_post}",methods:["DELETE"]},"redirect:beatmapsets.discussions.posts.store":{uri:"beatmapsets/beatmap-discussion-posts/{beatmap_discussion_post}",methods:["POST"]},"redirect:beatmapsets.discussions.posts.update":{uri:"beatmapsets/beatmap-discussion-posts/{beatmap_discussion_post}",methods:["PUT"]},"redirect:beatmapsets.discussions.posts.restore":{uri:"beatmapsets/beatmap-discussion-posts/{beatmap_discussion_post}/restore",methods:["POST"]},"redirect:beatmapsets.discussions.posts.index":{uri:"beatmapsets/beatmap-discussion-posts",methods:["GET","HEAD"]},"beatmapsets.events.index":{uri:"beatmapsets/events",methods:["GET","HEAD"]},"beatmapsets.redirect:follows.index":{uri:"beatmapsets/watches",methods:["GET","HEAD"]},"beatmapsets.watches.update":{uri:"beatmapsets/watches/{watch}",methods:["PUT","PATCH"]},"beatmapsets.watches.destroy":{uri:"beatmapsets/watches/{watch}",methods:["DELETE"]},"beatmapsets.discussions.vote":{uri:"beatmapsets/discussions/{discussion}/vote",methods:["PUT"]},"beatmapsets.discussions.restore":{uri:"beatmapsets/discussions/{discussion}/restore",methods:["POST"]},"beatmapsets.discussions.deny-kudosu":{uri:"beatmapsets/discussions/{discussion}/deny-kudosu",methods:["POST"]},"beatmapsets.discussions.allow-kudosu":{uri:"beatmapsets/discussions/{discussion}/allow-kudosu",methods:["POST"]},"beatmapsets.discussions.posts.restore":{uri:"beatmapsets/discussions/posts/{post}/restore",methods:["POST"]},"beatmapsets.discussions.posts.index":{uri:"beatmapsets/discussions/posts",methods:["GET","HEAD"]},"beatmapsets.discussions.posts.store":{uri:"beatmapsets/discussions/posts",methods:["POST"]},"beatmapsets.discussions.posts.update":{uri:"beatmapsets/discussions/posts/{post}",methods:["PUT","PATCH"]},"beatmapsets.discussions.posts.destroy":{uri:"beatmapsets/discussions/posts/{post}",methods:["DELETE"]},"beatmapsets.discussions.votes.index":{uri:"beatmapsets/discussions/votes",methods:["GET","HEAD"]},"beatmapsets.discussions.index":{uri:"beatmapsets/discussions",methods:["GET","HEAD"]},"beatmapsets.discussions.show":{uri:"beatmapsets/discussions/{discussion}",methods:["GET","HEAD"]},"beatmapsets.discussions.destroy":{uri:"beatmapsets/discussions/{discussion}",methods:["DELETE"]},"beatmapsets.favourites.store":{uri:"beatmapsets/{beatmapset}/favourites",methods:["POST"]},"beatmapsets.search":{uri:"beatmapsets/search/{filters?}",methods:["GET","HEAD"]},"beatmapsets.discussion":{uri:"beatmapsets/{beatmapset}/discussion/{beatmap?}/{mode?}/{filter?}",methods:["GET","HEAD"]},"beatmapsets.discussion.review":{uri:"beatmapsets/{beatmapset}/discussion/review",methods:["POST"]},"beatmapsets.discussion-lock":{uri:"beatmapsets/{beatmapset}/discussion-lock",methods:["POST"]},"beatmapsets.discussion-unlock":{uri:"beatmapsets/{beatmapset}/discussion-unlock",methods:["POST"]},"beatmapsets.download":{uri:"beatmapsets/{beatmapset}/download",methods:["GET","HEAD"]},"beatmapsets.love":{uri:"beatmapsets/{beatmapset}/love",methods:["PUT"]},"beatmapsets.remove-from-loved":{uri:"beatmapsets/{beatmapset}/love",methods:["DELETE"]},"beatmapsets.nominate":{uri:"beatmapsets/{beatmapset}/nominate",methods:["PUT"]},"beatmapsets.index":{uri:"beatmapsets",methods:["GET","HEAD"]},"beatmapsets.show":{uri:"beatmapsets/{beatmapset}",methods:["GET","HEAD"]},"beatmapsets.update":{uri:"beatmapsets/{beatmapset}",methods:["PUT","PATCH"]},"beatmapsets.destroy":{uri:"beatmapsets/{beatmapset}",methods:["DELETE"]},"scores.download":{uri:"scores/{mode}/{score}/download",methods:["GET","HEAD"]},"scores.show":{uri:"scores/{mode}/{score}",methods:["GET","HEAD"]},"client-verifications.create":{uri:"client-verifications/create",methods:["GET","HEAD"]},"client-verifications.store":{uri:"client-verifications",methods:["POST"]},"comments.index":{uri:"comments",methods:["GET","HEAD"]},"comments.store":{uri:"comments",methods:["POST"]},"comments.show":{uri:"comments/{comment}",methods:["GET","HEAD"]},"comments.update":{uri:"comments/{comment}",methods:["PUT","PATCH"]},"comments.destroy":{uri:"comments/{comment}",methods:["DELETE"]},"comments.pin":{uri:"comments/{comment}/pin",methods:["POST"]},"comments.restore":{uri:"comments/{comment}/restore",methods:["POST"]},"comments.vote":{uri:"comments/{comment}/vote",methods:["POST"]},"contests.index":{uri:"community/contests",methods:["GET","HEAD"]},"contests.show":{uri:"community/contests/{contest}",methods:["GET","HEAD"]},"contest-entries.vote":{uri:"community/contest-entries/{contest_entry}/vote",methods:["PUT"]},"contest-entries.store":{uri:"community/contest-entries",methods:["POST"]},"contest-entries.destroy":{uri:"community/contest-entries/{contest_entry}",methods:["DELETE"]},"livestreams.promote":{uri:"community/livestreams/promote",methods:["POST"]},"livestreams.index":{uri:"community/livestreams",methods:["GET","HEAD"]},"matches.show":{uri:"community/matches/{match}",methods:["GET","HEAD"]},"tournaments.unregister":{uri:"community/tournaments/{tournament}/unregister",methods:["POST"]},"tournaments.register":{uri:"community/tournaments/{tournament}/register",methods:["POST"]},"tournaments.index":{uri:"community/tournaments",methods:["GET","HEAD"]},"tournaments.show":{uri:"community/tournaments/{tournament}",methods:["GET","HEAD"]},"forum.forum-covers.store":{uri:"community/forums/forum-covers",methods:["POST"]},"forum.forum-covers.update":{uri:"community/forums/forum-covers/{forum_cover}",methods:["PUT","PATCH"]},"forum.forum-covers.destroy":{uri:"community/forums/forum-covers/{forum_cover}",methods:["DELETE"]},"forum.posts.raw":{uri:"community/forums/posts/{post}/raw",methods:["GET","HEAD"]},"forum.posts.restore":{uri:"community/forums/posts/{post}/restore",methods:["POST"]},"forum.posts.show":{uri:"community/forums/posts/{post}",methods:["GET","HEAD"]},"forum.posts.edit":{uri:"community/forums/posts/{post}/edit",methods:["GET","HEAD"]},"forum.posts.update":{uri:"community/forums/posts/{post}",methods:["PUT","PATCH"]},"forum.posts.destroy":{uri:"community/forums/posts/{post}",methods:["DELETE"]},"forum.topics.edit-poll":{uri:"community/forums/topics/{topic}/edit-poll",methods:["GET","HEAD"]},"forum.topics.preview":{uri:"community/forums/topics/preview",methods:["POST"]},"forum.topics.issue-tag":{uri:"community/forums/topics/{topic}/issue-tag",methods:["POST"]},"forum.topics.lock":{uri:"community/forums/topics/{topic}/lock",methods:["POST"]},"forum.topics.move":{uri:"community/forums/topics/{topic}/move",methods:["POST"]},"forum.topics.pin":{uri:"community/forums/topics/{topic}/pin",methods:["POST"]},"forum.topics.reply":{uri:"community/forums/topics/{topic}/reply",methods:["POST"]},"forum.topics.restore":{uri:"community/forums/topics/{topic}/restore",methods:["POST"]},"forum.topics.vote":{uri:"community/forums/topics/{topic}/vote",methods:["POST"]},"forum.topics.vote-feature":{uri:"community/forums/topics/{topic}/vote-feature",methods:["POST"]},"forum.topics.create":{uri:"community/forums/topics/create",methods:["GET","HEAD"]},"forum.topics.store":{uri:"community/forums/topics",methods:["POST"]},"forum.topics.show":{uri:"community/forums/topics/{topic}",methods:["GET","HEAD"]},"forum.topics.update":{uri:"community/forums/topics/{topic}",methods:["PUT","PATCH"]},"forum.topics.destroy":{uri:"community/forums/topics/{topic}",methods:["DELETE"]},"forum.topic-covers.store":{uri:"community/forums/topic-covers",methods:["POST"]},"forum.topic-covers.update":{uri:"community/forums/topic-covers/{topic_cover}",methods:["PUT","PATCH"]},"forum.topic-covers.destroy":{uri:"community/forums/topic-covers/{topic_cover}",methods:["DELETE"]},"forum.redirect:follows.index":{uri:"community/forums/topic-watches",methods:["GET","HEAD"]},"forum.topic-watches.update":{uri:"community/forums/topic-watches/{topic_watch}",methods:["PUT","PATCH"]},"forum.forums.mark-as-read":{uri:"community/forums/mark-as-read",methods:["POST"]},"forum.forums.index":{uri:"community/forums",methods:["GET","HEAD"]},"forum.forums.show":{uri:"community/forums/{forum}",methods:["GET","HEAD"]},"chat.new":{uri:"community/chat/new",methods:["POST"]},"chat.updates":{uri:"community/chat/updates",methods:["GET","HEAD"]},"chat.presence":{uri:"community/chat/presence",methods:["GET","HEAD"]},"chat.channels.messages.index":{uri:"community/chat/channels/{channel}/messages",methods:["GET","HEAD"]},"chat.channels.messages.store":{uri:"community/chat/channels/{channel}/messages",methods:["POST"]},"chat.channels.join":{uri:"community/chat/channels/{channel}/users/{user}",methods:["PUT"]},"chat.channels.part":{uri:"community/chat/channels/{channel}/users/{user}",methods:["DELETE"]},"chat.channels.mark-as-read":{uri:"community/chat/channels/{channel}/mark-as-read/{message}",methods:["PUT"]},"chat.channels.index":{uri:"community/chat/channels",methods:["GET","HEAD"]},"chat.channels.show":{uri:"community/chat/channels/{channel}",methods:["GET","HEAD"]},"chat.index":{uri:"community/chat",methods:["GET","HEAD"]},"groups.show":{uri:"groups/{group}",methods:["GET","HEAD"]},"account.edit":{uri:"home/account/edit",methods:["GET","HEAD"]},"account.avatar":{uri:"home/account/avatar",methods:["POST"]},"account.cover":{uri:"home/account/cover",methods:["POST"]},"account.email":{uri:"home/account/email",methods:["PUT"]},"account.notification-options":{uri:"home/account/notification-options",methods:["PUT"]},"account.options":{uri:"home/account/options",methods:["PUT"]},"account.password":{uri:"home/account/password",methods:["PUT"]},"account.reissue-code":{uri:"home/account/reissue-code",methods:["POST"]},"account.sessions.destroy":{uri:"home/account/sessions/{session}",methods:["DELETE"]},"account.":{uri:"home/account/verify",methods:["GET","HEAD"]},"account.verify":{uri:"home/account/verify",methods:["POST"]},"account.update":{uri:"home/account",methods:["PUT"]},"quick-search":{uri:"home/quick-search",methods:["GET","HEAD"]},search:{uri:"home/search",methods:["GET","HEAD"]},"bbcode-preview":{uri:"home/bbcode-preview",methods:["POST"]},"changelog.build":{uri:"home/changelog/{stream}/{build}",methods:["GET","HEAD"]},"changelog.index":{uri:"home/changelog",methods:["GET","HEAD"]},"changelog.show":{uri:"home/changelog/{changelog}",methods:["GET","HEAD"]},download:{uri:"home/download",methods:["GET","HEAD"]},"set-locale":{uri:"home/set-locale",methods:["POST"]},"support-the-game":{uri:"home/support",methods:["GET","HEAD"]},testflight:{uri:"home/testflight",methods:["GET","HEAD"]},"password-reset":{uri:"home/password-reset",methods:["GET","HEAD"]},"support-osu-popup":{uri:"home/support-osu-popup",methods:["GET","HEAD"]},"download-quota-check":{uri:"home/download-quota-check",methods:["GET","HEAD"]},"blocks.store":{uri:"home/blocks",methods:["POST"]},"blocks.destroy":{uri:"home/blocks/{block}",methods:["DELETE"]},"friends.index":{uri:"home/friends",methods:["GET","HEAD"]},"friends.store":{uri:"home/friends",methods:["POST"]},"friends.destroy":{uri:"home/friends/{friend}",methods:["DELETE"]},"news.index":{uri:"home/news",methods:["GET","HEAD"]},"news.store":{uri:"home/news",methods:["POST"]},"news.show":{uri:"home/news/{news}",methods:["GET","HEAD"]},"news.update":{uri:"home/news/{news}",methods:["PUT","PATCH"]},"messages.users.show":{uri:"home/messages/users/{user}",methods:["GET","HEAD"]},"follows.store":{uri:"home/follows",methods:["POST"]},"follows.index":{uri:"home/follows/{subtype?}",methods:["GET","HEAD"]},"follows.destroy":{uri:"home/follows",methods:["DELETE"]},"notifications.index":{uri:"notifications",methods:["GET","HEAD"]},"notifications.endpoint":{uri:"notifications/endpoint",methods:["GET","HEAD"]},"notifications.mark-read":{uri:"notifications/mark-read",methods:["POST"]},legal:{uri:"legal/{locale?}/{path?}",methods:["GET","HEAD"]},"multiplayer.rooms.show":{uri:"multiplayer/rooms/{room}",methods:["GET","HEAD"]},"oauth.authorized-clients.destroy":{uri:"oauth/authorized-clients/{authorized_client}",methods:["DELETE"]},"oauth.clients.index":{uri:"oauth/clients",methods:["GET","HEAD"]},"oauth.clients.store":{uri:"oauth/clients",methods:["POST"]},"oauth.clients.update":{uri:"oauth/clients/{client}",methods:["PUT","PATCH"]},"oauth.clients.destroy":{uri:"oauth/clients/{client}",methods:["DELETE"]},"oauth.clients.reset-secret":{uri:"oauth/clients/{client}/reset-secret",methods:["POST"]},rankings:{uri:"rankings/{mode?}/{type?}",methods:["GET","HEAD"]},"reports.store":{uri:"reports",methods:["POST"]},login:{uri:"session",methods:["POST"]},logout:{uri:"session",methods:["DELETE"]},"users.check-username-availability":{uri:"users/check-username-availability",methods:["POST"]},"users.check-username-exists":{uri:"users/check-username-exists",methods:["POST"]},"users.disabled":{uri:"users/disabled",methods:["GET","HEAD"]},"users.card":{uri:"users/{user}/card",methods:["GET","HEAD"]},"users.page":{uri:"users/{user}/page",methods:["PUT"]},"users.kudosu":{uri:"users/{user}/kudosu",methods:["GET","HEAD"]},"users.recent-activity":{uri:"users/{user}/recent_activity",methods:["GET","HEAD"]},"users.scores":{uri:"users/{user}/scores/{type}",methods:["GET","HEAD"]},"users.beatmapsets":{uri:"users/{user}/beatmapsets/{type}",methods:["GET","HEAD"]},"users.posts":{uri:"users/{user}/posts",methods:["GET","HEAD"]},"users.modding.index":{uri:"users/{user}/modding",methods:["GET","HEAD"]},"users.modding.posts":{uri:"users/{user}/modding/posts",methods:["GET","HEAD"]},"users.modding.votes-given":{uri:"users/{user}/modding/votes-given",methods:["GET","HEAD"]},"users.modding.votes-received":{uri:"users/{user}/modding/votes-received",methods:["GET","HEAD"]},"users.show":{uri:"users/{user}/{mode?}",methods:["GET","HEAD"]},"users.store":{uri:"users",methods:["POST"]},"wiki.sitemap":{uri:"wiki/{locale}/Sitemap",methods:["GET","HEAD"]},"wiki.image":{uri:"wiki/images/{path}",methods:["GET","HEAD"]},"wiki.show":{uri:"wiki/{locale?}/{path?}",methods:["GET","HEAD"]},"wiki-suggestions":{uri:"wiki-suggestions",methods:["GET","HEAD"]},"store.redirect:store.products.index":{uri:"store",methods:["GET","HEAD"]},"store.products.index":{uri:"store/listing",methods:["GET","HEAD"]},"store.invoice.show":{uri:"store/invoice/{invoice}",methods:["GET","HEAD"]},"store.":{uri:"store/products/{product}/notification-request",methods:["DELETE"]},"store.notification-request":{uri:"store/products/{product}/notification-request",methods:["POST"]},"store.cart.show":{uri:"store/cart",methods:["GET","HEAD"]},"store.cart.store":{uri:"store/cart",methods:["POST"]},"store.checkout.store":{uri:"store/checkout",methods:["POST"]},"store.checkout.show":{uri:"store/checkout/{checkout}",methods:["GET","HEAD"]},"store.orders.index":{uri:"store/orders",methods:["GET","HEAD"]},"store.orders.destroy":{uri:"store/orders/{order}",methods:["DELETE"]},"store.redirect:store.products.show":{uri:"store/product/{product}",methods:["GET","HEAD"]},"store.products.show":{uri:"store/products/{product}",methods:["GET","HEAD"]},"payments.paypal.approved":{uri:"payments/paypal/approved",methods:["GET","HEAD"]},"payments.paypal.declined":{uri:"payments/paypal/declined",methods:["GET","HEAD"]},"payments.paypal.create":{uri:"payments/paypal/create",methods:["POST"]},"payments.paypal.completed":{uri:"payments/paypal/completed",methods:["GET","HEAD"]},"payments.paypal.ipn":{uri:"payments/paypal/ipn",methods:["POST"]},"payments.xsolla.completed":{uri:"payments/xsolla/completed",methods:["GET","HEAD"]},"payments.xsolla.token":{uri:"payments/xsolla/token",methods:["POST"]},"payments.xsolla.callback":{uri:"payments/xsolla/callback",methods:["POST"]},"payments.centili.callback":{uri:"payments/centili/callback",methods:["POST","GET","HEAD"]},"payments.centili.completed":{uri:"payments/centili/completed",methods:["GET","HEAD"]},"payments.centili.failed":{uri:"payments/centili/failed",methods:["GET","HEAD"]},"payments.shopify.callback":{uri:"payments/shopify/callback",methods:["POST"]},home:{uri:"home",methods:["GET","HEAD"]},"redirect:home":{uri:"/",methods:["GET","HEAD"]},"redirect:forum.posts.show":{uri:"po/{post}",methods:["GET","HEAD"]},"redirect:forum.topics.show":{uri:"forum/t/{topic}",methods:["GET","HEAD"]},"redirect:forum.forums.show":{uri:"forum/{forum}",methods:["GET","HEAD"]},"redirect:beatmaps.show":{uri:"b/{beatmap}",methods:["GET","HEAD"]},"redirect:groups.show":{uri:"g/{group}",methods:["GET","HEAD"]},"redirect:beatmapsets.show":{uri:"s/{beatmapset}",methods:["GET","HEAD"]},"redirect:users.show":{uri:"u/{user}",methods:["GET","HEAD"]},"redirect:forum.forums.index":{uri:"forum",methods:["GET","HEAD"]},"redirect:matches.show":{uri:"mp/{match}",methods:["GET","HEAD"]},"redirect:wiki.show":{uri:"help/wiki/{path?}",methods:["GET","HEAD"]},"api.beatmaps.":{uri:"api/v2/beatmaps/{beatmap}/scores/users/{user}",methods:["GET","HEAD"]},"api.beatmaps.scores":{uri:"api/v2/beatmaps/{beatmap}/scores",methods:["GET","HEAD"]},"api.beatmaps.solo.scores.store":{uri:"api/v2/beatmaps/{beatmap}/solo/scores",methods:["POST"]},"api.beatmaps.solo.scores.update":{uri:"api/v2/beatmaps/{beatmap}/solo/scores/{score}",methods:["PUT","PATCH"]},"api.beatmaps.show":{uri:"api/v2/beatmaps/{beatmap}",methods:["GET","HEAD"]},"api.beatmapsets.events.index":{uri:"api/v2/beatmapsets/events",methods:["GET","HEAD"]},"api.beatmapsets.discussions.posts.index":{uri:"api/v2/beatmapsets/discussions/posts",methods:["GET","HEAD"]},"api.beatmapsets.discussions.votes.index":{uri:"api/v2/beatmapsets/discussions/votes",methods:["GET","HEAD"]},"api.beatmapsets.discussions.index":{uri:"api/v2/beatmapsets/discussions",methods:["GET","HEAD"]},"api.beatmapsets.favourites.store":{uri:"api/v2/beatmapsets/{beatmapset}/favourites",methods:["POST"]},"api.comments.index":{uri:"api/v2/comments",methods:["GET","HEAD"]},"api.comments.store":{uri:"api/v2/comments",methods:["POST"]},"api.comments.show":{uri:"api/v2/comments/{comment}",methods:["GET","HEAD"]},"api.comments.update":{uri:"api/v2/comments/{comment}",methods:["PUT","PATCH"]},"api.comments.destroy":{uri:"api/v2/comments/{comment}",methods:["DELETE"]},"api.comments.vote":{uri:"api/v2/comments/{comment}/vote",methods:["POST"]},"api.":{uri:"api/v2/users/{user}/recent_activity",methods:["GET","HEAD"]},"api.chat.new":{uri:"api/v2/chat/new",methods:["POST"]},"api.chat.updates":{uri:"api/v2/chat/updates",methods:["GET","HEAD"]},"api.chat.presence":{uri:"api/v2/chat/presence",methods:["GET","HEAD"]},"api.chat.channels.messages.index":{uri:"api/v2/chat/channels/{channel}/messages",methods:["GET","HEAD"]},"api.chat.channels.messages.store":{uri:"api/v2/chat/channels/{channel}/messages",methods:["POST"]},"api.chat.channels.join":{uri:"api/v2/chat/channels/{channel}/users/{user}",methods:["PUT"]},"api.chat.channels.part":{uri:"api/v2/chat/channels/{channel}/users/{user}",methods:["DELETE"]},"api.chat.channels.mark-as-read":{uri:"api/v2/chat/channels/{channel}/mark-as-read/{message}",methods:["PUT"]},"api.chat.channels.index":{uri:"api/v2/chat/channels",methods:["GET","HEAD"]},"api.chat.channels.store":{uri:"api/v2/chat/channels",methods:["POST"]},"api.chat.channels.show":{uri:"api/v2/chat/channels/{channel}",methods:["GET","HEAD"]},"api.changelog.build":{uri:"api/v2/changelog/{stream}/{build}",methods:["GET","HEAD"]},"api.changelog.index":{uri:"api/v2/changelog",methods:["GET","HEAD"]},"api.changelog.show":{uri:"api/v2/changelog/{changelog}",methods:["GET","HEAD"]},"api.forum.topics.reply":{uri:"api/v2/forums/topics/{topic}/reply",methods:["POST"]},"api.forum.topics.store":{uri:"api/v2/forums/topics",methods:["POST"]},"api.forum.topics.show":{uri:"api/v2/forums/topics/{topic}",methods:["GET","HEAD"]},"api.forum.topics.update":{uri:"api/v2/forums/topics/{topic}",methods:["PUT","PATCH"]},"api.forum.posts.update":{uri:"api/v2/forums/posts/{post}",methods:["PUT","PATCH"]},"api.matches.index":{uri:"api/v2/matches",methods:["GET","HEAD"]},"api.matches.show":{uri:"api/v2/matches/{match}",methods:["GET","HEAD"]},"api.rooms.index":{uri:"api/v2/rooms/{mode?}",methods:["GET","HEAD"]},"api.rooms.join":{uri:"api/v2/rooms/{room}/users/{user}",methods:["PUT"]},"api.rooms.part":{uri:"api/v2/rooms/{room}/users/{user}",methods:["DELETE"]},"api.rooms.":{uri:"api/v2/rooms/{room}/leaderboard",methods:["GET","HEAD"]},"api.rooms.playlist.":{uri:"api/v2/rooms/{room}/playlist/{playlist}/scores/users/{user}",methods:["GET","HEAD"]},"api.rooms.playlist.scores.index":{uri:"api/v2/rooms/{room}/playlist/{playlist}/scores",methods:["GET","HEAD"]},"api.rooms.playlist.scores.store":{uri:"api/v2/rooms/{room}/playlist/{playlist}/scores",methods:["POST"]},"api.rooms.playlist.scores.show":{uri:"api/v2/rooms/{room}/playlist/{playlist}/scores/{score}",methods:["GET","HEAD"]},"api.rooms.playlist.scores.update":{uri:"api/v2/rooms/{room}/playlist/{playlist}/scores/{score}",methods:["PUT","PATCH"]},"api.reports.store":{uri:"api/v2/reports",methods:["POST"]},"api.rooms.store":{uri:"api/v2/rooms",methods:["POST"]},"api.rooms.show":{uri:"api/v2/rooms/{room}",methods:["GET","HEAD"]},"api.seasonal-backgrounds.index":{uri:"api/v2/seasonal-backgrounds",methods:["GET","HEAD"]},"api.scores.download":{uri:"api/v2/scores/{mode}/{score}/download",methods:["GET","HEAD"]},"api.scores.show":{uri:"api/v2/scores/{mode}/{score}",methods:["GET","HEAD"]},"api.beatmapsets.show":{uri:"api/v2/beatmapsets/{beatmapset}",methods:["GET","HEAD"]},"api.friends.index":{uri:"api/v2/friends",methods:["GET","HEAD"]},"api.me":{uri:"api/v2/me/{mode?}",methods:["GET","HEAD"]},"api.oauth.tokens.current":{uri:"api/v2/oauth/tokens/current",methods:["DELETE"]},"api.news.index":{uri:"api/v2/news",methods:["GET","HEAD"]},"api.news.show":{uri:"api/v2/news/{news}",methods:["GET","HEAD"]},"api.notifications.index":{uri:"api/v2/notifications",methods:["GET","HEAD"]},"api.notifications.mark-read":{uri:"api/v2/notifications/mark-read",methods:["POST"]},"api.spotlights.index":{uri:"api/v2/spotlights",methods:["GET","HEAD"]},"api.users.show":{uri:"api/v2/users/{user}/{mode?}",methods:["GET","HEAD"]},"api.users.index":{uri:"api/v2/users",methods:["GET","HEAD"]},"api.wiki.show":{uri:"api/v2/wiki/{locale}/{path}",methods:["GET","HEAD"]},"interop.":{uri:"_lio/beatmapsets/{beatmapset}/broadcast-new",methods:["POST"]},"interop.user-achievement":{uri:"_lio/user-achievement/{user}/{achievement}/{beatmap?}",methods:["POST"]},"interop.users.store":{uri:"_lio/users",methods:["POST"]},"interop.indexing.bulk.store":{uri:"_lio/indexing/bulk",methods:["POST"]},"interop.user-groups.store":{uri:"_lio/user-group",methods:["POST"]},"interop.user-groups.destroy":{uri:"_lio/user-group",methods:["DELETE"]},"interop.user-groups.store-default":{uri:"_lio/user-default-group",methods:["POST"]},"oauth.passport.token":{uri:"oauth/token",methods:["POST"]},"oauth.authorizations.authorize":{uri:"oauth/authorize",methods:["GET","HEAD"]},"oauth.":{uri:"oauth/authorize",methods:["DELETE"]}}};if("undefined"!=typeof window&&void 0!==window.Ziggy)for(let c in window.Ziggy.routes)i.routes[c]=window.Ziggy.routes[c];var n=s("o0W1"),r=s.n(n);function a(e,t,s){return null==t&&(t={}),r()(e,t,s,i).toString()}function l(e,t,s,i){const n=a(e,s),r=document.createElement("a");return r.textContent=t,r.href=n,null!=i&&Object(o.forEach)(i,(e,t)=>{null!=e&&r.setAttribute(t,e.toString())}),r.outerHTML}i.baseUrl=`${document.location.origin}/`,i.baseProtocol=document.location.protocol.slice(0,-1),i.baseDomain=document.location.hostname,i.basePort=+document.location.port||!1},"2LKk":function(e,t,s){"use strict";(function(e,o){s.d(t,"a",(function(){return g}));var i,n,r,a=s("UVl7"),l=s("2b+G"),c=s("O0zI"),u=s("stCr"),d=s("4PZ6"),p=s("cF9b"),h=s("f4vq"),m=s("/G9H"),f=s("I8Ok"),b=s("PPOh"),v=function(e,t){return function(){return e.apply(t,arguments)}},y={}.hasOwnProperty;i=m.createElement,n=h.a.dataStore.commentStore,r=h.a.dataStore.uiState;var g=function(t){function s(){return this.renderFollowToggle=v(this.renderFollowToggle,this),this.renderShowDeletedToggle=v(this.renderShowDeletedToggle,this),this.renderComments=v(this.renderComments,this),this.renderComment=v(this.renderComment,this),this.render=v(this.render,this),s.__super__.constructor.apply(this,arguments)}return function(e,t){for(var s in t)y.call(t,s)&&(e[s]=t[s]);function o(){this.constructor=e}o.prototype=t.prototype,e.prototype=new o,e.__super__=t.prototype}(s,t),s.prototype.render=function(){return i(p.a,null,(t=this,function(){var s,o;return s=r.comments.topLevelCommentIds.map((function(e){return n.comments.get(e)})),o=r.comments.pinnedCommentIds.map((function(e){return n.comments.get(e)})),Object(f.div)({className:osu.classWithModifiers("comments",t.props.modifiers)},Object(f.div)({className:"u-has-anchor u-has-anchor--no-event"},Object(f.div)({className:"fragment-target",id:"comments"})),Object(f.h2)({className:"comments__title"},osu.trans("comments.title"),Object(f.span)({className:"comments__count"},osu.formatNumber(r.comments.total))),o.length>0?Object(f.div)({className:"comments__items comments__items--pinned"},t.renderComments(o,!0)):void 0,Object(f.div)({className:"comments__new"},i(l.a,{commentableType:t.props.commentableType,commentableId:t.props.commentableId,focus:!1,modifiers:t.props.modifiers})),Object(f.div)({className:"comments__items comments__items--toolbar"},i(u.a,{modifiers:t.props.modifiers}),Object(f.div)({className:osu.classWithModifiers("sort",t.props.modifiers)},Object(f.div)({className:"sort__items"},t.renderFollowToggle(),t.renderShowDeletedToggle()))),s.length>0?Object(f.div)({className:"comments__items "+(null!=r.comments.loadingSort?"comments__items--loading":"")},t.renderComments(s,!1),i(d.a,{comments:s,modifiers:["top"]}),i(c.a,{commentableType:t.props.commentableType,commentableId:t.props.commentableId,comments:s,total:r.comments.topLevelCount,sort:r.comments.currentSort,modifiers:e.concat("top",t.props.modifiers)})):Object(f.div)({className:"comments__items comments__items--empty"},osu.trans("comments.empty")))}));var t},s.prototype.renderComment=function(e,t){return null==t&&(t=!1),e.isDeleted&&!r.comments.isShowDeleted?null:i(a.a,{key:e.id,comment:e,depth:0,modifiers:this.props.modifiers,showDeleted:r.comments.isShowDeleted,expandReplies:!t&&null})},s.prototype.renderComments=function(e,t){var s,o,i,n;for(n=[],o=0,i=e.length;o<i;o++)(s=e[o]).pinned===t&&n.push(this.renderComment(s,t));return n},s.prototype.renderShowDeletedToggle=function(){return Object(f.button)({type:"button",className:"sort__item sort__item--button",onClick:this.toggleShowDeleted},Object(f.span)({className:"sort__item-icon"},Object(f.span)({className:r.comments.isShowDeleted?"fas fa-check-square":"far fa-square"})),osu.trans("common.buttons.show_deleted"))},s.prototype.renderFollowToggle=function(){var e,t,s;return r.comments.userFollow?(e="fas fa-eye-slash",s=osu.trans("common.buttons.watch.to_0")):(e="fas fa-eye",s=osu.trans("common.buttons.watch.to_1")),t=this.props.loadingFollow?i(b.a,{modifiers:["center-inline"]}):Object(f.span)({className:e}),Object(f.button)({type:"button",className:"sort__item sort__item--button",onClick:this.toggleFollow,disabled:this.props.loadingFollow},Object(f.span)({className:"sort__item-icon"},t),s)},s.prototype.toggleShowDeleted=function(){return o.publish("comments:toggle-show-deleted")},s.prototype.toggleFollow=function(){return o.publish("comments:toggle-follow")},s}(m.PureComponent)}).call(this,s("Hs9Z"),s("5wds"))},"2b+G":function(e,t,s){"use strict";(function(e,o){s.d(t,"a",(function(){return b}));var i,n,r=s("6nUW"),a=s("/G9H"),l=s("LQV2"),c=s.n(l),u=s("I8Ok"),d=s("PPOh"),p=s("TY2o"),h=s("/jJF"),m=function(e,t){return function(){return e.apply(t,arguments)}},f={}.hasOwnProperty;n=a.createElement,i="comment-editor";var b=function(t){function s(t){var o;this.post=m(this.post,this),this.onChange=m(this.onChange,this),this.mode=m(this.mode,this),this.isValid=m(this.isValid,this),this.handleKeyDownCallback=m(this.handleKeyDownCallback,this),this.close=m(this.close,this),this.buttonText=m(this.buttonText,this),this.render=m(this.render,this),this.componentWillUnmount=m(this.componentWillUnmount,this),this.componentDidMount=m(this.componentDidMount,this),s.__super__.constructor.call(this,t),this.textarea=a.createRef(),this.throttledPost=e.throttle(this.post,1e3),this.handleKeyDown=InputHandler.textarea(this.handleKeyDownCallback),this.state={message:null!=(o=this.props.message)?o:"",posting:!1}}return function(e,t){for(var s in t)f.call(t,s)&&(e[s]=t[s]);function o(){this.constructor=e}o.prototype=t.prototype,e.prototype=new o,e.__super__=t.prototype}(s,t),s.prototype.componentDidMount=function(){var e,t,s;if(null==(e=this.props.focus)||e)return null!=(t=this.textarea.current)&&(t.selectionStart=-1),null!=(s=this.textarea.current)?s.focus():void 0},s.prototype.componentWillUnmount=function(){var e;return this.throttledPost.cancel(),null!=(e=this.xhr)?e.abort():void 0},s.prototype.render=function(){var e;return e=osu.classWithModifiers(i,this.props.modifiers),"new"===this.mode()&&(e+=" "+i+"--fancy"),Object(u.div)({className:e},"new"===this.mode()?Object(u.div)({className:i+"__avatar"},n(p.a,{user:currentUser,modifiers:["full-circle"]})):void 0,n(c.a,{className:i+"__message",ref:this.textarea,value:this.state.message,placeholder:osu.trans("comments.placeholder."+this.mode()),onChange:this.onChange,onKeyDown:this.handleKeyDown,disabled:null==currentUser.id||this.state.posting}),Object(u.div)({className:i+"__footer"},Object(u.div)({className:i+"__footer-item "+i+"__footer-item--notice hidden-xs"},osu.trans("comments.editor.textarea_hint._",{action:osu.trans("comments.editor.textarea_hint."+this.mode())})),null!=this.props.close?Object(u.div)({className:i+"__footer-item"},n(r.a,{modifiers:["comment-editor"],text:osu.trans("common.buttons.cancel"),props:{onClick:this.props.close,disabled:this.state.posting}})):void 0,null!=currentUser.id?Object(u.div)({className:i+"__footer-item"},n(r.a,{modifiers:["comment-editor"],text:this.state.posting?n(d.a):this.buttonText(),props:{onClick:this.throttledPost,disabled:this.state.posting||!this.isValid()}})):Object(u.div)({className:i+"__footer-item"},n(r.a,{modifiers:["comment-editor"],extraClasses:["js-user-link"],text:osu.trans("comments.guest_button."+this.mode())}))))},s.prototype.buttonText=function(){var e;return e=function(){switch(this.mode()){case"reply":return"reply";case"edit":return"save";case"new":return"post"}}.call(this),osu.trans("common.buttons."+e)},s.prototype.close=function(){var e;if(null!=this.props.close&&((null!=(e=this.props.message)?e:"")===this.state.message||confirm(osu.trans("common.confirmation_unsaved"))))return this.props.close()},s.prototype.handleKeyDownCallback=function(e,t){switch(e){case InputHandler.CANCEL:return this.close();case InputHandler.SUBMIT:return this.throttledPost()}},s.prototype.isValid=function(){return null!=this.state.message&&this.state.message.length>0},s.prototype.mode=function(){return null!=this.props.parent?"reply":null!=this.props.id?"edit":"new"},s.prototype.onChange=function(e){return this.setState({message:e.target.value})},s.prototype.post=function(){var e,t,s,i,n,r,a;if("edit"===this.mode()&&this.state.message===this.props.message)return"function"==typeof(e=this.props).close?e.close():void 0;switch(this.setState({posting:!0}),t={comment:{message:this.state.message}},this.mode()){case"reply":case"new":r=laroute.route("comments.store"),s="POST",t.comment.commentable_type=this.props.commentableType,t.comment.commentable_id=this.props.commentableId,t.comment.parent_id=null!=(n=this.props.parent)?n.id:void 0,a=this,i=function(e){return a.setState({message:""}),o.publish("comments:new",e)};break;case"edit":r=laroute.route("comments.update",{comment:this.props.id}),s="PUT",i=function(e){return o.publish("comment:updated",e)}}return this.xhr=o.ajax(r,{method:s,data:t}).always(function(e){return function(){return e.setState({posting:!1})}}(this)).done(function(e){return function(t){var s,o;return i(t),"function"==typeof(s=e.props).onPosted&&s.onPosted(e.mode()),"function"==typeof(o=e.props).close?o.close():void 0}}(this)).fail(Object(h.c)(this.post))},s}(a.PureComponent)}).call(this,s("Hs9Z"),s("5wds"))},"2etm":function(e,t,s){"use strict";s.d(t,"a",(function(){return o})),s.d(t,"b",(function(){return i})),s.d(t,"c",(function(){return n}));const o={beatmapset_discussion:["fas fa-drafting-compass","fas fa-comment"],beatmapset_problem:["fas fa-drafting-compass","fas fa-exclamation-circle"],beatmapset_state:["fas fa-drafting-compass"],channel:["fas fa-comments"],comment:["fas fa-comment"],forum_topic_reply:["fas fa-comment-medical"],legacy_pm:["fas fa-envelope"],user_achievement_unlock:["fas fa-medal"],user_beatmapset_new:["fas fa-music"]},i={beatmapset_discussion_lock:["fas fa-drafting-compass","fas fa-lock"],beatmapset_discussion_post_new:["fas fa-drafting-compass","fas fa-comment-medical"],beatmapset_discussion_qualified_problem:["fas fa-drafting-compass","fas fa-exclamation-circle"],beatmapset_discussion_unlock:["fas fa-drafting-compass","fas fa-unlock"],beatmapset_disqualify:["fas fa-drafting-compass","far fa-times-circle"],beatmapset_love:["fas fa-drafting-compass","fas fa-heart"],beatmapset_nominate:["fas fa-drafting-compass","fas fa-vote-yea"],beatmapset_qualify:["fas fa-drafting-compass","fas fa-check"],beatmapset_rank:["fas fa-drafting-compass","fas fa-check-double"],beatmapset_remove_from_loved:["fas fa-drafting-compass","fas fa-heart-broken"],beatmapset_reset_nominations:["fas fa-drafting-compass","fas fa-undo"],channel_message:["fas fa-comments"],comment_new:["fas fa-comment"],comment_reply:["fas fa-reply"],forum_topic_reply:["fas fa-comment-medical"],legacy_pm:["fas fa-envelope"],user_achievement_unlock:["fas fa-trophy"],user_beatmapset_new:["fas fa-music"]},n={beatmapset_discussion_lock:["fas fa-lock"],beatmapset_discussion_post_new:["fas fa-comment-medical"],beatmapset_discussion_qualified_problem:["fas fa-exclamation-circle"],beatmapset_discussion_unlock:["fas fa-unlock"],beatmapset_disqualify:["far fa-times-circle"],beatmapset_love:["fas fa-heart"],beatmapset_nominate:["fas fa-vote-yea"],beatmapset_qualify:["fas fa-check"],beatmapset_rank:["fas fa-check-double"],beatmapset_remove_from_loved:["fas fa-heart-broken"],beatmapset_reset_nominations:["fas fa-undo"],channel_message:["fas fa-comments"],comment_new:["fas fa-comment"],comment_reply:["fas fa-reply"],forum_topic_reply:["fas fa-comment-medical"],legacy_pm:["fas fa-envelope"],user_beatmapset_new:["fas fa-music"]}},"3Zv4":function(e,t,s){"use strict";s.d(t,"a",(function(){return n}));var o=s("y2EG"),i=s("71br");class n extends o.a{constructor(){super(-1,null),this.details=Object(i.a)(),this.isRead=!1,this.name="legacy_pm",this.objectId=-1}get count(){var e;return null!==(e=currentUser.unread_pm_count)&&void 0!==e?e:0}}},"4PZ6":function(e,t,s){"use strict";s.d(t,"a",(function(){return i}));var o=s("/G9H");class i extends o.Component{render(){const e=this.props.comments.filter(e=>null!=e.deletedAt).length;return 0===e?null:o.createElement("div",{className:osu.classWithModifiers("deleted-comments-count",this.props.modifiers)},o.createElement("span",{className:"deleted-comments-count__icon"},o.createElement("span",{className:"far fa-trash-alt"})),osu.transChoice("comments.deleted_count",e))}}},"4cxI":function(e,t,s){"use strict";s.d(t,"a",(function(){return n}));var o=s("/G9H"),i=s("tX/w");function n({group:e,modifiers:t}){var s;if(null==e)return null;const n=osu.groupColour(e);let r=Object(i.a)("user-group-badge",{probationary:e.is_probationary,[e.identifier]:!0});r+=Object(i.a)("user-group-badge",t,!0);const a=(null!==(s=e.playmodes)&&void 0!==s?s:[]).map(e=>o.createElement("i",{key:e,className:`fal fa-extra-mode-${e}`}));return o.createElement("div",{className:r,"data-label":e.short_name,style:n,title:e.name},a.length>0&&o.createElement("div",{className:"user-group-badge__modes"},a))}},"5AHq":function(e,t,s){"use strict";s.d(t,"a",(function(){return i}));var o=s("/G9H");const i=o.createContext([])},"5evE":function(e,t,s){"use strict";function o(e){return null==e.objectId||null==e.name||null==e.category?null:"user_achievement_unlock"===e.name?`achievement:${e.id}`:`${e.category}:${e.objectId}`}function i(e){var t;return null!==(t=n[e])&&void 0!==t?t:e}s.d(t,"b",(function(){return o})),s.d(t,"a",(function(){return i}));const n={beatmapset_discussion_lock:"beatmapset_discussion",beatmapset_discussion_post_new:"beatmapset_discussion",beatmapset_discussion_qualified_problem:"beatmapset_problem",beatmapset_discussion_review_new:"beatmapset_discussion",beatmapset_discussion_unlock:"beatmapset_discussion",beatmapset_disqualify:"beatmapset_state",beatmapset_love:"beatmapset_state",beatmapset_nominate:"beatmapset_state",beatmapset_qualify:"beatmapset_state",beatmapset_rank:"beatmapset_state",beatmapset_remove_from_loved:"beatmapset_state",beatmapset_reset_nominations:"beatmapset_state",channel_message:"channel",comment_new:"comment",comment_reply:"comment",forum_topic_reply:"forum_topic_reply",legacy_pm:"legacy_pm",user_achievement_unlock:"user_achievement_unlock",user_beatmapset_new:"user_beatmapset_new"}},"69Vu":function(e,t,s){"use strict";s.d(t,"a",(function(){return n}));const o=e=>e.toString().padStart(2,"0"),i={},n=(e,t)=>{var s;const n=Math.floor(e);if(i.time!==n||i.format!==t){i.format=t,i.time=n;const e=n%60,s=Math.floor(n/60);if("minute_minimal"===t)i.formatted=`'${s}:${o(e)}'`;else if("minute"===t)i.formatted=`'${o(s)}:${o(e)}'`;else{const n=s%60,r=Math.floor(s/60);i.formatted="hour_minimal"===t?`'${r}:${o(n)}:${o(e)}'`:`'${o(r)}:${o(n)}:${o(e)}'`}}return null!==(s=i.formatted)&&void 0!==s?s:""}},"6QPw":function(e,t,s){"use strict";var o=s("cF9b"),i=s("3Zv4"),n=s("2etm"),r=s("mjdM"),a=s("/G9H");let l=class extends a.Component{render(){const e=new i.a;return 0===e.count?null:a.createElement(r.a,{icons:n.b.legacy_pm,item:e,message:osu.transChoice("notifications.item.legacy_pm.legacy_pm.legacy_pm",e.count),modifiers:["one"],url:"/forum/ucp.php?i=pm&folder=inbox",withCategory:!0,withCoverImage:!0})}};l=function(e,t,s,o){var i,n=arguments.length,r=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,s):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,s,o);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(r=(n<3?i(r):n>3?i(t,s,r):i(t,s))||r);return n>3&&r&&Object.defineProperty(t,s,r),r}([o.e],l),t.a=l},"6b0J":function(e,t,s){"use strict";s.d(t,"a",(function(){return i}));var o=s("/G9H");const i=o.createContext({})},"6e4D":function(e,t,s){"use strict";s.d(t,"a",(function(){return i}));var o=s("/G9H");class i extends o.PureComponent{render(){var e;const t=this.props.values.map(e=>{var t;let s="sort__item sort__item--button";return this.props.currentValue===e&&(s+=" sort__item--active"),o.createElement("button",{key:e,className:s,"data-value":e,onClick:this.props.onChange},"rank"===e?o.createElement("span",null,o.createElement("i",{className:`fas fa-extra-mode-${null!==(t=currentUser.playmode)&&void 0!==t?t:"osu"}`})," ",osu.trans("sort.rank")):osu.trans(`${this.props.transPrefix}${e}`))});return o.createElement("div",{className:osu.classWithModifiers("sort",this.props.modifiers)},o.createElement("div",{className:"sort__items"},this.props.showTitle&&o.createElement("span",{className:"sort__item sort__item--title"},null!==(e=this.props.title)&&void 0!==e?e:osu.trans("sort._")),t))}}i.defaultProps={showTitle:!0,transPrefix:"sort."}},"6nUW":function(e,t,s){"use strict";s.d(t,"a",(function(){return a}));var o,i=s("/G9H"),n=s("I8Ok"),r=s("PPOh");o=i.createElement;var a=function(e){var t,s,i,a,l,c,u,d,p,h,m,f,b,v;for(u=null!=(p=e.modifiers)?p:[],v=e.text,s=e.icon,d=null!=(h=e.props)?h:{},t=null!=(m=e.extraClasses)?m:[],i=null!=(f=e.isBusy)&&f,d.className=osu.classWithModifiers("btn-osu-big",u),a=0,c=t.length;a<c;a++)l=t[a],d.className+=" "+l;return(null!=d.href?d.disabled?n.span:n.a:n.button)(d,Object(n.span)({className:"btn-osu-big__content "+(null==v||null==s?"btn-osu-big__content--center":"")},null!=v?Object(n.span)({className:"btn-osu-big__left"},Object(n.span)({className:"btn-osu-big__text-top"},null!=(b=v.top)?b:v),null!=v.bottom?Object(n.span)({className:"btn-osu-big__text-bottom"},v.bottom):void 0):void 0,null!=s?Object(n.span)({className:"btn-osu-big__icon"},Object(n.span)({className:"fa-fw"},i?o(r.a):Object(n.i)({className:s}))):void 0))}},"71br":function(e,t,s){"use strict";function o(){return{coverUrl:null,title:""}}s.d(t,"a",(function(){return o}))},"7dd3":function(e,t,s){"use strict";(function(e,o){s.d(t,"a",(function(){return u}));var i,n=s("S5CA"),r=s("/G9H"),a=s("I8Ok"),l=function(e,t){return function(){return e.apply(t,arguments)}},c={}.hasOwnProperty;i=r.createElement;var u=function(t){function s(){return this.renderNav=l(this.renderNav,this),this.render=l(this.render,this),s.__super__.constructor.apply(this,arguments)}return function(e,t){for(var s in t)c.call(t,s)&&(e[s]=t[s]);function o(){this.constructor=e}o.prototype=t.prototype,e.prototype=new o,e.__super__=t.prototype}(s,t),s.prototype.render=function(){var t,s,r,l,c,u;return t=osu.classWithModifiers("build",this.props.modifiers),l=e.groupBy(this.props.build.changelog_entries,"category"),s=e(l).keys().sort().value(),Object(a.div)({className:t+" t-changelog-stream--"+e.kebabCase(this.props.build.update_stream.display_name)},Object(a.div)({className:"build__version"},this.renderNav({version:"previous",icon:"fas fa-chevron-left"}),Object(a.a)({className:"build__version-link",href:_exported.OsuUrlHelper.changelogBuild(this.props.build)},Object(a.span)({className:"build__stream"},this.props.build.update_stream.display_name)," ",Object(a.span)({className:"u-changelog-stream--text"},this.props.build.display_version)),this.renderNav({version:"next",icon:"fas fa-chevron-right"})),null!=(u=this.props.showDate)&&u?Object(a.div)({className:"build__date"},o(this.props.build.created_at).format("LL")):void 0,function(){var e,t,o;for(o=[],e=0,t=s.length;e<t;e++)r=s[e],o.push(Object(a.div)({key:r,className:"build__changelog-entries-container"},Object(a.div)({className:"build__changelog-entries-category"},r),Object(a.div)({className:"build__changelog-entries"},function(){var e,t,s,o,u;for(u=[],e=0,t=(s=l[r]).length;e<t;e++)c=s[e],u.push(Object(a.div)({key:null!=(o=c.id)?o:c.created_at+"-"+c.title,className:"build__changelog-entry"},i(n.a,{entry:c})));return u}())));return o}())},s.prototype.renderNav=function(e){var t,s,o;if(o=e.version,s=e.icon,null!=this.props.build.versions)return null!=(t=this.props.build.versions[o])?Object(a.a)({className:"build__version-link",href:_exported.OsuUrlHelper.changelogBuild(t),title:t.display_version},Object(a.i)({className:s})):Object(a.span)({className:"build__version-link build__version-link--disabled"},Object(a.i)({className:s}))},s}(r.PureComponent)}).call(this,s("Hs9Z"),s("7EfK"))},"8Xmz":function(e,t,s){"use strict";var o=s("cF9b"),i=s("/G9H"),n=s("PPOh"),r=function(e,t,s,o){var i,n=arguments.length,r=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,s):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,s,o);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(r=(n<3?i(r):n>3?i(t,s,r):i(t,s))||r);return n>3&&r&&Object.defineProperty(t,s,r),r};let a=class extends i.Component{render(){return this.props.isDeleting?i.createElement("div",{className:osu.classWithModifiers("notification-action-button",this.props.modifiers)},i.createElement("span",{className:"notification-action-button__text"},this.props.text),i.createElement("div",{className:"notification-action-button__icon"},i.createElement(n.a,null))):i.createElement("button",{className:osu.classWithModifiers("notification-action-button",this.props.modifiers),onClick:this.props.onDelete,type:"button"},i.createElement("span",{className:"notification-action-button__text"},this.props.text),i.createElement("div",{className:"notification-action-button__icon"},i.createElement("span",{className:"fas fa-trash"})))}};a.defaultProps={modifiers:[]},a=r([o.e],a),t.a=a},"98HE":function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return n}));var o=s("bpgk"),i=s("WLnA");class n{constructor(){this.userLogin=()=>{Object(i.a)(new o.a)},this.userLogout=()=>{Object(i.a)(new o.b)},e(document).on("ajax:success",".js-logout-link",this.userLogout).on("ajax:success",".js-login-form",this.userLogin)}}}).call(this,s("5wds"))},"9tJ9":function(e,t,s){"use strict";(function(e){function o(){const e=.01*window.innerHeight;document.documentElement.style.setProperty("--vh",`${e}px`)}s.d(t,"a",(function(){return i}));class i{constructor(){e(window).on("resize.windowVHPatch",o),o()}}}).call(this,s("5wds"))},"9zVE":function(e,t,s){"use strict";var o=s("cF9b"),i=s("/G9H"),n=s("PPOh"),r=function(e,t,s,o){var i,n=arguments.length,r=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,s):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,s,o);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(r=(n<3?i(r):n>3?i(t,s,r):i(t,s))||r);return n>3&&r&&Object.defineProperty(t,s,r),r};let a=class extends i.Component{render(){return this.props.isMarkingAsRead?i.createElement("div",{className:osu.classWithModifiers("notification-action-button",this.props.modifiers)},i.createElement("span",{className:"notification-action-button__text"},this.props.text),i.createElement("div",{className:"notification-action-button__icon"},i.createElement(n.a,null))):i.createElement("button",{className:osu.classWithModifiers("notification-action-button",this.props.modifiers),onClick:this.props.onMarkAsRead,type:"button"},i.createElement("span",{className:"notification-action-button__text"},this.props.text),i.createElement("div",{className:"notification-action-button__icon"},i.createElement("span",{className:"fas fa-check"})))}};a.defaultProps={modifiers:[]},a=r([o.e],a),t.a=a},AJEZ:function(e,t,s){"use strict";s.d(t,"a",(function(){return n}));var o=s("/G9H"),i=s("4cxI");function n(e){const{groups:t=[],modifiers:s,short:n=!1,wrapper:r}=e;let a=!1;return o.createElement(o.Fragment,null,t.map(e=>{const t=n&&a?`${r} u-hidden-narrow`:r;return a=!0,o.createElement("span",{key:e.identifier,className:t},o.createElement(i.a,{group:e,modifiers:s}))}))}},AU96:function(e,t,s){"use strict";(function(e,o){s.d(t,"a",(function(){return O}));var i,n,r=s("Yin1"),a=s("CnOT"),l=s("VxeA"),c=s("XMXc"),u=s("6nUW"),d=s("f7bm"),p=s("/G9H"),h=s("LQV2"),m=s.n(h),f=s("I8Ok"),b=s("hc33"),v=s("ufn5"),y=s("Y9Pv"),g=s("DHbW"),_=s("tX/w"),w=function(e,t){return function(){return e.apply(t,arguments)}},E={}.hasOwnProperty;n=p.createElement,i="beatmap-discussion-post";var O=function(t){function s(t){this.validPost=w(this.validPost,this),this.updatePost=w(this.updatePost,this),this.updateCanSave=w(this.updateCanSave,this),this.setMessage=w(this.setMessage,this),this.isTimeline=w(this.isTimeline,this),this.canReport=w(this.canReport,this),this.messageViewer=w(this.messageViewer,this),this.messageEditor=w(this.messageEditor,this),this.isOwner=w(this.isOwner,this),this.handleKeyDownCallback=w(this.handleKeyDownCallback,this),this.editStart=w(this.editStart,this),this.editCancel=w(this.editCancel,this),this.render=w(this.render,this),this.componentWillUnmount=w(this.componentWillUnmount,this),s.__super__.constructor.call(this,t),this.textareaRef=p.createRef(),this.messageBodyRef=p.createRef(),this.throttledUpdatePost=e.throttle(this.updatePost,1e3),this.handleKeyDown=InputHandler.textarea(this.handleKeyDownCallback),this.xhr={},this.reviewEditor=p.createRef(),this.state={canSave:!0,editing:!1,editorMinHeight:"0",posting:!1,message:null}}return function(e,t){for(var s in t)E.call(t,s)&&(e[s]=t[s]);function o(){this.constructor=e}o.prototype=t.prototype,e.prototype=new o,e.__super__=t.prototype}(s,t),s.prototype.componentWillUnmount=function(){var e,t,s,o;for(e in this.throttledUpdatePost.cancel(),s=[],t=this.xhr)E.call(t,e)&&(o=t[e],s.push(null!=o?o.abort():void 0));return s},s.prototype.render=function(){var e,t,s;return t=Object(_.a)(i,((e={})[""+this.props.type]=!0,e.deleted=null!=this.props.post.deleted_at,e.editing=this.state.editing,e.unread=!this.props.read&&"discussion"!==this.props.type,e)),Object(f.div)({className:t,key:this.props.type+"-"+this.props.post.id,onClick:(s=this,function(){return o.publish("beatmapDiscussionPost:markRead",{id:s.props.post.id})})},Object(f.div)({className:i+"__content"},this.props.hideUserCard?void 0:n(a.a,{user:this.props.user,group:this.userGroup()}),this.state.editing?this.messageEditor():this.messageViewer()))},s.prototype.editCancel=function(){return this.setState({editing:!1})},s.prototype.editStart=function(){var e,t;return null!=this.messageBodyRef.current&&(e=this.messageBodyRef.current.getBoundingClientRect().height+50+"px"),this.setState({editing:!0,editorMinHeight:null!=e?e:"0",message:this.props.post.message},(t=this,function(){var e;return null!=(e=t.textareaRef.current)?e.focus():void 0}))},s.prototype.handleKeyDownCallback=function(e,t){switch(e){case InputHandler.SUBMIT:return this.throttledUpdatePost()}},s.prototype.isOwner=function(){return this.props.post.user_id===this.props.beatmapset.user_id},s.prototype.messageEditor=function(){var e,t;if(this.props.canBeEdited)return e=!this.state.posting&&this.state.canSave,Object(f.div)({className:i+"__message-container"},"review"===this.props.discussion.message_type&&"discussion"===this.props.type?n(g.a.Consumer,null,(t=this,function(e){return n(y.a.Consumer,null,(function(s){return n(v.a,{beatmapset:t.props.beatmapset,beatmaps:s,document:t.props.post.message,discussion:t.props.discussion,discussions:e,editMode:!0,editing:t.state.editing,ref:t.reviewEditor,onChange:t.updateCanSave})}))})):n(p.Fragment,null,n(m.a,{style:{minHeight:this.state.editorMinHeight},disabled:this.state.posting,className:i+"__message "+i+"__message--editor",onChange:this.setMessage,onKeyDown:this.handleKeyDown,value:this.state.message,ref:this.textareaRef}),n(r.a,{message:this.state.message,isTimeline:this.isTimeline()})),Object(f.div)({className:i+"__actions"},Object(f.div)({className:i+"__actions-group"}),Object(f.div)({className:i+"__actions-group"},Object(f.div)({className:i+"__action"},n(u.a,{text:osu.trans("common.buttons.cancel"),props:{onClick:this.editCancel,disabled:this.state.posting}})),Object(f.div)({className:i+"__action"},n(u.a,{text:osu.trans("common.buttons.save"),props:{onClick:this.throttledUpdatePost,disabled:!e}})))))},s.prototype.messageViewer=function(){var e,t,s,o,r,a,l,u;return e=(a="reply"===this.props.type?["beatmapsets.discussions.posts","post",this.props.post]:["beatmapsets.discussions","discussion",this.props.discussion])[0],s=a[1],t=a[2],Object(f.div)({className:i+"__message-container"},"review"===this.props.discussion.message_type&&"discussion"===this.props.type?Object(f.div)({className:i+"__message"},n(c.a,{discussions:this.context.discussions,message:this.props.post.message})):Object(f.div)({className:i+"__message",ref:this.messageBodyRef,dangerouslySetInnerHTML:{__html:BeatmapDiscussionHelper.format(this.props.post.message)}}),Object(f.div)({className:i+"__info-container"},Object(f.span)({className:i+"__info",dangerouslySetInnerHTML:{__html:osu.timeago(this.props.post.created_at)}}),null!=t.deleted_at?Object(f.span)({className:i+"__info "+i+"__info--edited",dangerouslySetInnerHTML:{__html:osu.trans("beatmaps.discussions.deleted",{editor:osu.link(laroute.route("users.show",{user:t.deleted_by_id}),null!=(l=this.props.users[t.deleted_by_id])?l.username:void 0,{classNames:[i+"__info-user"]}),delete_time:osu.timeago(t.deleted_at)})}}):void 0,this.props.post.updated_at!==this.props.post.created_at&&null!=this.props.lastEditor?Object(f.span)({className:i+"__info "+i+"__info--edited",dangerouslySetInnerHTML:{__html:osu.trans("beatmaps.discussions.edited",{editor:osu.link(laroute.route("users.show",{user:this.props.lastEditor.id}),this.props.lastEditor.username,{classNames:[i+"__info-user"]}),update_time:osu.timeago(this.props.post.updated_at)})}}):void 0,"discussion"===this.props.type&&this.props.discussion.kudosu_denied?Object(f.span)({className:i+"__info "+i+"__info--edited"},osu.trans("beatmaps.discussions.kudosu_denied")):void 0),Object(f.div)({className:i+"__actions"},Object(f.div)({className:i+"__actions-group"},"discussion"===this.props.type?Object(f.span)({className:i+"__action "+i+"__action--button"},n(d.a,{value:BeatmapDiscussionHelper.url({discussion:this.props.discussion}),label:osu.trans("common.buttons.permalink"),valueAsUrl:!0})):void 0,this.props.canBeEdited?Object(f.button)({className:i+"__action "+i+"__action--button",onClick:this.editStart},osu.trans("beatmaps.discussions.edit")):void 0,null==t.deleted_at&&this.props.canBeDeleted?Object(f.a)({className:"js-beatmapset-discussion-update "+i+"__action "+i+"__action--button",href:laroute.route(e+".destroy",(o={},o[""+s]=t.id,o)),"data-remote":!0,"data-method":"DELETE","data-confirm":osu.trans("common.confirmation")},osu.trans("beatmaps.discussions.delete")):void 0,null!=t.deleted_at&&this.props.canBeRestored?Object(f.a)({className:"js-beatmapset-discussion-update "+i+"__action "+i+"__action--button",href:laroute.route(e+".restore",(r={},r[""+s]=t.id,r)),"data-remote":!0,"data-method":"POST","data-confirm":osu.trans("common.confirmation")},osu.trans("beatmaps.discussions.restore")):void 0,"discussion"===this.props.type&&(null!=(u=this.props.discussion.current_user_attributes)?u.can_moderate_kudosu:void 0)?this.props.discussion.can_grant_kudosu?Object(f.a)({className:"js-beatmapset-discussion-update "+i+"__action "+i+"__action--button",href:laroute.route("beatmapsets.discussions.deny-kudosu",{discussion:this.props.discussion.id}),"data-remote":!0,"data-method":"POST","data-confirm":osu.trans("common.confirmation")},osu.trans("beatmaps.discussions.deny_kudosu")):this.props.discussion.kudosu_denied?Object(f.a)({className:"js-beatmapset-discussion-update "+i+"__action "+i+"__action--button",href:laroute.route("beatmapsets.discussions.allow-kudosu",{discussion:this.props.discussion.id}),"data-remote":!0,"data-method":"POST","data-confirm":osu.trans("common.confirmation")},osu.trans("beatmaps.discussions.allow_kudosu")):void 0:void 0,this.canReport()?n(b.a,{className:i+"__action "+i+"__action--button",reportableId:this.props.post.id,reportableType:"beatmapset_discussion_post",user:this.props.user}):void 0)))},s.prototype.canReport=function(){return null!=currentUser.id&&this.props.post.user_id!==currentUser.id},s.prototype.isTimeline=function(){return null!=this.props.discussion.timestamp},s.prototype.setMessage=function(e){return this.setState({message:e.target.value},this.updateCanSave)},s.prototype.updateCanSave=function(){return this.setState({canSave:this.validPost()})},s.prototype.updatePost=function(){var t,s,i;if(t=this.state.message,"review"===this.props.discussion.message_type&&"discussion"===this.props.type){if(t=this.reviewEditor.current.serialize(),e.isEqual(JSON.parse(this.props.post.message),JSON.parse(t)))return void this.setState({editing:!1});if(!this.reviewEditor.current.showConfirmationIfRequired())return;this.setState({message:t})}if(t!==this.props.post.message)return this.setState({posting:!0}),null!=(s=this.xhr.updatePost)&&s.abort(),this.xhr.updatePost=o.ajax(laroute.route("beatmapsets.discussions.posts.update",{post:this.props.post.id}),{method:"PUT",data:{beatmap_discussion_post:{message:t}}}).done((i=this,function(e){return i.setState({editing:!1}),o.publish("beatmapsetDiscussions:update",{beatmapset:e})})).fail(osu.ajaxError).always(function(e){return function(){return e.setState({posting:!1})}}(this));this.setState({editing:!1})},s.prototype.userGroup=function(){var e;return this.isOwner()?l.a:null!=(e=this.props.user.groups)?e[0]:void 0},s.prototype.validPost=function(){var e;return"review"===this.props.discussion.message_type&&"discussion"===this.props.type?null!=(e=this.reviewEditor.current)?e.canSave:void 0:BeatmapDiscussionHelper.validMessageLength(this.state.message,this.isTimeline())},s}(p.PureComponent)}).call(this,s("Hs9Z"),s("5wds"))},"B+BC":function(e,t,s){"use strict";s.d(t,"a",(function(){return a}));var o=s("/G9H"),i=s("I8Ok"),n=function(e,t){return function(){return e.apply(t,arguments)}},r={}.hasOwnProperty;o.createElement;var a=function(e){function t(){return this.render=n(this.render,this),t.__super__.constructor.apply(this,arguments)}return function(e,t){for(var s in t)r.call(t,s)&&(e[s]=t[s]);function o(){this.constructor=e}o.prototype=t.prototype,e.prototype=new o,e.__super__=t.prototype}(t,e),t.prototype.render=function(){var e,t;return Object(i.div)({className:"profile-badges"},function(){var s,o,n,r;for(r=[],s=0,o=(n=this.props.badges).length;s<o;s++)e=n[s],t=osu.present(e.url)?i.a:i.div,r.push(t({key:e.image_url,href:osu.present(e.url)?e.url:void 0,className:"profile-badges__badge",style:{backgroundImage:osu.urlPresence(e.image_url)},title:e.description}));return r}.call(this))},t}(o.PureComponent)},BCxl:function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return d}));var o=s("Hs9Z"),i=s("/G9H"),n=s("tSlR"),r=s("dTpI"),a=s("5AHq"),l=s("yJmy"),c=s("zr5c"),u=s("ss8h");class d extends i.Component{constructor(){super(...arguments),this.bn="beatmap-discussion-review-post-embed-preview",this.cache={},this.tooltipContent=i.createRef(),this.componentDidMount=()=>{this.editable()&&n.h.setNodes(this.context,{timestamp:void 0},{at:this.path()})},this.componentDidUpdate=()=>{if(!this.editable())return;const e=this.path();let t=!1;if(this.props.element.beatmapId){const s=this.props.element.children[0].text.match(BeatmapDiscussionHelper.TIMESTAMP_REGEX);let o;null!==s&&0===s.index&&(o=s[2]),o!==this.props.element.timestamp&&(t=!0),n.h.setNodes(this.context,{timestamp:o},{at:e})}else n.h.setNodes(this.context,{timestamp:void 0},{at:e}),t=!0;t&&(this.cache={},this.destroyTooltip())},this.createTooltip=t=>{const s=this.timestamp();if(null==s)return;const o=t.currentTarget,i=`${this.selectedBeatmap()}-${s}`;this.tooltipEl&&this.tooltipEl._tooltip===i||(this.tooltipEl=o,o._tooltip=i,e(o).qtip({content:{text:()=>{var e;return null===(e=this.tooltipContent.current)||void 0===e?void 0:e.innerHTML}},hide:{delay:200,fixed:!0},position:{at:"top center",my:"bottom center",viewport:e(window)},show:{delay:200,ready:!0},style:{classes:"tooltip-default tooltip-default--interactable"}}),this.tooltipEl=o)},this.delete=()=>{window.setTimeout(()=>n.h.delete(this.context,{at:this.path()}),0)},this.destroyTooltip=()=>{if(!this.tooltipEl)return;const t=e(this.tooltipEl).qtip("api");t&&(t.destroy(),this.tooltipEl=void 0)},this.discussionType=()=>this.props.element.discussionType,this.editable=()=>!(this.props.editMode&&this.props.element.discussionId),this.isRelevantDiscussion=e=>null!=e&&e.beatmap_id===this.selectedBeatmap(),this.nearbyDiscussions=()=>{var e;const t=this.timestamp();if(null==t)return[];if(!this.cache.nearbyDiscussions||this.cache.nearbyDiscussions.timestamp!==t||this.cache.nearbyDiscussions.beatmap_id!==this.selectedBeatmap()){const e=o.filter(this.props.discussions,this.isRelevantDiscussion);this.cache.nearbyDiscussions={beatmap_id:this.selectedBeatmap(),discussions:BeatmapDiscussionHelper.nearbyDiscussions(e,t),timestamp:t}}return null===(e=this.cache.nearbyDiscussions)||void 0===e?void 0:e.discussions},this.nearbyDraftEmbeds=e=>{const t=this.timestamp();if(null!=t&&0!==e.length)return e.filter(e=>{if(!e.timestamp||e.beatmapId!==this.props.element.beatmapId)return!1;const s=BeatmapDiscussionHelper.parseTimestamp(e.timestamp);return null!=s&&Math.abs(s-t)<=5e3})},this.nearbyIndicator=e=>{if(null==this.timestamp()||"praise"===this.discussionType())return;const t=this.editable()?this.nearbyDiscussions():[],s=this.nearbyDraftEmbeds(e)||[];if(t.length>0||s.length>1){const e=t.map(e=>{const t=BeatmapDiscussionHelper.formatTimestamp(e.timestamp);if(null!=t)return this.props.editMode?t:osu.link(BeatmapDiscussionHelper.url({discussion:e}),t,{classNames:["js-beatmap-discussion--jump"]})});s.length>1&&e.push(osu.trans("beatmap_discussions.nearby_posts.unsaved",{count:s.length-1}));const o=osu.transArray(e),n=osu.trans("beatmap_discussions.nearby_posts.notice",{existing_timestamps:o,timestamp:this.props.element.timestamp});return i.createElement("div",{className:`${this.bn}__indicator ${this.bn}__indicator--warning`,contentEditable:!1,onMouseOver:this.createTooltip,onTouchStart:this.createTooltip},i.createElement("script",{dangerouslySetInnerHTML:{__html:n},ref:this.tooltipContent,type:"text/html"}),i.createElement("i",{className:"fas fa-exclamation-triangle"}))}},this.path=()=>r.b.findPath(this.context,this.props.element),this.selectedBeatmap=()=>this.props.element.beatmapId,this.timestamp=()=>BeatmapDiscussionHelper.parseTimestamp(this.props.element.timestamp)}componentWillUnmount(){this.destroyTooltip()}render(){const e=this.editable(),t=e?[]:["read-only"];let s,o=this.props.element.timestamp;null!=this.props.element.beatmapId?s="diff":(s="all-diff",o=void 0);const n=osu.trans(`beatmaps.discussions.review.embed.timestamp.${s}`,{type:osu.trans(`beatmaps.discussions.message_type.${this.discussionType()}`)}),r=i.createElement("button",{className:`${this.bn}__delete`,contentEditable:!1,disabled:this.props.readOnly,onClick:this.delete,title:osu.trans(`beatmaps.discussions.review.embed.${e?"delete":"unlink"}`)},i.createElement("i",{className:`fas fa-${e?"trash-alt":"link"}`})),u=i.createElement(a.a.Consumer,null,this.nearbyIndicator),d=this.props.editMode&&e?i.createElement("div",{className:`${this.bn}__indicator`,contentEditable:!1,title:osu.trans("beatmaps.discussions.review.embed.unsaved")},i.createElement("i",{className:"fas fa-pencil-alt"})):null;return i.createElement("div",Object.assign({className:"beatmap-discussion beatmap-discussion--preview",contentEditable:e,suppressContentEditableWarning:!0},this.props.attributes),i.createElement("div",{className:osu.classWithModifiers(this.bn,t)},i.createElement("div",{className:`${this.bn}__content`},i.createElement("div",{className:`${this.bn}__selectors`,contentEditable:!1},i.createElement(l.a,Object.assign({},this.props,{disabled:this.props.readOnly||!e})),i.createElement(c.a,Object.assign({},this.props,{disabled:this.props.readOnly||!e})),i.createElement("div",{className:`${this.bn}__timestamp`,contentEditable:!1},i.createElement("span",{title:e?n:""},null!=o?o:osu.trans("beatmap_discussions.timestamp_display.general"))),d,u),i.createElement("div",{className:`${this.bn}__stripe`,contentEditable:!1}),i.createElement("div",{className:`${this.bn}__message-container`},i.createElement("div",{className:"beatmapset-discussion-message"},this.props.children)),d,u)),r)}}d.contextType=u.a}).call(this,s("5wds"))},BSzr:function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return O}));var o=s("zFzD"),i=s("EQj2"),n=s("nN9y"),r=s("hTAd"),a=s("ou1O"),l=s("CSpP"),c=s("EADP"),u=s("dxU0"),d=s("EaLk"),p=s("I7Md"),h=s("HPV+"),m=s("h70U"),f=s("0VTr"),b=s("VsY1"),v=s("KYGQ"),y=s("tml4"),g=s("98HE"),_=s("D6/9"),w=s("9tJ9"),E=s("xmnK");class O{constructor(){this.captcha=new i.a,this.clickMenu=new r.a,this.forumPoll=new l.a,this.localtime=new c.a,this.mobileToggle=new u.a,this.osuAudio=new h.a,this.osuLayzr=new m.a,this.turbolinksReload=new v.a,this.userVerification=new _.a,this.windowVHPatcher=new w.a,this.onCurrentUserUpdate=(e,t)=>{this.setCurrentUser(t)},this.onPageLoad=()=>{this.setCurrentUser(window.currentUser)},this.setCurrentUser=e=>{this.dataStore.userStore.getOrCreate(e.id,e),this.socketWorker.setUserId(e.id),this.currentUser=null==e.id?void 0:e},this.enchant=new a.a(this.turbolinksReload),this.userLogin=new y.a(this.captcha),this.dataStore=new b.a,this.chatWorker=new n.a(this.dataStore.channelStore),this.userLoginObserver=new g.a,this.windowFocusObserver=new E.a,this.beatmapsetSearchController=new o.a(this.dataStore.beatmapsetSearch),this.socketWorker=new f.a,this.notificationsWorker=new p.a(this.socketWorker),e(document).on("turbolinks:load.osu-core",this.onPageLoad),e.subscribe("user:update",this.onCurrentUserUpdate)}}(function(e,t,s,o){var i,n=arguments.length,r=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,s):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,s,o);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(r=(n<3?i(r):n>3?i(t,s,r):i(t,s))||r);n>3&&r&&Object.defineProperty(t,s,r)})([d.m],O.prototype,"currentUser",void 0)}).call(this,s("5wds"))},BTwX:function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return d}));var o=s("Hs9Z"),i=s("vcN5"),n=s("/G9H"),r=s("tSlR"),a=s("dTpI"),l=s("gcbN"),c=s("ss8h");const u="beatmap-discussion-editor-toolbar";class d extends n.Component{constructor(){super(...arguments),this.ref=n.createRef(),this.throttledUpdate=o.throttle(this.updatePosition.bind(this),100),this.uuid=osu.uuid()}componentDidMount(){e(window).on(`scroll.${this.uuid}`,this.throttledUpdate),this.updatePosition()}componentDidUpdate(){this.updatePosition()}componentWillUnmount(){e(window).off(`.${this.uuid}`),this.scrollContainer&&e(this.scrollContainer).off(`.${this.uuid}`),this.throttledUpdate.cancel()}hide(){const e=this.ref.current;e&&(e.style.display="none")}render(){return this.context&&this.visible()?n.createElement(i.a,null,n.createElement("div",{ref:this.ref,className:u},n.createElement(l.a,{format:"bold"}),n.createElement(l.a,{format:"italic"}),n.createElement("div",{className:`${u}__popup-tail`}))):null}setScrollContainer(t){this.scrollContainer&&e(this.scrollContainer).off(`.${this.uuid}`),this.scrollContainer=t,e(this.scrollContainer).on(`scroll.${this.uuid}`,this.throttledUpdate)}updatePosition(){const e=this.ref.current;e&&this.context&&(this.scrollTimer&&window.clearTimeout(this.scrollTimer),this.scrollTimer=window.setTimeout(()=>{var t,s,o;if(!this.visible())return this.hide();for(const e of r.a.positions(this.context,{at:null!==(t=this.context.selection)&&void 0!==t?t:void 0,unit:"block"})){if("embed"===r.c.parent(this.context,e.path).type)return this.hide()}const i=null===(s=this.scrollContainer)||void 0===s?void 0:s.getBoundingClientRect(),n=null!==(o=null==i?void 0:i.top)&&void 0!==o?o:0,a=null==i?void 0:i.bottom,l=window.getSelection().getRangeAt(0).getBoundingClientRect();if(l.top<n||a&&l.top>a)return this.hide();e.style.display="block",e.style.left=`${l.left+(window.pageXOffset-e.offsetWidth)/2+l.width/2}px`,e.style.top=`${l.top-e.clientHeight-10}px`},10))}visible(){const{selection:e}=this.context;if(!e||!a.b.isFocused(this.context)||r.f.isCollapsed(e)||""===r.a.string(this.context,e))return!1;const t=window.getSelection();return null!==(null==t?void 0:t.getRangeAt(0))}}d.contextType=c.a}).call(this,s("5wds"))},BvKu:function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return d}));var o=s("/G9H"),i=s("WKXC"),n=s("I8Ok"),r=s("LhsB"),a=s("txhI"),l=function(e,t){return function(){return e.apply(t,arguments)}},c={}.hasOwnProperty,u=[].indexOf||function(e){for(var t=0,s=this.length;t<s;t++)if(t in this&&this[t]===e)return t;return-1},d=function(t){function s(e){this.renderMenu=l(this.renderMenu,this),this.render=l(this.render,this),this.removePortal=l(this.removePortal,this),this.addPortal=l(this.addPortal,this),this.tooltipElement=l(this.tooltipElement,this),this.toggle=l(this.toggle,this),this.isMenuInPath=l(this.isMenuInPath,this),this.hide=l(this.hide,this),this.dismiss=l(this.dismiss,this),this.componentWillUnmount=l(this.componentWillUnmount,this),this.componentDidUpdate=l(this.componentDidUpdate,this),this.resize=l(this.resize,this),this.componentDidMount=l(this.componentDidMount,this),s.__super__.constructor.call(this,e),this.uuid=osu.uuid(),this.menu=Object(o.createRef)(),this.state={active:!1}}return function(e,t){for(var s in t)c.call(t,s)&&(e[s]=t[s]);function o(){this.constructor=e}o.prototype=t.prototype,e.prototype=new o,e.__super__=t.prototype}(s,t),s.contextType=r.a,s.defaultProps={children:function(e){}},s.prototype.componentDidMount=function(){return this.tooltipHideEvent=this.tooltipElement().qtip("option","hide.event"),e(window).on("resize."+this.uuid,this.resize),e(document).on("turbolinks:before-cache."+this.uuid,(t=this,function(){return t.removePortal()}));var t},s.prototype.resize=function(){var t,s,o,i,n;if(this.state.active){if(null!=this.menu.current.offsetParent)return n=(o=(t=e(this.menu.current)).offset()).top,s=o.left,this.portal.style.display="block",this.portal.style.position="absolute",this.portal.style.top=Math.floor(n+t.height()/2)+"px",this.portal.style.left=Math.floor(s+t.width())+"px",null!=(i=this.tooltipElement()[0])?this.portal.style.zIndex=getComputedStyle(i).zIndex:void 0;this.portal.style.display="none"}},s.prototype.componentDidUpdate=function(t,s){var o,i;if(s.active!==this.state.active)return this.state.active?(this.resize(),this.addPortal(),this.tooltipElement().qtip("option","hide.event",!1),e(document).on("click."+this.uuid+" keydown."+this.uuid,this.hide),"function"==typeof(o=this.props).onShow?o.onShow():void 0):(this.removePortal(),this.tooltipElement().qtip("option","hide.event",this.tooltipHideEvent),e(document).off("click."+this.uuid+" keydown."+this.uuid,this.hide),"function"==typeof(i=this.props).onHide?i.onHide():void 0)},s.prototype.componentWillUnmount=function(){return e(document).off("."+this.uuid),e(window).off("."+this.uuid)},s.prototype.dismiss=function(){return this.setState({active:!1})},s.prototype.hide=function(e){var t;if(this.state.active&&!a.a.isOpen()&&!osu.popupShowing()&&null!=(t=e.originalEvent))return 27===t.keyCode||0===t.button&&!this.isMenuInPath(t.composedPath())?this.setState({active:!1}):void 0},s.prototype.isMenuInPath=function(e){var t,s;return t=this.menu.current,u.call(e,t)>=0||(s=this.portal,u.call(e,s)>=0)},s.prototype.toggle=function(){return this.setState({active:!this.state.active})},s.prototype.tooltipElement=function(){return e(this.context).closest(".qtip")},s.prototype.addPortal=function(){if(null==this.portal.parentElement)return document.body.appendChild(this.portal)},s.prototype.removePortal=function(){if(null!=this.portal.parentElement)return document.body.removeChild(this.portal)},s.prototype.render=function(){return null==this.portal&&(this.portal=document.createElement("div")),this.props.customRender?this.props.customRender(Object(i.createPortal)(this.props.children(this.dismiss),this.portal),this.menu,this.toggle):Object(n.div)({className:"popup-menu",ref:this.menu},Object(n.button)({className:"popup-menu__button",type:"button",onClick:this.toggle},Object(n.i)({className:"fas fa-ellipsis-v"})),Object(i.createPortal)(this.renderMenu(),this.portal))},s.prototype.renderMenu=function(){return this.state.active?Object(n.div)({className:"popup-menu__menu"},Object(n.div)({className:"simple-menu simple-menu--popup-menu"},this.props.children(this.dismiss))):null},s}(o.PureComponent)}).call(this,s("5wds"))},C92G:function(e,t,s){"use strict";s.d(t,"a",(function(){return r}));var o=s("BvKu"),i=s("/G9H"),n=s("ZG74");function r(e){const t=i.useContext(n.a),s=i.useContext(n.b);return i.createElement(o.a,Object.assign({onHide:()=>t.activeKeyDidChange(null),onShow:()=>t.activeKeyDidChange(s)},e))}},CSpP:function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return o}));class o{constructor(){this.switchEdit=t=>{const s=e(t.target).parents(".js-forum-poll--container");if("1"===s.attr("data-edit")){s.attr("data-edit","0");const o=e(t.target).closest("form")[0];null!=o&&o.reset()}else s.attr("data-edit","1")},this.switchPage=t=>{const s=t.currentTarget;if(!(s instanceof HTMLElement))return;const o=s.dataset.targetPage;"string"==typeof o&&e(t.target).parents(".js-forum-poll--container").attr("data-page",o)},e(document).on("click",".js-forum-poll--switch-page",this.switchPage).on("click",".js-forum-poll--switch-edit",this.switchEdit)}}}).call(this,s("5wds"))},Cfan:function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return a}));var o=s("0h6b"),i=s("EaLk"),n=function(e,t,s,o){var i,n=arguments.length,r=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,s):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,s,o);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(r=(n<3?i(r):n>3?i(t,s,r):i(t,s))||r);return n>3&&r&&Object.defineProperty(t,s,r),r},r=function(e,t,s,o){return new(s||(s=Promise))((function(i,n){function r(e){try{l(o.next(e))}catch(t){n(t)}}function a(e){try{l(o.throw(e))}catch(t){n(t)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(r,a)}l((o=o.apply(e,t||[])).next())}))};class a{constructor(e){this.isRevoking=!1,this.revoked=!1,this.id=e.id,this.name=e.name,this.scopes=new Set(e.scopes),this.userId=e.user_id,this.user=e.user}revoke(){return r(this,void 0,void 0,(function*(){return this.isRevoking=!0,e.ajax({method:"DELETE",url:Object(o.route)("oauth.authorized-clients.destroy",{authorized_client:this.id})}).then(()=>{this.revoked=!0}).always(()=>{this.isRevoking=!1})}))}}n([i.m],a.prototype,"isRevoking",void 0),n([i.m],a.prototype,"revoked",void 0),n([i.m],a.prototype,"scopes",void 0),n([i.d],a.prototype,"revoke",null)}).call(this,s("5wds"))},CnOT:function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return u}));var o,i,n=s("TY2o"),r=s("4cxI"),a=s("I8Ok"),l=function(e,t){return function(){return e.apply(t,arguments)}},c={}.hasOwnProperty;i=e.createElement,o="beatmap-discussion-user-card";var u=function(e){function t(){return this.render=l(this.render,this),t.__super__.constructor.apply(this,arguments)}return function(e,t){for(var s in t)c.call(t,s)&&(e[s]=t[s]);function o(){this.constructor=e}o.prototype=t.prototype,e.prototype=new o,e.__super__=t.prototype}(t,e),t.prototype.render=function(){var e,t,s,l,c;return e=null!=(l=this.props.additionalClasses)?l:[],t=null!=(c=this.props.hideStripe)&&c,s=this.props.user.is_deleted?a.span:a.a,Object(a.div)({className:osu.classWithModifiers(o,e),style:osu.groupColour(this.props.group)},Object(a.div)({className:o+"__avatar"},s({className:o+"__user-link",href:laroute.route("users.show",{user:this.props.user.id})},i(n.a,{user:this.props.user,modifiers:["full-rounded"]}))),Object(a.div)({className:o+"__user"},Object(a.div)({className:o+"__user-row"},s({className:o+"__user-link",href:laroute.route("users.show",{user:this.props.user.id})},Object(a.span)({className:o+"__user-text u-ellipsis-overflow"},this.props.user.username)),this.props.user.is_bot||this.props.user.is_deleted?void 0:Object(a.a)({className:o+"__user-modding-history-link",href:laroute.route("users.modding.index",{user:this.props.user.id}),title:osu.trans("beatmap_discussion_posts.item.modding_history_link")},Object(a.i)({className:"fas fa-align-left"}))),Object(a.div)({className:o+"__user-badge"},i(r.a,{group:this.props.group}))),t?void 0:Object(a.div)({className:o+"__user-stripe"}))},t}(e.PureComponent)}).call(this,s("/G9H"))},Cy5r:function(e,t,s){"use strict";function o({allowedBlocks:e=[],allowedInlines:t=[]}={}){e.push("root","newline"),t.push("text"),this.Parser.prototype.blockMethods.filter(t=>!e.includes(t)).forEach(e=>{this.Parser.prototype.blockTokenizers[e]=()=>!0}),this.Parser.prototype.inlineMethods.filter(e=>!t.includes(e)).forEach(e=>{this.Parser.prototype.inlineTokenizers[e]=()=>!0,this.Parser.prototype.inlineTokenizers[e].locator=()=>-1})}s.d(t,"a",(function(){return o}))},"D6/9":function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return a}));var o=s("dUQf"),i=s("0h6b"),n=s("phBA");const r=e=>{var t;return 401===e.status&&"verify"===(null===(t=e.responseJSON)||void 0===t?void 0:t.authentication)};class a{constructor(){this.delayShow=!1,this.showOnError=(e,t)=>!!r(e)&&(this.show(e.responseJSON.box,t),!0),this.autoSubmit=()=>{var t;const s=this.inputBox;if(null==s)return;const o=s.value.replace(/\s/g,""),n=s.dataset.lastKey,r=parseInt(null!==(t=s.dataset.verificationKeyLength)&&void 0!==t?t:"",10);0===o.length&&this.setMessage(),r===o.length&&o!==n&&(s.dataset.lastKey=o,this.prepareForRequest("verifying"),this.request=e.post(Object(i.route)("account.verify"),{verification_key:o}).done(this.success).fail(this.error))},this.error=e=>{this.setMessage(osu.xhrErrorMessage(e))},this.float=(e,t,s)=>{e?(t.classList.add("js-user-verification--center"),t.style.paddingTop=""):(t.classList.remove("js-user-verification--center"),t.style.paddingTop=`${null!=s?s:0}px`)},this.isActive=()=>{var e;return null===(e=this.modal)||void 0===e?void 0:e.classList.contains("js-user-verification--active")},this.onError=(e,t)=>this.showOnError(t,Object(n.a)(e.target)),this.prepareForRequest=e=>{var t;null===(t=this.request)||void 0===t||t.abort(),this.setMessage(osu.trans(`user_verification.box.${e}`),!0)},this.reissue=t=>{t.preventDefault(),this.prepareForRequest("issuing"),this.request=e.post(Object(i.route)("account.reissue-code")).done(e=>{this.setMessage(e.message)}).fail(this.error)},this.reposition=()=>{var e,t;if(this.isActive()&&null!=this.modal)if(osu.isMobile())this.float(!0,this.modal);else{const s=null!==(t=null===(e=this.reference)||void 0===e?void 0:e.getBoundingClientRect().bottom)&&void 0!==t?t:0;this.float(s<0,this.modal,s)}},this.setDelayShow=()=>{this.delayShow=!0},this.setMessage=(e,t=!1)=>{const s=this.message;if(null==s)return;if(null==e||0===e.length)return void o.a.out(s);const i=this.messageText,n=this.messageSpinner;null!=i&&null!=n&&(i.textContent=e,o.a.toggle(n,t),o.a.in(s))},this.setModal=()=>{const e=document.querySelector(".js-user-verification");this.modal=e instanceof HTMLElement?e:void 0},this.show=(t,s)=>{this.delayShow?this.delayShowCallback=()=>this.show(t,s):(this.callback=s,null!=t&&e(".js-user-verification--box").html(t),this.$modal().modal({backdrop:"static",keyboard:!1,show:!0}).addClass("js-user-verification--active"),this.reposition())},this.showOnLoad=()=>{this.delayShow=!1,null!=this.delayShowCallback?(this.delayShowCallback(),this.delayShowCallback=void 0):this.isVerificationPage()&&this.show()},this.success=()=>{if(!this.isActive()||null==this.modal)return;const e=this.inputBox;if(null==e)return;this.$modal().modal("hide"),this.modal.classList.remove("js-user-verification--active");const t=this.callback;if(this.callback=void 0,this.setMessage(),e.value="",e.dataset.lastKey="",this.isVerificationPage())return osu.reloadPage();null==t||t()},e(document).on("ajax:error",this.onError).on("turbolinks:load",this.setModal).on("turbolinks:load",this.showOnLoad).on("turbolinks:visit",this.setDelayShow).on("input",".js-user-verification--input",this.autoSubmit).on("click",".js-user-verification--reissue",this.reissue),e.subscribe("user-verification:success",this.success),e(window).on("resize scroll",this.reposition)}get inputBox(){return document.querySelector(".js-user-verification--input")}get message(){return document.querySelector(".js-user-verification--message")}get messageSpinner(){return document.querySelector(".js-user-verification--message-spinner")}get messageText(){return document.querySelector(".js-user-verification--message-text")}get reference(){return document.querySelector(".js-user-verification--reference")}$modal(){return e(".js-user-verification")}isVerificationPage(){return null!=document.querySelector(".js-user-verification--on-load")}}}).call(this,s("5wds"))},DHbW:function(e,t,s){"use strict";s.d(t,"a",(function(){return i}));var o=s("/G9H");const i=o.createContext([])},EADP:function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return i}));var o=s("7EfK");class i{constructor(){this.formatElem=e=>{"1"!==e.dataset.localtime&&(e.dataset.localtime="1",e.classList.add("js-tooltip-time"),e.title=e.dateTime,e.innerText=o(e.dateTime).format("LLL"))},this.formatElems=e=>(null==e&&(e=this.getElems(document.body)),e.map(this.formatElem)),this.getElems=e=>e instanceof HTMLElement?e instanceof HTMLTimeElement&&e.classList.contains("js-localtime")?[e]:[...e.querySelectorAll("time.js-localtime")]:[],this.mutationHandler=e=>{const t=[];e.forEach(e=>{e.addedNodes.forEach(e=>{t.push(...this.getElems(e))})}),this.formatElems(t)},this.observer=new MutationObserver(this.mutationHandler),e(document).on("turbolinks:load",()=>{this.formatElems(),this.observer.observe(document.body,{childList:!0,subtree:!0})})}}}).call(this,s("5wds"))},EQj2:function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return o}));class o{constructor(){this.sitekey="",this.triggered=!1,this.container=()=>document.querySelector(".js-captcha--container"),this.disableSubmit=()=>{const e=this.submitButton();e&&(e.disabled=!0)},this.enableSubmit=()=>{const e=this.submitButton();e&&(e.disabled=!1)},this.init=(e,t)=>{this.sitekey=e,this.triggered=t,this.render()},this.isEnabled=()=>this.container()&&"object"==typeof grecaptcha&&"function"==typeof grecaptcha.render&&""!==this.sitekey&&this.triggered,this.isLoaded=()=>{var e;return""!==(null===(e=this.container())||void 0===e?void 0:e.innerHTML)},this.render=()=>{this.isEnabled()&&!this.isLoaded()&&(grecaptcha.render(this.container(),{callback:this.enableSubmit,"error-callback":this.disableSubmit,"expired-callback":this.disableSubmit,sitekey:this.sitekey,theme:"dark"}),this.disableSubmit())},this.reset=()=>{this.isEnabled()&&(grecaptcha.reset(),this.disableSubmit())},this.submitButton=()=>document.querySelector(".js-captcha--submit-button"),this.trigger=()=>{this.triggered||(this.triggered=!0,this.render())},this.untrigger=()=>{this.isEnabled()&&(this.triggered=!1,this.container().innerHTML="",this.enableSubmit())},e(document).on("turbolinks:load",this.render)}}}).call(this,s("5wds"))},EaeJ:function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return a}));var o=s("/G9H"),i=s("I8Ok"),n=function(e,t){return function(){return e.apply(t,arguments)}},r={}.hasOwnProperty;o.createElement;var a=function(t){function s(){return this.renderHeaderStream=n(this.renderHeaderStream,this),this.render=n(this.render,this),s.__super__.constructor.apply(this,arguments)}return function(e,t){for(var s in t)r.call(t,s)&&(e[s]=t[s]);function o(){this.constructor=e}o.prototype=t.prototype,e.prototype=new o,e.__super__=t.prototype}(s,t),s.prototype.render=function(){var e;return Object(i.div)({className:osu.classWithModifiers("update-streams-v2",[null!=this.props.currentStreamId?"with-active":void 0])},Object(i.div)({className:"update-streams-v2__container"},function(){var t,s,o,i;for(i=[],t=0,s=(o=this.props.updateStreams).length;t<s;t++)e=o[t],i.push(this.renderHeaderStream({stream:e}));return i}.call(this)))},s.prototype.renderHeaderStream=function(t){var s,o,n;return o=t.stream,n=e.kebabCase(o.display_name),s=osu.classWithModifiers("update-streams-v2__item",[n,o.is_featured?"featured":void 0,this.props.currentStreamId===o.id?"active":void 0]),s+=" t-changelog-stream--"+n,Object(i.a)({href:_exported.OsuUrlHelper.changelogBuild(o.latest_build),key:o.id,className:s},Object(i.div)({className:"update-streams-v2__bar u-changelog-stream--bg"}),Object(i.p)({className:"update-streams-v2__row update-streams-v2__row--name"},o.display_name),Object(i.p)({className:"update-streams-v2__row update-streams-v2__row--version"},o.latest_build.display_version),o.user_count>0?Object(i.p)({className:"update-streams-v2__row update-streams-v2__row--users"},osu.transChoice("changelog.builds.users_online",o.user_count)):void 0)},s}(o.PureComponent)}).call(this,s("Hs9Z"))},Ev30:function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return d}));var o,i=s("jEEn"),n=s("/G9H"),r=s("I8Ok"),a=s("TY2o"),l=s("AJEZ"),c=function(e,t){return function(){return e.apply(t,arguments)}},u={}.hasOwnProperty;o=n.createElement;var d=function(t){var s;function n(){return this.previousUsernames=c(this.previousUsernames,this),this.render=c(this.render,this),n.__super__.constructor.apply(this,arguments)}return function(e,t){for(var s in t)u.call(t,s)&&(e[s]=t[s]);function o(){this.constructor=e}o.prototype=t.prototype,e.prototype=new o,e.__super__=t.prototype}(n,t),s="profile-info",n.prototype.render=function(){var t,n;return t=o(a.a,{user:this.props.user,modifiers:["full"]}),Object(r.div)({className:s},Object(r.div)({className:s+"__bg",style:{backgroundImage:osu.urlPresence(this.props.coverUrl)}}),this.props.user.id===currentUser.id?Object(r.a)({className:s+"__avatar",href:laroute.route("account.edit")+"#avatar",title:osu.trans("users.show.change_avatar")},t):Object(r.div)({className:s+"__avatar"},t),Object(r.div)({className:s+"__details"},Object(r.h1)({className:s+"__name"},Object(r.span)({className:"u-ellipsis-pre-overflow"},this.props.user.username),Object(r.div)({className:s+"__previous-usernames"},this.previousUsernames())),null!=this.props.user.title?this.renderTitle():void 0,Object(r.div)({className:s+"__icon-group"},Object(r.div)({className:s+"__icons"},this.props.user.is_supporter?Object(r.span)({className:s+"__icon "+s+"__icon--supporter",title:osu.trans("users.show.is_supporter")},e(this.props.user.support_level).times((function(e){return Object(r.span)({key:e,className:"fas fa-heart"})}))):void 0,o(l.a,{groups:this.props.user.groups,modifiers:["profile-page"],wrapper:s+"__icon"})),Object(r.div)({className:s+"__icons "+s+"__icons--flag"},null!=(null!=(n=this.props.user.country)?n.code:void 0)?Object(r.a)({className:s+"__flag "+s+"__flag--country",href:laroute.route("rankings",{mode:this.props.currentMode,country:this.props.user.country.code,type:"performance"})},Object(r.span)({className:s+"__flag-flag"},o(i.a,{country:this.props.user.country})),Object(r.span)({className:s+"__flag-text"},this.props.user.country.name)):void 0))),Object(r.div)({className:"profile-info__bar hidden-xs",style:{backgroundColor:this.props.user.profile_colour}}))},n.prototype.renderTitle=function(){return(null!=this.props.user.title_url?r.a:r.span)({className:s+"__title",href:this.props.user.title_url,style:{color:this.props.user.profile_colour}},this.props.user.title)},n.prototype.previousUsernames=function(){var e;if(0!==this.props.user.previous_usernames.length)return e=this.props.user.previous_usernames.join(", "),Object(r.div)({className:"profile-previous-usernames"},Object(r.a)({className:"profile-previous-usernames__icon profile-previous-usernames__icon--with-title",title:osu.trans("users.show.previous_usernames")+": "+e,onClick:this.doNothing},Object(r.span)({className:"fas fa-address-card"})),Object(r.div)({className:"profile-previous-usernames__icon profile-previous-usernames__icon--plain"},Object(r.span)({className:"fas fa-address-card"})),Object(r.div)({className:"profile-previous-usernames__content"},Object(r.div)({className:"profile-previous-usernames__title"},osu.trans("users.show.previous_usernames")),Object(r.div)({className:"profile-previous-usernames__names"},e)))},n.prototype.doNothing=function(e){},n}(n.PureComponent)}).call(this,s("Hs9Z"))},FAY1:function(e,t,s){"use strict";s.d(t,"a",(function(){return l}));var o=s("0h6b"),i=s("C92G"),n=s("/G9H"),r=s("hc33"),a=s("SA7k");class l extends n.PureComponent{render(){const{score:e}=this.props;return n.createElement(i.a,null,t=>{var s,i;return n.createElement(n.Fragment,null,Object(a.d)(e)&&n.createElement("a",{className:"simple-menu__item",href:Object(o.route)("scores.show",{mode:e.mode,score:e.best_id})},osu.trans("users.show.extra.top_ranks.view_details")),Object(a.c)(e)&&n.createElement("a",{className:"simple-menu__item js-login-required--click","data-turbolinks":!1,href:Object(o.route)("scores.download",{mode:e.mode,score:e.best_id}),onClick:t},osu.trans("users.show.extra.top_ranks.download_replay")),Object(a.a)(e)&&n.createElement(r.a,{baseKey:"scores",className:"simple-menu__item",reportableId:null!==(i=null===(s=e.best_id)||void 0===s?void 0:s.toString())&&void 0!==i?i:"",reportableType:`score_best_${e.mode}`,user:e.user}))})}}},FIbR:function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return c}));var o=s("0h6b"),i=s("Hs9Z"),n=s("EaLk"),r=s("fxEp"),a=function(e,t,s,o){var i,n=arguments.length,r=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,s):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,s,o);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(r=(n<3?i(r):n>3?i(t,s,r):i(t,s))||r);return n>3&&r&&Object.defineProperty(t,s,r),r};const l={currentSort:"new",hasMoreComments:{},isShowDeleted:!1,loadingFollow:null,loadingSort:null,pinnedCommentIds:[],topLevelCommentIds:[],topLevelCount:0,total:0,userFollow:!1};class c{constructor(e){this.commentStore=e,this.account={client:null,isCreatingNewClient:!1,newClientVisible:!1},this.comments=Object.assign({},l),this.orderedCommentsByParentId={}}exportCommentsUIState(){return{comments:this.comments,orderedCommentsByParentId:this.orderedCommentsByParentId}}getOrderedCommentsByParentId(e){return this.populateOrderedCommentsForParentId(e),this.orderedCommentsByParentId[e]}importCommentsUIState(e){this.comments=Object.assign({},l,e.comments),this.orderedCommentsByParentId=e.orderedCommentsByParentId}initializeWithCommentBundleJson(e){var t,s;this.comments.hasMoreComments={},this.comments.hasMoreComments[e.has_more_id]=e.has_more,this.comments.currentSort=e.sort,this.comments.userFollow=e.user_follow,this.comments.topLevelCount=e.top_level_count?e.top_level_count:0,this.comments.total=e.total?e.total:0,null!=e.comments&&(this.comments.topLevelCommentIds=e.comments.map(e=>e.id)),this.updatePinnedCommentIds(e),this.orderedCommentsByParentId={},this.comments.isShowDeleted=null!==(s=null===(t=null===currentUser||void 0===currentUser?void 0:currentUser.user_preferences)||void 0===t?void 0:t.comments_show_deleted)&&void 0!==s&&s}toggleShowDeletedComments(){this.comments.isShowDeleted=!this.comments.isShowDeleted,null!=currentUser.id&&e.ajax(Object(o.route)("account.options"),{data:{user_profile_customization:{comments_show_deleted:this.comments.isShowDeleted}},method:"PUT"})}updateFromCommentsAdded(e){this.comments.hasMoreComments[e.has_more_id]=e.has_more,e.top_level_count&&e.total&&(this.comments.topLevelCount=e.top_level_count,this.comments.total=e.total);for(const t of e.comments){const e=new r.a(t),s=e.parentId;null==s?this.comments.topLevelCommentIds.push(e.id):(this.populateOrderedCommentsForParentId(s),this.orderedCommentsByParentId[s].push(e))}}updateFromCommentsNew(e){e.top_level_count&&e.total&&(this.comments.topLevelCount=e.top_level_count,this.comments.total=e.total);const t=new r.a(e.comments[0]),s=t.parentId;null==s?this.comments.topLevelCommentIds.unshift(t.id):(this.populateOrderedCommentsForParentId(s),this.orderedCommentsByParentId[s].unshift(t))}updateFromCommentUpdated(e){this.updatePinnedCommentIds(e)}orderComments(e){switch(this.comments.currentSort){case"old":return Object(i.orderBy)(e,"createdAt","asc");case"top":return Object(i.orderBy)(e,"votesCount","desc");default:return Object(i.orderBy)(e,"createdAt","desc")}}populateOrderedCommentsForParentId(e){if(null==this.orderedCommentsByParentId[e]){const t=this.commentStore.getRepliesByParentId(e);this.orderedCommentsByParentId[e]=this.orderComments(t)}}updatePinnedCommentIds(e){null!=e.pinned_comments&&(this.comments.pinnedCommentIds=e.pinned_comments.map(e=>e.id))}}a([n.m],c.prototype,"account",void 0),a([n.m],c.prototype,"comments",void 0),a([n.d],c.prototype,"importCommentsUIState",null),a([n.d],c.prototype,"initializeWithCommentBundleJson",null),a([n.d],c.prototype,"toggleShowDeletedComments",null),a([n.d],c.prototype,"updateFromCommentsAdded",null),a([n.d],c.prototype,"updateFromCommentsNew",null),a([n.d],c.prototype,"updateFromCommentUpdated",null)}).call(this,s("5wds"))},FVE9:function(e,t,s){"use strict";(function(e,o){s.d(t,"a",(function(){return d}));var i,n,r=s("/G9H"),a=s("I8Ok"),l=s("PPOh"),c=function(e,t){return function(){return e.apply(t,arguments)}},u={}.hasOwnProperty;n=r.createElement,i="user-action-button";var d=function(t){function s(t){var o,i,n;this.isVisible=c(this.isVisible,this),this.followers=c(this.followers,this),this.renderIcon=c(this.renderIcon,this),this.renderCounter=c(this.renderCounter,this),this.render=c(this.render,this),this.componentWillUnmount=c(this.componentWillUnmount,this),this.componentDidMount=c(this.componentDidMount,this),this.refresh=c(this.refresh,this),this.clicked=c(this.clicked,this),this.updateFriends=c(this.updateFriends,this),this.requestDone=c(this.requestDone,this),s.__super__.constructor.call(this,t),this.button=r.createRef(),this.eventId="friendButton-"+this.props.userId+"-"+osu.uuid(),i=e.find(currentUser.friends,{target_id:t.userId}),o=null!=(n=this.props.followers)?n:0,null!=i&&(o-=1),this.state={friend:i,followersWithoutSelf:o}}return function(e,t){for(var s in t)u.call(t,s)&&(e[s]=t[s]);function o(){this.constructor=e}o.prototype=t.prototype,e.prototype=new o,e.__super__=t.prototype}(s,t),s.defaultProps={showFollowerCounter:!1,alwaysVisible:!1},s.prototype.requestDone=function(){return this.setState({loading:!1})},s.prototype.updateFriends=function(t){return this.setState({friend:e.find(t,{target_id:this.props.userId})},(function(){return currentUser.friends=t,o.publish("user:update",currentUser),o.publish("friendButton:refresh")}))},s.prototype.clicked=function(e){return this.setState({loading:!0}),null!=this.state.friend?this.xhr=o.ajax({type:"DELETE",url:laroute.route("friends.destroy",{friend:this.props.userId})}):this.xhr=o.ajax({type:"POST",url:laroute.route("friends.store",{target:this.props.userId})}),this.xhr.done(this.updateFriends).fail(osu.emitAjaxError(this.button.current)).always(this.requestDone)},s.prototype.refresh=function(t){return this.setState({friend:e.find(currentUser.friends,{target_id:this.props.userId})},(function(){}),this.forceUpdate())},s.prototype.componentDidMount=function(){return o.subscribe("friendButton:refresh."+this.eventId,this.refresh)},s.prototype.componentWillUnmount=function(){var e;return o.unsubscribe("."+this.eventId),null!=(e=this.xhr)?e.abort():void 0},s.prototype.render=function(){var e,t,s,o,n,r,l,c,u,d;if("friend"===this.props.showIf&&null==this.state.friend)return null;if("mutual"===this.props.showIf&&!(null!=(n=this.state.friend)?n.mutual:void 0))return null;if(o=this.isVisible(),!this.props.alwaysVisible){if(!o)return null!=(l=this.props.container)&&l.classList.add("hidden"),null;null!=(r=this.props.container)&&r.classList.remove("hidden")}return e=osu.classWithModifiers(i,this.props.modifiers),s=(null!=(c=null!=(u=currentUser.friends)?u.length:void 0)?c:0)>=currentUser.max_friends,d=function(){switch(!1){case!!o:return osu.trans("friends.buttons.disabled");case null==this.state.friend:return osu.trans("friends.buttons.remove");case!s:return osu.trans("friends.too_many");default:return osu.trans("friends.buttons.add")}}.call(this),t=!o||this.state.loading||s&&null==this.state.friend,null==this.state.friend||this.state.loading||(this.state.friend.mutual?e+=" "+i+"--mutual":e+=" "+i+"--friend"),Object(a.div)({title:d},Object(a.button)({type:"button",className:e,onClick:this.clicked,ref:this.button,disabled:t},this.renderIcon({isFriendLimit:s,isVisible:o}),this.renderCounter()))},s.prototype.renderCounter=function(){if(this.props.showFollowerCounter&&null!=this.props.followers)return Object(a.span)({className:i+"__counter"},osu.formatNumber(this.followers()))},s.prototype.renderIcon=function(e){var t,s;return t=e.isFriendLimit,s=e.isVisible,Object(a.span)({className:i+"__icon-container"},function(){switch(!1){case!this.state.loading:return n(l.a);case!!s:return Object(a.i)({className:"fas fa-user"});case null==this.state.friend:return[Object(a.span)({key:"hover",className:i+"__icon "+i+"__icon--hover-visible"},Object(a.i)({className:"fas fa-user-times"})),this.state.friend.mutual?Object(a.span)({key:"normal-mutual",className:i+"__icon "+i+"__icon--hover-hidden"},Object(a.i)({className:"fas fa-user-friends"})):Object(a.span)({key:"normal",className:i+"__icon "+i+"__icon--hover-hidden"},Object(a.i)({className:"fas fa-user"}))];default:return Object(a.i)({className:t?"fas fa-user":"fas fa-user-plus"})}}.call(this))},s.prototype.followers=function(){return this.state.followersWithoutSelf+(null!=this.state.friend?1:0)},s.prototype.isVisible=function(){return null!=currentUser.id&&e.isFinite(this.props.userId)&&this.props.userId!==currentUser.id&&!e.find(currentUser.blocks,{target_id:this.props.userId})},s}(r.PureComponent)}).call(this,s("Hs9Z"),s("5wds"))},FiYg:function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return r}));var o=s("EaLk"),i=s("JlDh"),n=function(e,t,s,o){var i,n=arguments.length,r=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,s):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,s,o);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(r=(n<3?i(r):n>3?i(t,s,r):i(t,s))||r);return n>3&&r&&Object.defineProperty(t,s,r),r};class r{constructor(e,t,s){this.notificationStore=e,this.contextType=t,this.typeNamesWithoutNull=i.c.filter(e=>!(null==e||this.isExcluded(e))),this.currentFilter=void 0!==s?s:this.typeNameFromUrl,this.store=t.isWidget?e.unreadStacks:e.stacks}get stacks(){return this.store.orderedStacksOfType(this.currentFilter).filter(e=>e.hasVisibleNotifications&&!this.isExcluded(e.objectType))}get type(){return this.store.getOrCreateType({objectType:this.currentFilter})}get typeNameFromUrl(){const e=new URL(location.href);return Object(i.b)(e.searchParams.get("type"))}getTotal(e){return null==e.name?this.typeNamesWithoutNull.reduce((e,t)=>e+this.store.getOrCreateType({objectType:t}).total,0):e.total}getType(e){return this.store.getOrCreateType({objectType:e})}loadMore(){var e;null===(e=this.type)||void 0===e||e.loadMore(this.contextType)}markCurrentTypeAsRead(){if(null==this.type.name)for(const e of this.typeNamesWithoutNull)this.store.getOrCreateType({objectType:e}).markTypeAsRead();else this.type.markTypeAsRead()}navigateTo(t){if(this.currentFilter=t,0===[...this.stacks].length&&this.loadMore(),!this.contextType.isWidget){let s;if(null==t){const e=new URL(window.location.href);e.searchParams.delete("type"),s=e.href}else s=osu.updateQueryString(null,{type:t});e.controller.advanceHistory(s)}}isExcluded(e){return this.contextType.excludes.includes(e)}}n([o.m],r.prototype,"currentFilter",void 0),n([o.e],r.prototype,"stacks",null),n([o.e],r.prototype,"type",null),n([o.d],r.prototype,"loadMore",null),n([o.d],r.prototype,"markCurrentTypeAsRead",null),n([o.d],r.prototype,"navigateTo",null)}).call(this,s("dMdw"))},GLyB:function(e,t,s){"use strict";s.d(t,"a",(function(){return r}));var o=s("/G9H"),i=s("I8Ok"),n={}.hasOwnProperty;o.createElement;var r=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return function(e,t){for(var s in t)n.call(t,s)&&(e[s]=t[s]);function o(){this.constructor=e}o.prototype=t.prototype,e.prototype=new o,e.__super__=t.prototype}(t,e),t.prototype.render=function(){return Object(i.div)({className:"tracklist__cover",style:{backgroundImage:osu.urlPresence(this.props.track.cover_url)}},Object(i.a)({className:"tracklist__preview js-audio--play js-audio--player",href:"#","data-audio-url":this.props.track.preview},Object(i.span)({className:"tracklist__preview-icon"})))},t}(o.Component)},"HPV+":function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return l}));var o=s("KExx"),i=s("IlO5"),n=s("69Vu");const r=()=>{const e=document.createElement("div");return e.className="audio-player audio-player--main",e.innerHTML=`\n    <button\n      type="button"\n      class="audio-player__button audio-player__button--prev js-audio--nav"\n      data-audio-nav="prev"\n    ></button>\n\n    <button\n      type="button"\n      class="audio-player__button audio-player__button--play js-audio--main-play"\n    ></button>\n\n    <button\n      type="button"\n      class="audio-player__button audio-player__button--next js-audio--nav"\n      data-audio-nav="next"\n    ></button>\n\n    <div class="audio-player__bar audio-player__bar--progress js-audio--seek">\n      <div class="audio-player__bar-current"></div>\n    </div>\n\n    <div class="audio-player__timestamps">\n      <div class="audio-player__timestamp audio-player__timestamp--current"></div>\n      <div class="audio-player__timestamp-separator">/</div>\n      <div class="audio-player__timestamp audio-player__timestamp--total"></div>\n    </div>\n\n    <div class="audio-player__volume-control">\n      <button type="button" class="audio-player__volume-button js-audio--toggle-mute"></button>\n      <div class="audio-player__bar audio-player__bar--volume js-audio--volume">\n        <div class="audio-player__bar-current"></div>\n      </div>\n    </div>\n\n    <div class="audio-player__autoplay-control">\n      <button type="button" class="audio-player__autoplay-button js-audio--toggle-autoplay" title="${osu.trans("layout.audio.autoplay")}"></button>\n    </div>\n  `,e},a=()=>{const e=document.createElement("div");return e.className="audio-player js-audio--player",e.innerHTML='\n    <button\n    type="button"\n    class="audio-player__button audio-player__button--play js-audio--play"\n    ></button>\n\n    <div class="audio-player__bar audio-player__bar--progress js-audio--seek">\n      <div class="audio-player__bar-current"></div>\n    </div>\n\n    <div class="audio-player__timestamps">\n      <div class="audio-player__timestamp audio-player__timestamp--current"></div>\n      <div class="audio-player__timestamp-separator">/</div>\n      <div class="audio-player__timestamp audio-player__timestamp--total"></div>\n    </div>\n  ',e};class l{constructor(){this.audio=new Audio,this.durationFormatted="'0:00'",this.hasWorkingVolumeControl=!0,this.hideMainPlayerTimeout=-1,this.settingNavigation=!1,this.settings=new o.a(this),this.state="paused",this.timeFormat="minute_minimal",this.checkVolumeSettings=()=>{const e=this.settings.volume,t=.1===e?.2:.1;this.settings.volume=t,setTimeout(()=>{this.hasWorkingVolumeControl=this.settings.volume===t,this.settings.volume=e,this.syncVolumeDisplay()},0)},this.ensurePagePlayerIsAttached=()=>{null==this.pagePlayer||document.body.contains(this.pagePlayer)||(this.pagePlayer=void 0)},this.load=e=>{const t=e.dataset.audioUrl;if(null==t)throw new Error("Player is missing url");this.audio.paused||this.stop(),this.setTime(0),this.pagePlayer=e,this.url=t,this.audio.setAttribute("src",t),this.audio.currentTime=0,this.setState("loading");const s=this.audio.play();null==s||s.catch(e=>{if(l.ignoredErrors.includes(e.name))return console.debug("playback failed:",e.name),void this.stop();throw e}),this.setNavigation()},this.nav=e=>{const t=e.currentTarget;t instanceof HTMLElement&&("prev"===t.dataset.audioNav&&null!=this.playerPrev?this.load(this.playerPrev):"next"===t.dataset.audioNav&&null!=this.playerNext&&this.load(this.playerNext))},this.observePage=e=>{this.ensurePagePlayerIsAttached();const t=[],s=[],o=null==this.pagePlayer;e.forEach(e=>{e.addedNodes.forEach(e=>{if(e instanceof HTMLElement&&(e instanceof HTMLAudioElement?t.push(e):t.push(...e.querySelectorAll("audio")),o))if(e.classList.contains("js-audio--player"))s.push(e);else for(const t of[...e.querySelectorAll(".js-audio--player")])t instanceof HTMLElement&&s.push(t)})}),s.push(...this.replaceAudioElems(t)),this.reattachPagePlayer(s)},this.onClickPlay=e=>{e.preventDefault();const t=this.findPlayer(e.currentTarget);if(null==t)throw new Error("couldn't find pagePlayer of the play button");t===this.pagePlayer?this.togglePlay():this.load(t)},this.onDocumentReady=()=>{if(null==this.mainPlayer){const e=document.querySelector(".js-audio--main");if(null==e)return void console.debug("page is missing main player placeholder");this.mainPlayer=r(),e.replaceWith(this.mainPlayer),this.settings.apply(),this.checkVolumeSettings(),this.syncState()}null==this.observer&&(this.observer=new MutationObserver(this.observePage)),this.observer.observe(document.body,{childList:!0,subtree:!0}),this.replaceAudioElems(),this.reattachPagePlayer()},this.onEnded=()=>{this.stop(),null!=this.playerNext&&this.settings.autoplay&&this.load(this.playerNext)},this.onPlaying=()=>{this.setTimeFormat(),this.durationFormatted=Object(n.a)(this.audio.duration,this.timeFormat),this.setState("playing")},this.onSeekEnd=e=>{this.currentSlider=void 0;const t=1===e.getPercentage()?this.audio.duration-.01:this.audio.duration*e.getPercentage();this.setTime(t)},this.onSeekStart=e=>{const t=e.currentTarget;t instanceof HTMLElement&&(null!=this.pagePlayer&&this.pagePlayer.contains(t)||null!=this.mainPlayer&&this.mainPlayer.contains(t))&&Number.isFinite(this.audio.duration)&&0!==this.audio.duration&&(this.currentSlider=i.a.start({bar:t,endCallback:this.onSeekEnd,initialEvent:e}))},this.onTimeupdate=()=>{this.audio.paused&&this.syncProgress()},this.onVolumeChangeEnd=()=>{this.currentSlider=void 0,this.settings.save()},this.onVolumeChangeMove=e=>{this.settings.volume=e.getPercentage()},this.onVolumeChangeStart=e=>{const t=e.currentTarget;t instanceof HTMLElement&&(this.currentSlider=i.a.start({bar:t,endCallback:this.onVolumeChangeEnd,initialEvent:e,moveCallback:this.onVolumeChangeMove}))},this.pause=()=>{this.audio.pause(),this.setState("paused")},this.reattachPagePlayer=e=>{if(this.ensurePagePlayerIsAttached(),null!=this.url&&null==this.pagePlayer){null==e&&(e=[...document.querySelectorAll(".js-audio--player")]);for(const t of e)if(t instanceof HTMLElement&&t.dataset.audioUrl===this.url){this.pagePlayer=t,this.syncState();break}}this.setNavigation()},this.replaceAudioElem=e=>{var t,s;const o=null!==(t=osu.presence(e.src))&&void 0!==t?t:osu.presence(null===(s=e.querySelector("source"))||void 0===s?void 0:s.src);if(null==o)throw new Error("audio element is missing src");const i=a();return i.dataset.audioUrl=o,i.dataset.audioState="paused",e.replaceWith(i),i},this.replaceAudioElems=e=>(null==e&&(e=[...document.querySelectorAll("audio")]),e.map(this.replaceAudioElem)),this.setNavigation=()=>{this.settingNavigation||(this.settingNavigation=!0,window.setTimeout(()=>{var e;this.playerNext=void 0,this.playerPrev=void 0;const t=null===(e=this.pagePlayer)||void 0===e?void 0:e.closest(".js-audio--group");if(t instanceof HTMLElement){const e=t.querySelectorAll(".js-audio--player");for(let t=0;t<e.length;t++)if(e[t]===this.pagePlayer){if(t>0){const s=e[t-1];s instanceof HTMLElement&&(this.playerPrev=s)}const s=e[t+1];s instanceof HTMLElement&&(this.playerNext=s);break}}null!=this.mainPlayer&&(this.mainPlayer.dataset.audioHasPrev=null==this.playerPrev?"0":"1",this.mainPlayer.dataset.audioHasNext=null==this.playerNext?"0":"1"),this.settingNavigation=!1}))},this.setState=e=>{this.state=e,this.syncState(),"playing"===this.state||"loading"===this.state?(window.clearTimeout(this.hideMainPlayerTimeout),null!=this.mainPlayer&&(this.mainPlayer.dataset.audioVisible="1")):this.hideMainPlayerTimeout=window.setTimeout(()=>{null!=this.mainPlayer&&(this.mainPlayer.dataset.audioVisible="0")},4e3)},this.setTime=e=>{this.audio.currentTime=e,this.syncProgress()},this.setTimeFormat=()=>{this.audio.duration<600?this.timeFormat="minute_minimal":this.audio.duration<3600?this.timeFormat="minute":this.audio.duration<36e3?this.timeFormat="hour_minimal":this.timeFormat="hour"},this.stop=()=>{var e;this.audio.pause(),null===(e=this.currentSlider)||void 0===e||e.end(),this.audio.currentTime=0,this.pause()},this.syncProgress=()=>{if(this.audio.duration>0){const e=this.audio.currentTime/this.audio.duration,t=e>=.5?"1":"0",s=e.toString(),o=Object(n.a)(this.audio.currentTime,this.timeFormat);this.updatePlayers(e=>{e.style.setProperty("--current-time",o),e.style.setProperty("--progress",s),e.dataset.audioOver50=t})}this.audio.paused||requestAnimationFrame(this.syncProgress)},this.syncState=()=>{this.updatePlayers(e=>{e.dataset.audioAutoplay=this.settings.autoplay?"1":"0",e.dataset.audioHasDuration=Number.isFinite(this.audio.duration)?"1":"0",e.dataset.audioState=this.state,e.dataset.audioTimeFormat=this.timeFormat,e.style.setProperty("--duration",this.durationFormatted)}),this.syncProgress(),this.syncVolumeDisplay()},this.syncVolumeDisplay=()=>{null!=this.mainPlayer&&(this.mainPlayer.dataset.audioVolumeBarVisible=this.hasWorkingVolumeControl?"1":"0",this.mainPlayer.dataset.audioVolume=this.volumeIcon(),this.mainPlayer.style.setProperty("--volume",this.settings.volume.toString()))},this.toggleAutoplay=()=>{this.settings.toggleAutoplay(),this.settings.save(),this.syncState()},this.toggleMute=()=>{this.settings.toggleMuted(),this.settings.save()},this.togglePlay=()=>{null!=this.url&&(this.audio.paused?this.audio.play():this.pause())},this.updatePlayers=e=>{[this.mainPlayer,this.pagePlayer].forEach(t=>{null!=t&&e(t)})},this.volumeIcon=()=>this.settings.muted?"muted":0===this.settings.volume?"silent":this.settings.volume<.4?"quiet":"normal",this.settings.volume=0,this.audio.addEventListener("playing",this.onPlaying),this.audio.addEventListener("ended",this.onEnded),this.audio.addEventListener("timeupdate",this.onTimeupdate),this.audio.addEventListener("volumechange",this.syncVolumeDisplay),e(document).on("click",".js-audio--play",this.onClickPlay),e(document).on("click",".js-audio--main-play",this.togglePlay),e(document).on(i.a.startEvents,".js-audio--seek",this.onSeekStart),e(document).on(i.a.startEvents,".js-audio--volume",this.onVolumeChangeStart),e(document).on("click",".js-audio--toggle-mute",this.toggleMute),e(document).on("click",".js-audio--toggle-autoplay",this.toggleAutoplay),e(document).on("click",".js-audio--nav",this.nav),e(document).on("turbolinks:load",this.onDocumentReady)}findPlayer(e){var t,s;const o=null!==(s=null===(t=this.mainPlayer)||void 0===t?void 0:t.contains(e))&&void 0!==s&&s?this.pagePlayer:e.closest(".js-audio--player");if(o instanceof HTMLElement)return o}}l.ignoredErrors=["AbortError","NotAllowedError","NotSupportedError"]}).call(this,s("5wds"))},I7Md:function(e,t,s){"use strict";(function(e){var o=s("bpgk"),i=s("WLnA"),n=s("0h6b"),r=s("Hs9Z"),a=s("EaLk"),l=s("tz7b"),c=s("uW+8"),u=function(e,t,s,o){var i,n=arguments.length,r=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,s):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,s,o);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(r=(n<3?i(r):n>3?i(t,s,r):i(t,s))||r);return n>3&&r&&Object.defineProperty(t,s,r),r};let d=class{constructor(t){this.socketWorker=t,this.waitingVerification=!1,this.timeout={},this.xhr={},this.xhrLoadingState={},this.loadMore=()=>{this.xhrLoadingState.loadMore||(window.clearTimeout(this.timeout.loadMore),this.xhrLoadingState.loadMore=!0,this.xhr.loadMore=e.ajax({url:Object(n.route)("notifications.index",{unread:1}),dataType:"json"}).always(()=>{this.xhrLoadingState.loadMore=!1}).done(e=>{this.waitingVerification=!1,this.loadBundle(e)}).fail(e=>{null==e.responseJSON||"verification"!==e.responseJSON.error?this.delayedRetryInitialLoadMore():this.waitingVerification=!0}))},Object(a.n)(this.socketWorker,"connectionStatus",e=>{"connected"===e.newValue&&this.loadMore()},!0),e.subscribe("user-verification:success.notifications-worker",()=>{this.loadMore()})}get hasData(){return null!=this.firstLoadedAt}handleDispatchAction(e){if(e instanceof o.b&&this.destroy(),!(e instanceof l.a))return;const t=e.message;if((e=>"delete"===e.event)(t)){const e=new Date(t.data.timestamp);null!=this.firstLoadedAt&&e>this.firstLoadedAt&&Object(i.a)(c.a.fromJson(t))}else if((e=>"new"===e.event)(t))Object(i.a)(new c.c(t.data));else if((e=>"read"===e.event)(t)){const e=new Date(t.data.timestamp);null!=this.firstLoadedAt&&e>this.firstLoadedAt&&Object(i.a)(c.d.fromJson(t))}}delayedRetryInitialLoadMore(){this.timeout.loadMore=window.setTimeout(this.loadMore,1e4)}destroy(){Object(r.forEach)(this.xhr,e=>null==e?void 0:e.abort()),Object(r.forEach)(this.timeout,e=>window.clearTimeout(e))}loadBundle(e){Object(i.a)(new c.b(e,{isWidget:!0})),null==this.firstLoadedAt&&(this.firstLoadedAt=new Date(e.timestamp))}};u([a.m],d.prototype,"waitingVerification",void 0),u([a.m],d.prototype,"firstLoadedAt",void 0),u([a.e],d.prototype,"hasData",null),u([a.d],d.prototype,"loadBundle",null),d=u([i.b],d),t.a=d}).call(this,s("5wds"))},"I8/e":function(e,t,s){"use strict";function o(e){var t;return"nominate"===e.type&&Array.isArray(null===(t=e.comment)||void 0===t?void 0:t.modes)}function i(e){return e.legacy_mode}s.d(t,"a",(function(){return o})),s.d(t,"b",(function(){return i}))},IfWv:function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return l}));var o=s("0h6b"),i=s("EaLk"),n=s("Cfan"),r=function(e,t,s,o){var i,n=arguments.length,r=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,s):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,s,o);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(r=(n<3?i(r):n>3?i(t,s,r):i(t,s))||r);return n>3&&r&&Object.defineProperty(t,s,r),r},a=function(e,t,s,o){return new(s||(s=Promise))((function(i,n){function r(e){try{l(o.next(e))}catch(t){n(t)}}function a(e){try{l(o.throw(e))}catch(t){n(t)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(r,a)}l((o=o.apply(e,t||[])).next())}))};class l extends n.a{constructor(e){super(e),this.isResetting=!1,this.isUpdating=!1,this.redirect=e.redirect,this.secret=e.secret}delete(){return a(this,void 0,void 0,(function*(){return this.isRevoking=!0,e.ajax({method:"DELETE",url:Object(o.route)("oauth.clients.destroy",{client:this.id})}).then(()=>{this.revoked=!0}).always(()=>{this.isRevoking=!1})}))}resetSecret(){return a(this,void 0,void 0,(function*(){return this.isResetting=!0,e.ajax({method:"POST",url:Object(o.route)("oauth.clients.reset-secret",{client:this.id})}).then(e=>{this.updateFromJson(e)}).always(()=>{this.isResetting=!1})}))}updateFromJson(e){this.id=e.id,this.name=e.name,this.scopes=new Set(e.scopes),this.userId=e.user_id,this.user=e.user,this.redirect=e.redirect,this.secret=e.secret}updateWith(t){return a(this,void 0,void 0,(function*(){const{redirect:s}=t;return this.isUpdating=!0,e.ajax({data:{redirect:s},method:"PUT",url:Object(o.route)("oauth.clients.update",{client:this.id})}).then(e=>{this.updateFromJson(e)}).always(()=>{this.isUpdating=!1})}))}}r([i.m],l.prototype,"isResetting",void 0),r([i.m],l.prototype,"isUpdating",void 0),r([i.d],l.prototype,"delete",null),r([i.d],l.prototype,"resetSecret",null),r([i.d],l.prototype,"updateFromJson",null),r([i.d],l.prototype,"updateWith",null)}).call(this,s("5wds"))},IlO5:function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return r}));var o=s("Hs9Z");const i=e=>{var t;return null!==(t=e.clientX)&&void 0!==t?t:e.touches[0].clientX};let n=null;class r{constructor(t){this.active=!0,this.percentage=0,this.end=()=>{this.active=!1,e(document).off("mousemove touchmove",this.onMove),e(document).off("mouseup touchend",this.end),e(window).off("blur",this.end),e(document).off("turbolinks:before-cache",this.end),null!=this.endCallback&&this.endCallback(this),this.bar.style.removeProperty("--bar"),this.bar.dataset.audioDragging="0",n=null},this.getPercentage=()=>this.percentage,this.move=e=>{if(!this.active)return;const t=this.bar.getBoundingClientRect(),s=e-t.left,i=t.width;this.percentage=Object(o.clamp)(s/i,0,1),null!=this.moveCallback&&this.moveCallback(this),this.bar.style.setProperty("--bar",this.percentage.toString())},this.onMove=e=>{const t=i(e);requestAnimationFrame(()=>{this.move(t)})},this.endCallback=t.endCallback,this.moveCallback=t.moveCallback,this.bar=t.bar,this.bar.dataset.audioDragging="1",this.move(i(t.initialEvent)),e(document).on("mousemove touchmove",this.onMove),e(document).on("mouseup touchend",this.end),e(window).on("blur",this.end),e(document).on("turbolinks:before-cache",this.end)}static start(e){if(0===e.initialEvent.which||1===e.initialEvent.which)return null!=n&&n.end(),n=new r(e)}}r.startEvents="mousedown touchstart"}).call(this,s("5wds"))},JlDh:function(e,t,s){"use strict";s.d(t,"c",(function(){return n})),s.d(t,"b",(function(){return r})),s.d(t,"a",(function(){return a}));var o=s("EaLk"),i=function(e,t,s,o){var i,n=arguments.length,r=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,s):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,s,o);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(r=(n<3?i(r):n>3?i(t,s,r):i(t,s))||r);return n>3&&r&&Object.defineProperty(t,s,r),r};const n=[null,"user","beatmapset","forum_topic","news_post","build","channel"];function r(e){const t=e;return n.indexOf(t)>-1?t:n[0]}class a{constructor(e,t){this.name=e,this.resolver=t,this.isDeleting=!1,this.isLoading=!1,this.isMarkingAsRead=!1,this.stacks=new Map,this.total=0}get hasMore(){return null!==this.cursor&&this.stackNotificationCount<this.total}get hasVisibleNotifications(){return this.total>0&&this.stacks.size>0}get identity(){return{objectType:this.name}}get isEmpty(){return this.total<=0}get stackNotificationCount(){return[...this.stacks.values()].reduce((e,t)=>e+t.total,0)}static fromJson(e,t){const s=new a(e.name,t);return s.updateWithJson(e),s}delete(){this.resolver.delete(this)}loadMore(e){null!==this.cursor&&(this.isLoading=!0,this.resolver.loadMore(this.identity,e,this.cursor).always(Object(o.d)(()=>{this.isLoading=!1})))}markTypeAsRead(){this.resolver.queueMarkAsRead(this)}removeStack(e){const t=this.stacks.delete(e.id);return t&&(this.total-=e.total),t}updateWithJson(e){this.cursor=e.cursor,this.total=e.total}}i([o.m],a.prototype,"cursor",void 0),i([o.m],a.prototype,"isDeleting",void 0),i([o.m],a.prototype,"isLoading",void 0),i([o.m],a.prototype,"isMarkingAsRead",void 0),i([o.m],a.prototype,"stacks",void 0),i([o.m],a.prototype,"total",void 0),i([o.e],a.prototype,"hasMore",null),i([o.e],a.prototype,"hasVisibleNotifications",null),i([o.e],a.prototype,"isEmpty",null),i([o.e],a.prototype,"stackNotificationCount",null),i([o.d],a.prototype,"delete",null),i([o.d],a.prototype,"loadMore",null),i([o.d],a.prototype,"markTypeAsRead",null),i([o.d],a.prototype,"removeStack",null),i([o.d],a.prototype,"updateWithJson",null)},KExx:function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return i}));var o=s("0h6b");class i{constructor(e){this.main=e,this.autoplay=!1,this.applied=!1}get muted(){return this.main.audio.muted}get volume(){return this.main.audio.volume}set volume(e){this.main.audio.volume=e}apply(){this.applied||(this.applied=!0,this.toggleMuted(this.storedMuted()),this.toggleAutoplay(this.storedAutoplay()),this.volume=this.storedVolume())}save(){localStorage.audioAutoplay=JSON.stringify(this.autoplay),localStorage.audioVolume=JSON.stringify(this.volume),localStorage.audioMuted=JSON.stringify(this.muted),null!=currentUser.id&&e.ajax(Object(o.route)("account.options"),{data:{user_profile_customization:{audio_autoplay:this.autoplay,audio_muted:this.muted,audio_volume:this.volume}},method:"PUT"}).fail(osu.ajaxError)}toggleAutoplay(e){this.autoplay=null==e?!this.autoplay:e}toggleMuted(e){this.main.audio.muted=null==e?!this.muted:e}fromLocalStorage(e){if(null==localStorage[e])return null;try{return JSON.parse(localStorage[e])}catch(t){return console.debug(`invalid local ${e} data`),delete localStorage[e],null}}storedAutoplay(){var e;const t=this.fromLocalStorage("audioAutoplay");if("boolean"==typeof t)return t;const s=null===(e=currentUser.user_preferences)||void 0===e?void 0:e.audio_autoplay;return"boolean"!=typeof s||s}storedMuted(){var e;const t=this.fromLocalStorage("audioMuted");if("boolean"==typeof t)return t;const s=null===(e=currentUser.user_preferences)||void 0===e?void 0:e.audio_muted;return"boolean"==typeof s&&s}storedVolume(){var e;const t=this.fromLocalStorage("audioVolume");if("number"==typeof t)return t;const s=null===(e=currentUser.user_preferences)||void 0===e?void 0:e.audio_volume;return"number"==typeof s?s:.45}}}).call(this,s("5wds"))},KMrT:function(e,t,s){"use strict";var o=s("cF9b"),i=s("/G9H"),n=s("2etm"),r=s("Hs9Z");function a(e,t=!1){const s={content:e.details.content,title:e.title,username:e.details.username};"beatmapset_discussion_review_new"===e.name&&null!=e.details.embeds&&r.merge(s,{praises:e.details.embeds.praises,problems:e.details.embeds.problems,suggestions:e.details.embeds.suggestions});let o=`notifications.item.${e.displayType}.${e.category}`;"channel"===e.objectType&&(o+=`.${e.details.type}`),o+=`.${e.name}`,t&&(o+="_compact");const i=`${o}_empty`;return null==e.details.content&&osu.transExists(i)&&(o=i),osu.trans(o,s)}function l(e){if("channel"===e.objectType){const t={title:e.title,username:e.details.username},s=`notifications.item.${e.objectType}.${e.category}.${e.details.type}.${e.name}_group`;return osu.trans(s,t)}if("user_achievement_unlock"===e.name||"user_beatmapset_new"===e.name){const t={username:e.details.username};return osu.trans(`notifications.item.${e.displayType}.${e.category}.${e.name}_group`,t)}return e.title}var c=s("0h6b");function u(e){if("comment_new"===e.name||"comment_reply"===e.name)switch(e.objectType){case"beatmapset":return Object(c.route)("beatmapsets.show",{beatmapset:e.objectId});case"build":return Object(c.route)("changelog.show",{changelog:e.objectId,key:"id"});case"news_post":return Object(c.route)("news.show",{news:e.objectId,key:"id"})}else{if("user_achievement_unlock"===e.name)return p(e);if("user_beatmapset_new"===e.name)return`${Object(c.route)("users.show",{user:e.objectId})}#beatmaps`}switch(e.objectType){case"beatmapset":return Object(c.route)("beatmapsets.discussion",{beatmapset:e.objectId});case"channel":return Object(c.route)("chat.index",{sendto:e.sourceUserId});case"forum_topic":return Object(c.route)("forum.topics.show",{topic:e.objectId,start:"unread"})}}function d(e){switch(e.name){case"beatmapset_discussion_lock":case"beatmapset_discussion_unlock":case"beatmapset_disqualify":case"beatmapset_love":case"beatmapset_nominate":case"beatmapset_qualify":case"beatmapset_remove_from_loved":case"beatmapset_reset_nominations":return Object(c.route)("beatmapsets.discussion",{beatmapset:e.objectId});case"beatmapset_discussion_post_new":case"beatmapset_discussion_qualified_problem":case"beatmapset_discussion_review_new":return BeatmapDiscussionHelper.url({beatmapId:e.details.beatmapId,beatmapsetId:e.objectId,discussionId:e.details.discussionId});case"beatmapset_rank":return Object(c.route)("beatmapsets.show",{beatmapset:e.objectId});case"channel_message":return Object(c.route)("chat.index",{sendto:e.sourceUserId});case"comment_new":case"comment_reply":return Object(c.route)("comments.show",{comment:e.details.commentId});case"forum_topic_reply":return Object(c.route)("forum.posts.show",{post:e.details.postId});case"user_achievement_unlock":return p(e);case"user_beatmapset_new":return Object(c.route)("beatmapsets.show",{beatmapset:e.details.beatmapsetId})}}function p(e){var t;const s={mode:null!==(t=e.details.achievementMode)&&void 0!==t?t:void 0,user:e.details.userId};return`${Object(c.route)("users.show",s)}#medals`}var h=s("h/Ip"),m=s("8Xmz"),f=s("9zVE"),b=s("Ncbg"),v=s("mjdM");let y=class extends i.Component{constructor(){super(...arguments),this.handleDelete=()=>{this.props.stack.deleteItem(this.props.item)},this.handleMarkAsRead=()=>{this.props.stack.markAsRead(this.props.item)}}render(){return i.createElement(v.a,{delete:this.handleDelete,icons:n.c[this.props.item.name||""],item:this.props.item,markRead:this.handleMarkAsRead,message:a(this.props.item,!0),modifiers:["compact"],url:d(this.props.item),withCategory:!1,withCoverImage:"user_achievement_unlock"===this.props.item.name||"user_beatmapset_new"===this.props.item.name})}};var g=y=function(e,t,s,o){var i,n=arguments.length,r=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,s):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,s,o);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(r=(n<3?i(r):n>3?i(t,s,r):i(t,s))||r);return n>3&&r&&Object.defineProperty(t,s,r),r}([o.e],y),_=function(e,t,s,o){var i,n=arguments.length,r=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,s):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,s,o);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(r=(n<3?i(r):n>3?i(t,s,r):i(t,s))||r);return n>3&&r&&Object.defineProperty(t,s,r),r};let w=class extends i.Component{constructor(){super(...arguments),this.state={expanded:!1},this.handleDelete=()=>{this.props.stack.delete()},this.handleMarkAsRead=()=>{this.props.stack.markStackAsRead()},this.handleShowLess=()=>{this.setState({expanded:!1})},this.handleShowMore=()=>{this.props.stack.loadMore(this.context)},this.renderItem=e=>i.createElement("div",{key:e.id,className:"notification-popup-item-group__item"},i.createElement(g,{item:e,stack:this.props.stack})),this.toggleExpand=()=>{this.setState({expanded:!this.state.expanded})}}render(){const e=this.props.stack.first;return null==e?null:i.createElement("div",{className:"notification-popup-item-group"},i.createElement(v.a,{canMarkAsRead:this.props.stack.canMarkAsRead,delete:this.handleDelete,expandButton:this.renderExpandButton(),icons:n.a[e.category],isDeleting:this.props.stack.isDeleting,isMarkingAsRead:this.props.stack.isMarkingAsRead,item:e,markRead:this.handleMarkAsRead,message:l(e),modifiers:["group"],url:u(e),withCategory:!0,withCoverImage:!0}),this.renderItems())}renderExpandButton(){const e=this.props.stack.total,t=this.context.isWidget?"common.count.update":"common.count.notifications";return i.createElement("button",{className:"show-more-link show-more-link--notification-group",onClick:this.toggleExpand,type:"button"},i.createElement("span",{className:"show-more-link__label"},i.createElement("span",{className:"show-more-link__label-text"},osu.transChoice(t,e)),i.createElement("span",{className:"show-more-link__label-icon"},i.createElement("span",{className:`fas fa-angle-${this.state.expanded?"up":"down"}`}))))}renderItems(){return this.state.expanded?i.createElement("div",{className:"notification-popup-item-group__items"},this.props.stack.orderedNotifications.map(this.renderItem),i.createElement("div",{className:"notification-popup-item-group__show-more"},i.createElement("div",{className:"notification-popup-item-group__expand"},this.renderShowMore()),i.createElement("div",{className:"notification-popup-item-group__collapse"},this.renderShowLess(),i.createElement(f.a,{isMarkingAsRead:this.props.stack.isMarkingAsRead,onMarkAsRead:this.handleMarkAsRead}),!this.context.isWidget&&i.createElement(m.a,{isDeleting:this.props.stack.isDeleting,onDelete:this.handleDelete})))):null}renderShowLess(){return i.createElement(b.a,{callback:this.handleShowLess,direction:"up",hasMore:!0,label:osu.trans("common.buttons.show_less"),modifiers:["notification-group"]})}renderShowMore(){const e=this.props.stack;return e.hasMore?i.createElement(b.a,{callback:this.handleShowMore,hasMore:null!=e.cursor,loading:e.isLoading,modifiers:["notification-group"]}):null}};w.contextType=h.a;var E=w=_([o.e],w);let O=class extends i.Component{constructor(){super(...arguments),this.handleDelete=()=>{this.props.stack.deleteItem(this.props.stack.first)},this.handleMarkAsRead=()=>{this.props.stack.markAsRead(this.props.stack.first)}}render(){const e=this.props.stack.first;return null==e?null:i.createElement(v.a,{delete:this.handleDelete,icons:n.b[e.name||""],isDeleting:e.isDeleting,isMarkingAsRead:e.isMarkingAsRead,item:e,markRead:this.handleMarkAsRead,message:a(e),modifiers:["one"],url:d(e),withCategory:!0,withCoverImage:!0})}};var j=O=function(e,t,s,o){var i,n=arguments.length,r=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,s):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,s,o);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(r=(n<3?i(r):n>3?i(t,s,r):i(t,s))||r);return n>3&&r&&Object.defineProperty(t,s,r),r}([o.e],O);let k=class extends i.Component{render(){if(!this.props.stack.hasVisibleNotifications)return null;const e=this.props.stack.isSingle?j:E;return i.createElement(e,{key:this.props.stack.id,stack:this.props.stack})}};k=function(e,t,s,o){var i,n=arguments.length,r=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,s):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,s,o);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(r=(n<3?i(r):n>3?i(t,s,r):i(t,s))||r);return n>3&&r&&Object.defineProperty(t,s,r),r}([o.e],k);t.a=k},KYGQ:function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return i}));const o="js-extra-script";class i{constructor(){this.loaded={},this.cleanup=()=>{e(`.${o}`).remove()},this.forget=e=>{delete this.loaded[e]},this.load=(e,t)=>{if(this.loaded[e])return;const s=document.createElement("script");return s.classList.add(o),s.onload=()=>{null!=s.parentElement&&(s.parentElement.removeChild(s),null!=t&&t())},s.src=e,document.body.appendChild(s),this.loaded[e]=!0},document.addEventListener("turbolinks:before-cache",this.cleanup)}}}).call(this,s("5wds"))},L2k0:function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return c}));var o=s("0h6b"),i=s("/G9H"),n=s("PPOh"),r=s("/jJF"),a=s("tX/w");const l="user-action-button";class c extends i.Component{constructor(t){var s,n,a;super(t),this.buttonRef=i.createRef(),this.eventId=`follow-user-mapping-button-${osu.uuid()}`,this.onClick=()=>{this.setState({loading:!0},()=>{const t={data:{follow:{notifiable_id:this.props.userId,notifiable_type:"user",subtype:"mapping"}}};this.state.following?(t.type="DELETE",t.url=Object(o.route)("follows.destroy")):(t.type="POST",t.url=Object(o.route)("follows.store")),this.xhr=e.ajax(t).done(this.updateData).fail(Object(r.d)(this.buttonRef.current)).always(()=>this.setState({loading:!1}))})},this.refresh=()=>{this.setState({following:currentUser.follow_user_mapping.includes(this.props.userId)})},this.updateData=()=>{e.publish("user:followUserMapping:update",{following:!this.state.following,userId:this.props.userId})};const l=null!==(n=null===(s=currentUser.follow_user_mapping)||void 0===s?void 0:s.includes(this.props.userId))&&void 0!==n&&n;let c=null!==(a=this.props.followers)&&void 0!==a?a:0;!1!==l&&(c-=1),this.state={followersWithoutSelf:c,following:l,loading:!1}}componentDidMount(){e.subscribe(`user:followUserMapping:refresh.${this.eventId}`,this.refresh)}componentWillUnmount(){var t;e.unsubscribe(`.${this.eventId}`),null===(t=this.xhr)||void 0===t||t.abort()}render(){const e=!(null==currentUser.id||currentUser.id===this.props.userId);if(!e&&!this.props.alwaysVisible)return null;const t=e?osu.trans(`follows.mapping.${this.state.following?"to_0":"to_1"}`):osu.trans("follows.mapping.followers");let s=Object(a.a)(l,this.props.modifiers);s+=Object(a.a)(l,{friend:this.state.following},!0);const o=this.state.loading||!e;return i.createElement("div",{title:t},i.createElement("button",{ref:this.buttonRef,className:s,disabled:o,onClick:this.onClick},this.renderIcon(),this.renderCounter()))}followers(){return this.state.followersWithoutSelf+(this.state.following?1:0)}renderCounter(){if(null!=this.props.showFollowerCounter&&null!=this.props.followers)return i.createElement("span",{className:`${l}__counter`},osu.formatNumber(this.followers()))}renderIcon(){const e=this.state.loading?i.createElement(n.a,null):i.createElement("i",{className:"fas fa-bell"});return i.createElement("span",{className:`${l}__icon-container`},e)}}}).call(this,s("5wds"))},LhsB:function(e,t,s){"use strict";s.d(t,"a",(function(){return i}));var o=s("/G9H");const i=Object(o.createContext)(void 0)},MeXQ:function(e,t,s){"use strict";s.d(t,"a",(function(){return l}));var o=s("/G9H"),i=s("I8Ok"),n=function(e,t){return function(){return e.apply(t,arguments)}},r={}.hasOwnProperty,a=[].indexOf||function(e){for(var t=0,s=this.length;t<s;t++)if(t in this&&this[t]===e)return t;return-1},l=function(e){function t(e){var s;this.toggleSelector=n(this.toggleSelector,this),this.renderOptions=n(this.renderOptions,this),this.renderOption=n(this.renderOption,this),this.render=n(this.render,this),this.optionSelected=n(this.optionSelected,this),this.hideSelector=n(this.hideSelector,this),this.componentDidUpdate=n(this.componentDidUpdate,this),this.componentDidMount=n(this.componentDidMount,this),t.__super__.constructor.call(this,e),this.bn=null!=(s=this.props.bn)?s:"select-options",this.hasBlackout=this.props.blackout||void 0===this.props.blackout,this.ref=Object(o.createRef)(),this.state={showingSelector:!1}}return function(e,t){for(var s in t)r.call(t,s)&&(e[s]=t[s]);function o(){this.constructor=e}o.prototype=t.prototype,e.prototype=new o,e.__super__=t.prototype}(t,e),t.prototype.componentDidMount=function(){return document.addEventListener("click",this.hideSelector)},t.prototype.componentDidUpdate=function(e,t){if(this.hasBlackout&&t.showingSelector!==this.state.showingSelector)return Blackout.toggle(this.state.showingSelector,.5)},t.prototype.componentWillUnmount=function(){return document.removeEventListener("click",this.hideSelector)},t.prototype.hideSelector=function(e){var t;if(0===e.button&&(t=this.ref.current,!(a.call(e.composedPath(),t)>=0)))return this.setState({showingSelector:!1})},t.prototype.optionSelected=function(e,t){var s;if(0===e.button)return e.preventDefault(),this.setState({showingSelector:!1}),"function"==typeof(s=this.props).onChange?s.onChange(t):void 0},t.prototype.render=function(){var e,t;return e=""+this.bn,this.state.showingSelector&&(e+=" "+this.bn+"--selecting"),Object(i.div)({className:e,ref:this.ref},Object(i.div)({className:this.bn+"__select"},this.renderOption({children:[Object(i.div)({className:"u-ellipsis-overflow",key:"current"},null!=(t=this.props.selected)?t.text:void 0),Object(i.div)({key:"decoration",className:this.bn+"__decoration"},Object(i.i)({className:"fas fa-chevron-down"}))],onClick:this.toggleSelector,option:this.props.selected})),Object(i.div)({className:this.bn+"__selector"},this.renderOptions()))},t.prototype.renderOption=function(e){var t,s,o,n,r,a;return t=e.children,o=e.onClick,n=e.option,a=null!=(r=e.selected)&&r,s=this.bn+"__option",a&&(s+=" "+this.bn+"__option--selected"),null!=this.props.renderOption?this.props.renderOption({children:t,cssClasses:s,onClick:o,option:n}):Object(i.a)({className:s,href:"#",key:n.id,onClick:o},t)},t.prototype.renderOptions=function(){var e,t,s,o,n;for(n=[],e=0,t=(o=this.props.options).length;e<t;e++)s=o[e],n.push(function(e){return function(t){var s;return e.renderOption({children:[Object(i.div)({className:"u-ellipsis-overflow",key:t.id},t.text)],onClick:function(s){return e.optionSelected(s,t)},option:t,selected:(null!=(s=e.props.selected)?s.id:void 0)===t.id})}}(this)(s));return n},t.prototype.toggleSelector=function(e){if(0===e.button)return e.preventDefault(),this.setState({showingSelector:!this.state.showingSelector})},t}(o.PureComponent)},N05Q:function(e,t,s){"use strict";s.d(t,"a",(function(){return i}));var o=s("0h6b");function i(e){return[{active:"home"===e,title:osu.trans("home.user.title"),url:Object(o.route)("home")},{active:"friends.index"===e,title:osu.trans("friends.title_compact"),url:Object(o.route)("friends.index")},{active:"follows.index"===e,title:osu.trans("follows.index.title_compact"),url:Object(o.route)("follows.index",{subtype:"forum_topic"})},{active:"account.edit"===e,title:osu.trans("accounts.edit.title_compact"),url:Object(o.route)("account.edit")}]}},"NW+U":function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return i}));var o=s("I8Ok"),i=function(t){var s;return s=e.extend(osu.src2x(t.src),t),Object(o.img)(s,t.children)}}).call(this,s("Hs9Z"))},Ncbg:function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return r}));var o=s("/G9H"),i=s("PPOh");const n="show-more-link",r=o.forwardRef((t,s)=>{var r,a;if(!t.hasMore&&!t.loading)return null;const l=o.createElement("span",{className:`fas fa-angle-${null!==(r=t.direction)&&void 0!==r?r:"down"}`}),c={children:o.createElement(o.Fragment,null,o.createElement("span",{className:`${n}__spinner`},o.createElement(i.a,null)),o.createElement("span",{className:`${n}__label`},o.createElement("span",{className:`${n}__label-icon ${n}__label-icon--left`},l),o.createElement("span",{className:`${n}__label-text`},null!==(a=t.label)&&void 0!==a?a:osu.trans("common.buttons.show_more"),null!=t.remaining&&` (${t.remaining})`),o.createElement("span",{className:`${n}__label-icon ${n}__label-icon--right`},l))),className:osu.classWithModifiers(n,t.modifiers),ref:s};if(t.loading)return o.createElement("span",Object.assign({"data-disabled":"1"},c));const u=t.url;let d=t.callback;return null==d&&null==u&&(d=()=>e.publish(t.event,t.data)),null==u?o.createElement("button",Object.assign({onClick:d,type:"button"},c)):o.createElement("a",Object.assign({href:u,onClick:d},c))})}).call(this,s("5wds"))},O0zI:function(e,t,s){"use strict";(function(e,o){s.d(t,"a",(function(){return f}));var i,n,r,a=s("f4vq"),l=s("/G9H"),c=s("I8Ok"),u=s("Ncbg"),d=s("PPOh"),p=function(e,t){return function(){return e.apply(t,arguments)}},h={}.hasOwnProperty,m=[].indexOf||function(e){for(var t=0,s=this.length;t<s;t++)if(t in this&&this[t]===e)return t;return-1};n=l.createElement,r=a.a.dataStore.uiState,i="comment-show-more";var f=function(t){function s(e){this.load=p(this.load,this),this.render=p(this.render,this),this.componentWillUnmount=p(this.componentWillUnmount,this),s.__super__.constructor.call(this,e),this.state={loading:!1}}return function(e,t){for(var s in t)h.call(t,s)&&(e[s]=t[s]);function o(){this.constructor=e}o.prototype=t.prototype,e.prototype=new o,e.__super__=t.prototype}(s,t),s.defaultProps={modifiers:[]},s.prototype.componentWillUnmount=function(){var e;return null!=(e=this.xhr)?e.abort():void 0},s.prototype.render=function(){var e,t,s,o,a,l,p;return this.props.comments.length>=this.props.total?null:null==(s=r.comments.hasMoreComments[null!=(o=null!=(a=this.props.parent)?a.id:void 0)?o:null])||s?(e=osu.classWithModifiers(i,this.props.modifiers),m.call(this.props.modifiers,"top")>=0?(p=this.props.total-this.props.comments.length,t=["comments"],m.call(this.props.modifiers,"changelog")>=0?t.push("t-greyviolet-darker"):t.push("t-ddd"),n(u.a,{loading:this.state.loading,hasMore:!0,callback:this.load,modifiers:t,remaining:p})):Object(c.div)({className:e},this.state.loading?n(d.a):Object(c.button)({className:i+"__link",onClick:this.load},null!=(l=this.props.label)?l:osu.trans("common.buttons.show_more")))):null},s.prototype.load=function(){var t,s,i,n,a,l,c,u,d;return this.setState({loading:!0}),s={commentable_type:null!=(i=null!=(n=this.props.parent)?n.commentable_type:void 0)?i:this.props.commentableType,commentable_id:null!=(a=null!=(l=this.props.parent)?l.commentable_id:void 0)?a:this.props.commentableId,parent_id:null!=(c=null!=(u=this.props.parent)?u.id:void 0)?c:0,sort:r.comments.currentSort},null!=(t=e.last(this.props.comments))&&(s.cursor={id:t.id,created_at:t.createdAt,votes_count:t.votesCount}),this.xhr=o.ajax(laroute.route("comments.index"),{data:s,dataType:"json"}).done((function(e){return o.publish("comments:added",e)})).always((d=this,function(){return d.setState({loading:!1})}))},s}(l.PureComponent)}).call(this,s("Hs9Z"),s("5wds"))},"OjW+":function(e,t,s){"use strict";var o=s("0h6b"),i=s("cF9b"),n=s("vcN5"),r=s("/G9H"),a=s("yun6"),l=function(e,t,s,o){var i,n=arguments.length,r=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,s):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,s,o);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(r=(n<3?i(r):n>3?i(t,s,r):i(t,s))||r);return n>3&&r&&Object.defineProperty(t,s,r),r};const c={entered:{opacity:1},entering:{},exited:{},exiting:{},unmounted:{}},u=Object(i.e)(({beatmaps:e,mode:t})=>r.createElement("div",{className:"beatmaps-popup__group"},e.map(e=>r.createElement(d,{key:e.id,beatmap:e})))),d=Object(i.e)(({beatmap:e})=>r.createElement("a",{className:"beatmaps-popup-item",href:Object(o.route)("beatmaps.show",{beatmap:e.id})},r.createElement("span",{className:"beatmaps-popup-item__col beatmaps-popup-item__col--mode"},r.createElement("span",{className:`fal fa-extra-mode-${e.mode}`})),r.createElement("span",{className:"beatmaps-popup-item__col beatmaps-popup-item__col--difficulty",style:{"--bg":`var(--diff-${Object(a.d)(e.difficulty_rating)})`}},r.createElement("span",{className:"beatmaps-popup-item__difficulty-icon"},r.createElement("span",{className:"fas fa-star"})),osu.formatNumber(e.difficulty_rating,2)),r.createElement("span",{className:"beatmaps-popup-item__col beatmaps-popup-item__col--name u-ellipsis-overflow"},e.version)));let p=class extends r.Component{constructor(){super(...arguments),this.contentRef=r.createRef()}render(){const e=Object.assign({opacity:0,transitionDuration:`${this.props.transitionDuration}ms`},c[this.props.state]);if(null!=this.props.parent){const t=this.props.parent.getBoundingClientRect();e.top=`${window.scrollY+t.bottom}px`,e.left=`${window.scrollX+t.left}px`,e.width=`${t.width}px`}return r.createElement(n.a,null,r.createElement("div",{ref:this.contentRef,className:"beatmaps-popup",onMouseEnter:this.props.onMouseEnter,onMouseLeave:this.props.onMouseLeave,style:e},r.createElement("div",{className:"beatmaps-popup__content"},this.props.groupedBeatmaps.map(e=>r.createElement(u,Object.assign({key:e.mode},e))))))}};p=l([i.e],p),t.a=p},PPOh:function(e,t,s){"use strict";s.d(t,"a",(function(){return n}));var o=s("/G9H"),i=s("tX/w");function n(e){return o.createElement("div",{className:Object(i.a)("la-ball-clip-rotate",e.modifiers)})}},PTft:function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return r}));s("/G9H");var o,i,n=s("I8Ok");o="beatmap-basic-stats",i=function(t){var s,o,i;return i=t%60,o=Math.floor(t/60)%60,(s=Math.floor(t/3600))>0?s+":"+e.padStart(o,2,0)+":"+e.padStart(i,2,0):o+":"+e.padStart(i,2,0)};var r=function(e){var t,s,r;return t=e.beatmap,Object(n.div)({className:o},function(){var e,a,l,c;for(c=[],e=0,a=(l=["total_length","bpm","count_circles","count_sliders"]).length;e<a;e++)r=t[s=l[e]],r="bpm"===s?r>1e3?"âˆž":osu.formatNumber(r):"total_length"===s?i(r):osu.formatNumber(r),c.push(Object(n.div)({className:o+"__entry",key:s,title:osu.trans("beatmapsets.show.stats."+s,"total_length"===s?{hit_length:i(t.hit_length)}:void 0)},Object(n.div)({className:o+"__entry-icon",style:{backgroundImage:"url(/images/layout/beatmapset-page/"+s+".svg)"}}),Object(n.span)(null,r)));return c}())}}).call(this,s("Hs9Z"))},"R+Xi":function(e,t,s){"use strict";s.d(t,"a",(function(){return r}));var o=s("0h6b"),i=s("/G9H"),n=s("tX/w");function r(e){return i.createElement("div",{className:"page-tabs page-tabs--follows"},["comment","forum_topic","mapping","modding"].map(t=>i.createElement("a",{key:t,className:Object(n.a)("page-tabs__tab",{active:t===e.currentSubtype}),href:Object(o.route)("follows.index",{subtype:t})},osu.trans(`follows.${t}.title`))))}},RHtj:function(e,t,s){"use strict";s.d(t,"a",(function(){return n}));var o=s("/G9H"),i=s("qhp/");class n extends o.PureComponent{render(){return this.props.events.map(e=>o.createElement(i.a,{key:e.id,event:e,mode:"profile",users:this.props.users}))}}},S5CA:function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return r}));var o,i=s("/G9H"),n=s("I8Ok");i.createElement,o={add:"fas fa-plus",fix:"fas fa-check",misc:"far fa-circle"};var r=function(t){var s,i,r,a,l,c;return s=t.entry,Object(n.div)({className:"changelog-entry",key:s.id},Object(n.div)({className:"changelog-entry__row"},Object(n.div)({className:"changelog-entry__title "+(s.major?"changelog-entry__title--major":"")},Object(n.span)({className:"changelog-entry__title-icon"},Object(n.span)({className:"changelog-entry__icon "+o[s.type]})),null!=s.url?Object(n.a)({href:s.url,className:"changelog-entry__link"},s.title):s.title,null!=s.github_url?Object(n.span)(null," (",Object(n.a)({className:"changelog-entry__link",href:s.github_url},s.repository.replace(/^.*\//,"")+"#"+s.github_pull_request_id),")"):void 0,(c=e.escape(s.github_user.display_name),i=null!=(l=null!=(r=s.github_user.github_url)?r:s.github_user.user_url)?"<a data-user-id='"+(null!=(a=s.github_user.user_id)?a:"")+"' class='changelog-entry__user-link js-usercard' href='"+e.escape(l)+"' >"+c+"</a>":c,Object(n.span)({className:"changelog-entry__user",dangerouslySetInnerHTML:{__html:osu.trans("changelog.entry.by",{user:i})}})))),null!=s.message_html?Object(n.div)({className:"changelog-entry__row changelog-entry__row--message",dangerouslySetInnerHTML:{__html:s.message_html}}):void 0)}}).call(this,s("Hs9Z"))},SA7k:function(e,t,s){"use strict";function o(e){return null!=e.best_id&&!e.user.is_deleted&&null!=currentUser.id&&e.user_id!==currentUser.id}function i(e){return o(e)||n(e)||r(e)}function n(e){return e.replay}function r(e){return null!=e.best_id}s.d(t,"a",(function(){return o})),s.d(t,"b",(function(){return i})),s.d(t,"c",(function(){return n})),s.d(t,"d",(function(){return r}))},"SW8+":function(e,t,s){"use strict";s.d(t,"a",(function(){return a}));var o=s("/G9H"),i=s("I8Ok"),n=function(e,t){return function(){return e.apply(t,arguments)}},r={}.hasOwnProperty;o.createElement;var a=function(e){function t(){return this.render=n(this.render,this),t.__super__.constructor.apply(this,arguments)}return function(e,t){for(var s in t)r.call(t,s)&&(e[s]=t[s]);function o(){this.constructor=e}o.prototype=t.prototype,e.prototype=new o,e.__super__=t.prototype}(t,e),t.prototype.render=function(){var e;return e="page-mode-link page-mode-link--profile-page",this.props.page===this.props.currentPage&&(e+=" page-mode-link--is-active"),Object(i.span)({className:e},Object(i.span)({className:"fake-bold","data-content":osu.trans("users.show.extra."+this.props.page+".title")},osu.trans("users.show.extra."+this.props.page+".title")),Object(i.span)({className:"page-mode-link__stripe"}))},t}(o.PureComponent)},SYsv:function(e,t,s){"use strict";s.d(t,"a",(function(){return n}));var o=s("/G9H"),i=s("I8Ok");o.createElement;var n=function(e){return Object(i.div)({className:"u-relative"},Object(i.h2)({className:"title title--page-extra"},osu.trans("users.show.extra."+e.name+".title")),e.withEdit?Object(i.span)({className:"page-extra__dragdrop-toggle hidden-xs js-profile-page-extra--sortable-handle"},Object(i.i)({className:"fas fa-bars"})):void 0)}},SwEc:function(e,t,s){"use strict";s.d(t,"a",(function(){return a}));var o,i=s("/G9H"),n=s("+FrL"),r=s("I8Ok");o=i.createElement;var a=function(e){var t,s,i,a,l,c,u,d,p,h,m;for(d=e.type,u=e.stats,i=e.modifiers,m=[],t=0,s=(c=null!=(l=u.variants)?l:[]).length;t<s;t++)null!=(h=c[t])[d+"_rank"]&&(a=osu.trans("beatmaps.variant."+h.mode+"."+h.variant),p="#"+osu.formatNumber(h[d+"_rank"]),m.push("<div>"+a+": "+p+"</div>"));return o(n.a,{modifiers:i,label:osu.trans("users.show.rank."+d+"_simple"),value:Object(r.div)({title:"","data-html-title":m.join("")},null!=u[d+"_rank"]?"#"+osu.formatNumber(u[d+"_rank"]):"-")})}},TGI5:function(e,t,s){"use strict";(function(e,o){s.d(t,"a",(function(){return u}));var i,n=s("f7bm"),r=s("/G9H"),a=s("I8Ok"),l=function(e,t){return function(){return e.apply(t,arguments)}},c={}.hasOwnProperty;i=r.createElement;var u=function(t){var s,r,u,d;function p(){return this.renderText=l(this.renderText,this),this.renderLink=l(this.renderLink,this),this.render=l(this.render,this),p.__super__.constructor.apply(this,arguments)}return function(e,t){for(var s in t)c.call(t,s)&&(e[s]=t[s]);function o(){this.constructor=e}o.prototype=t.prototype,e.prototype=new o,e.__super__=t.prototype}(p,t),s="profile-links",u=function(e,t,o){var i,n,r,a;for(n in null==t&&(t={}),null==o&&(o=[]),null!=t.href?(r="a",o.push("link")):r="span",i=document.createElement(r),t)c.call(t,n)&&(a=t[n],i[n]=a);return i.className+=" "+osu.classWithModifiers(s+"__value",o),i.innerHTML=e,i.outerHTML},r={twitter:function(e){return{icon:"fab fa-twitter",url:"https://twitter.com/"+e,text:"@"+e}},discord:function(e){return{icon:"fab fa-discord",text:i(n.a,{value:e,showIcon:!0})}},interests:function(){return{icon:"far fa-heart"}},location:function(){return{icon:"fas fa-map-marker-alt"}},occupation:function(){return{icon:"fas fa-suitcase"}},website:function(e){return{icon:"fas fa-link",url:e,text:e.replace(/^https?:\/\//,"")}}},d={comments_count:function(e,t){var s,o;return s=osu.transChoice("users.show.comments_count.count",e),o=laroute.route("comments.index",{user_id:t.id}),{html:osu.trans("users.show.comments_count._",{link:u(s,{href:o})})}},join_date:function(t){var s,o;return o=(s=e(t)).toISOString(),s.isBefore(e.utc([2008]))?{title:o,extraClasses:"js-tooltip-time",html:osu.trans("users.show.first_members")}:{html:osu.trans("users.show.joined_at",{date:u(s.format(osu.trans("common.datetime.year_month.moment")),{className:"js-tooltip-time",title:o})})}},last_visit:function(e,t){return t.is_online?{html:osu.trans("users.show.lastvisit_online")}:{html:osu.trans("users.show.lastvisit",{date:u(osu.timeago(e))})}},playstyle:function(e){var t;return t=e.map((function(e){return osu.trans("common.device."+e)})).join(", "),{html:osu.trans("users.show.plays_with",{devices:u(t)})}},post_count:function(e,t){var s,o;return s=osu.transChoice("users.show.post_count.count",e),o=laroute.route("users.posts",{user:t.id}),{html:osu.trans("users.show.post_count._",{link:u(s,{href:o})})}}},p.prototype.render=function(){var e,t,i;return i=[["join_date","last_visit","playstyle","post_count","comments_count"].map(this.renderText),["location","interests","occupation"].map(this.renderLink),["twitter","discord","website"].map(this.renderLink)],Object(a.div)({className:s},function(){var n,r,l;for(l=[],e=n=0,r=i.length;n<r;e=++n)t=i[e],o.compact(t).length>0&&l.push(Object(a.div)({key:e,className:s+"__row "+s+"__row--"+e},t));return l}(),this.props.user.id===currentUser.id?Object(a.div)({className:s+"__edit"},Object(a.a)({className:"profile-page-toggle",href:laroute.route("account.edit"),title:osu.trans("users.show.page.button")},Object(a.span)({className:"fas fa-pencil-alt"}))):void 0)},p.prototype.renderLink=function(e){var t,o,i,n,l,c,u;if(null!=(u=this.props.user[e]))return c=(i=r[e](u)).url,o=i.icon,n=i.text,null==(l=i.title)&&(l=osu.trans("users.show.info."+e)),null==n&&(n=u),s+"__value",t=null!=c?a.a:a.span,Object(a.div)({className:s+"__item",key:e},Object(a.span)({className:s+"__icon",title:l},Object(a.span)({className:"fa-fw "+o})),t({href:c,className:"profile-links__value"},n))},p.prototype.renderText=function(e){var t,o,i,n,r;if(null!=(r=this.props.user[e]))return t=(i=d[e](r,this.props.user)).extraClasses,o=i.html,n=i.title,Object(a.div)({className:s+"__item "+(null!=t?t:""),key:e,title:n,dangerouslySetInnerHTML:{__html:o}})},p}(r.PureComponent)}).call(this,s("7EfK"),s("Hs9Z"))},TY2o:function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return i}));s("/G9H");var o=s("I8Ok");var i=function(t){return null!=t.user.id?Object(o.div)({className:osu.classWithModifiers("avatar",t.modifiers),style:{backgroundImage:osu.urlPresence(t.user.avatar_url)}}):Object(o.div)({className:osu.classWithModifiers("avatar",e.concat(t.modifiers,"guest"))})}}).call(this,s("Hs9Z"))},TezV:function(e,t,s){"use strict";s.d(t,"a",(function(){return a}));var o=s("Hs9Z"),i=s("C92G"),n=s("/G9H"),r=s("ss8h");class a extends n.Component{constructor(){super(...arguments),this.renderButton=(e,t,s)=>{const i=o.find(this.props.menuOptions,e=>e.id===this.props.selected)||this.props.menuOptions[0],r=[];return this.props.disabled&&(s=()=>{},r.push("disabled")),n.createElement("div",{ref:t,className:osu.classWithModifiers("icon-dropdown-menu",r),contentEditable:!1,onClick:s},i.icon,e)},this.renderMenuItem=e=>{const t=[];return e.id===this.props.selected&&t.push("active"),n.createElement("button",{key:e.id,className:osu.classWithModifiers("simple-menu__item",t),"data-id":e.id,onClick:this.select},n.createElement("div",{className:osu.classWithModifiers("simple-menu__item-icon",["icon-dropdown-menu"])},e.icon),n.createElement("div",{className:"simple-menu__label"},e.label))},this.select=e=>{var t;e.preventDefault();const s=e.currentTarget;s&&this.props.onSelect(null!==(t=s.dataset.id)&&void 0!==t?t:"")}}render(){return n.createElement(i.a,{customRender:this.renderButton},()=>n.createElement("div",{className:"simple-menu simple-menu--popup-menu-compact"},this.props.menuOptions.map(e=>this.renderMenuItem(e))))}}a.contextType=r.a},U70x:function(e,t,s){"use strict";(function(e,o){s.d(t,"a",(function(){return f}));var i=s("0h6b"),n=s("7EfK"),r=s("/G9H"),a=s("6e4D"),l=s("XPyy"),c=s("ed4P");const u=["all","online","offline"],d=["all","osu","taiko","fruits","mania"],p=["last_visit","rank","username"];function h(e,t){var s,o,i,n;return(null!==(o=null===(s=e.statistics)||void 0===s?void 0:s.global_rank)&&void 0!==o?o:Number.MAX_VALUE)-(null!==(n=null===(i=t.statistics)||void 0===i?void 0:i.global_rank)&&void 0!==n?n:Number.MAX_VALUE)}function m(e,t){return e.username.localeCompare(t.username)}class f extends r.PureComponent{constructor(){super(...arguments),this.state={filter:this.filterFromUrl,playMode:this.playmodeFromUrl,sortMode:this.sortFromUrl,viewMode:this.viewFromUrl},this.handleSortChange=t=>{const s=t.currentTarget.dataset.value,o=osu.updateQueryString(null,{sort:s});e.controller.advanceHistory(o),this.setState({sortMode:s},this.handleSaveOptions)},this.onViewSelected=t=>{const s=t.currentTarget.dataset.value,o=osu.updateQueryString(null,{view:s});e.controller.advanceHistory(o),this.setState({viewMode:s},this.handleSaveOptions)},this.optionSelected=t=>{t.preventDefault();const s=t.currentTarget.dataset.key,o=osu.updateQueryString(null,{filter:s});e.controller.advanceHistory(o),this.setState({filter:s},this.handleSaveOptions)},this.playmodeSelected=t=>{const s=t.currentTarget.dataset.value,o=osu.updateQueryString(null,{mode:s});e.controller.advanceHistory(o),this.setState({playMode:s})},this.handleSaveOptions=()=>{null!=currentUser.id&&o.ajax(Object(i.route)("account.options"),{dataType:"JSON",method:"PUT",data:{user_profile_customization:{user_list_filter:this.state.filter,user_list_sort:this.state.sortMode,user_list_view:this.state.viewMode}}}).done(e=>o.publish("user:update",e))}}get filterFromUrl(){var e;const t=new URL(location.href);return this.getAllowedQueryStringValue(u,t.searchParams.get("filter"),null===(e=null===currentUser||void 0===currentUser?void 0:currentUser.user_preferences)||void 0===e?void 0:e.user_list_filter)}get playmodeFromUrl(){const e=new URL(location.href);return this.getAllowedQueryStringValue(d,e.searchParams.get("mode"),"all")}get sortedUsers(){const e=this.getFilteredUsers(this.state.filter).slice();switch(this.state.sortMode){case"rank":return e.sort(h);case"username":return e.sort(m);default:return e.sort((e,t)=>e.is_online&&t.is_online?m(e,t):e.is_online||t.is_online?e.is_online?-1:1:n(t.last_visit||0).diff(n(e.last_visit||0)))}}get sortFromUrl(){var e;const t=new URL(location.href);return this.getAllowedQueryStringValue(p,t.searchParams.get("sort"),null===(e=null===currentUser||void 0===currentUser?void 0:currentUser.user_preferences)||void 0===e?void 0:e.user_list_sort)}get viewFromUrl(){var e;const t=new URL(location.href);return this.getAllowedQueryStringValue(l.b,t.searchParams.get("view"),null===(e=null===currentUser||void 0===currentUser?void 0:currentUser.user_preferences)||void 0===e?void 0:e.user_list_view)}render(){return r.createElement(r.Fragment,null,this.renderSelections(),r.createElement("div",{className:"user-list"},null!=this.props.title&&r.createElement("h1",{className:"user-list__title"},this.props.title),r.createElement("div",{className:"user-list__toolbar"},this.props.playmodeFilter&&r.createElement("div",{className:"user-list__toolbar-row"},r.createElement("div",{className:"user-list__toolbar-item"},this.renderPlaymodeFilter())),r.createElement("div",{className:"user-list__toolbar-row"},r.createElement("div",{className:"user-list__toolbar-item"},this.renderSorter()),r.createElement("div",{className:"user-list__toolbar-item"},this.renderViewMode()))),r.createElement("div",{className:"user-list__items"},r.createElement(c.a,{users:this.sortedUsers,viewMode:this.state.viewMode}))))}renderOption(e,t,s=!1){const o=s?["active"]:[];let i=osu.classWithModifiers("update-streams-v2__item",o);return i+=` t-changelog-stream--${e}`,r.createElement("a",{key:e,className:i,"data-key":e,href:osu.updateQueryString(null,{filter:e}),onClick:this.optionSelected},r.createElement("div",{className:"update-streams-v2__bar u-changelog-stream--bg"}),r.createElement("p",{className:"update-streams-v2__row update-streams-v2__row--name"},osu.trans(`users.status.${e}`)),r.createElement("p",{className:"update-streams-v2__row update-streams-v2__row--version"},t))}renderSelections(){return r.createElement("div",{className:"update-streams-v2 update-streams-v2--with-active update-streams-v2--user-list"},r.createElement("div",{className:"update-streams-v2__container"},u.map(e=>this.renderOption(e,this.getFilteredUsers(e).length,e===this.state.filter))))}renderSorter(){return r.createElement(a.a,{currentValue:this.state.sortMode,modifiers:["user-list"],onChange:this.handleSortChange,values:p})}renderViewMode(){return r.createElement("div",{className:"user-list__view-modes"},r.createElement("button",{className:osu.classWithModifiers("user-list__view-mode","card"===this.state.viewMode?["active"]:[]),"data-value":"card",onClick:this.onViewSelected,title:osu.trans("users.view_mode.card")},r.createElement("span",{className:"fas fa-square"})),r.createElement("button",{className:osu.classWithModifiers("user-list__view-mode","list"===this.state.viewMode?["active"]:[]),"data-value":"list",onClick:this.onViewSelected,title:osu.trans("users.view_mode.list")},r.createElement("span",{className:"fas fa-bars"})),r.createElement("button",{className:osu.classWithModifiers("user-list__view-mode","brick"===this.state.viewMode?["active"]:[]),"data-value":"brick",onClick:this.onViewSelected,title:osu.trans("users.view_mode.brick")},r.createElement("span",{className:"fas fa-th"})))}getAllowedQueryStringValue(e,t,s){const o=t;if(e.indexOf(o)>-1)return o;const i=s;return e.indexOf(i)>-1?i:e[0]}getFilteredUsers(e){let t=this.props.users.slice();switch(this.props.playmodeFilter&&"all"!==this.state.playMode&&(t=t.filter(e=>!!(e.groups&&e.groups.length>0)&&e.groups.some(e=>e.playmodes&&e.playmodes.includes(this.state.playMode)))),e){case"online":return t.filter(e=>e.is_online);case"offline":return t.filter(e=>!e.is_online);default:return t}}renderPlaymodeFilter(){const e=d.map(e=>r.createElement("button",{key:e,className:osu.classWithModifiers("user-list__view-mode",this.state.playMode===e?["active"]:[]),"data-value":e,onClick:this.playmodeSelected,title:osu.trans(`beatmaps.mode.${e}`)},"all"===e?r.createElement("span",null,osu.trans("beatmaps.mode.all")):r.createElement("span",{className:`fal fa-extra-mode-${e}`})));return r.createElement("div",{className:"user-list__view-modes"},r.createElement("span",{className:"user-list__view-mode-title"},osu.trans("users.filtering.by_game_mode"))," ",e)}}}).call(this,s("dMdw"),s("5wds"))},UUa0:function(e,t,s){"use strict";s.d(t,"a",(function(){return a}));var o=s("jbZF"),i=s("Hs9Z"),n=s("dqUM"),r=s("/G9H");class a extends r.PureComponent{constructor(){super(...arguments),this.state={forceShow:!1},this.handleClick=()=>{this.setState({forceShow:!this.state.forceShow})}}render(){const e=Object(i.find)(currentUser.blocks,{target_id:this.props.user.id});let t;const s=["full"];return e&&!this.state.forceShow&&(t="osu-layout__no-scroll",s.push("masked")),r.createElement("div",{className:t},e&&this.renderBanner(),r.createElement("div",{className:osu.classWithModifiers("osu-layout",s)},this.props.children))}renderBanner(){const e=r.createElement("div",{className:"grid-items grid-items--notification-banner-buttons"},r.createElement("div",null,r.createElement(o.a,{userId:this.props.user.id})),r.createElement("div",null,r.createElement("button",{className:"textual-button",onClick:this.handleClick,type:"button"},r.createElement("span",null,r.createElement("i",{className:"textual-button__icon fas fa-low-vision"})," ",this.state.forceShow?osu.trans("users.blocks.hide_profile"):osu.trans("users.blocks.show_profile")))));return r.createElement("div",{className:"osu-page"},r.createElement(n.a,{message:e,title:osu.trans("users.blocks.banner_text"),type:"warning"}))}}},UVl7:function(e,t,s){"use strict";(function(e,o){s.d(t,"a",(function(){return S}));var i,n,r,a,l,c,u=s("f7bm"),d=s("2b+G"),p=s("O0zI"),h=s("4PZ6"),m=s("cF9b"),f=s("f4vq"),b=s("/G9H"),v=s("I8Ok"),y=s("hc33"),g=s("Ncbg"),_=s("PPOh"),w=s("TY2o"),E=s("tX/w"),O=s("jUJ3"),j=s("phBA"),k=function(e,t){return function(){return e.apply(t,arguments)}},N={}.hasOwnProperty;r=b.createElement,n={username:osu.trans("users.deleted")},i=f.a.dataStore.commentableMetaStore,a=f.a.dataStore.commentStore,c=f.a.dataStore.userStore,l=f.a.dataStore.uiState;var S=function(t){var s,S,T;function P(e){var t,o;this.toggleClip=k(this.toggleClip,this),this.toggleReplies=k(this.toggleReplies,this),this.closeNewReply=k(this.closeNewReply,this),this.voteToggle=k(this.voteToggle,this),this.toggleNewReply=k(this.toggleNewReply,this),this.restore=k(this.restore,this),this.userFor=k(this.userFor,this),this.parentLink=k(this.parentLink,this),this.loadReplies=k(this.loadReplies,this),this.closeEdit=k(this.closeEdit,this),this.toggleEdit=k(this.toggleEdit,this),this.handleReplyPosted=k(this.handleReplyPosted,this),this.togglePinned=k(this.togglePinned,this),this.delete=k(this.delete,this),this.hasVoted=k(this.hasVoted,this),this.renderToolbar=k(this.renderToolbar,this),this.renderCommentableMeta=k(this.renderCommentableMeta,this),this.renderVoteButton=k(this.renderVoteButton,this),this.renderUsername=k(this.renderUsername,this),this.renderUserAvatar=k(this.renderUserAvatar,this),this.renderToggleClipButton=k(this.renderToggleClipButton,this),this.renderRestore=k(this.renderRestore,this),this.renderReport=k(this.renderReport,this),this.renderReplyButton=k(this.renderReplyButton,this),this.renderReplyBox=k(this.renderReplyBox,this),this.renderRepliesToggle=k(this.renderRepliesToggle,this),this.renderRepliesText=k(this.renderRepliesText,this),this.renderPermalink=k(this.renderPermalink,this),this.renderOwnerBadge=k(this.renderOwnerBadge,this),this.renderEditedBy=k(this.renderEditedBy,this),this.renderEdit=k(this.renderEdit,this),this.renderPin=k(this.renderPin,this),this.renderDelete=k(this.renderDelete,this),this.renderComment=k(this.renderComment,this),this.render=k(this.render,this),this.componentDidUpdate=k(this.componentDidUpdate,this),this.componentDidMount=k(this.componentDidMount,this),this.componentWillUnmount=k(this.componentWillUnmount,this),P.__super__.constructor.call(this,e),this.xhr={},this.loadMoreRef=b.createRef(),o=!osu.isMobile()&&(!this.props.comment.isDeleted&&(null!=this.props.expandReplies?this.props.expandReplies:(null!=(t=l.getOrderedCommentsByParentId(this.props.comment.id))?t.length:void 0)>0&&this.props.depth<s)),this.state={clipped:!0,postingVote:!1,editing:!1,showNewReply:!1,expandReplies:o,lines:null}}return function(e,t){for(var s in t)N.call(t,s)&&(e[s]=t[s]);function o(){this.constructor=e}o.prototype=t.prototype,e.prototype=new o,e.__super__=t.prototype}(P,t),7,s=6,T=document.createElement("div"),S=function(t){return t.isDeleted?osu.trans("comments.deleted"):(T.innerHTML=t.messageHtml,e.truncate(T.textContent,{length:100}))},P.prototype.componentWillUnmount=function(){var e,t,s,o;for(e in s=[],t=this.xhr)N.call(t,e)&&(o=t[e],s.push(null!=o?o.abort():void 0));return s},P.prototype.componentDidMount=function(){return this.setState({lines:Object(O.a)(this.props.comment.messageHtml)})},P.prototype.componentDidUpdate=function(e){if(e.comment.messageHtml!==this.props.comment.messageHtml)return this.setState({lines:Object(O.a)(this.props.comment.messageHtml)})},P.prototype.render=function(){return r(m.a,null,(e=this,function(){var t,o,n,c,u,m,f,y,g,_;return e.children=null!=(m=l.getOrderedCommentsByParentId(e.props.comment.id))?m:[],u=a.comments.get(e.props.comment.parentId),_=e.userFor(e.props.comment),n=i.get(e.props.comment.commentableType,e.props.comment.commentableId),t=null!=e.state.lines&&e.state.lines.count>=9,c=null!=(f=null!=(y=e.props.modifiers)?y.slice(0):void 0)?f:[],0===e.props.depth&&c.push("top"),o=[],e.props.comment.isDeleted&&o.push("deleted"),e.state.clipped&&t&&o.push("clip"),g="comment__replies",e.props.depth<s&&(g+=" comment__replies--indented"),e.state.expandReplies||(g+=" comment__replies--hidden"),Object(v.div)({className:osu.classWithModifiers("comment",c)},e.renderRepliesToggle(),e.renderCommentableMeta(n),e.renderToolbar(),Object(v.div)({className:osu.classWithModifiers("comment__main",o),style:{"--line-height":null!=e.state.lines?e.state.lines.lineHeight+"px":void 0,"--clip-lines":7}},e.props.comment.canHaveVote?Object(v.div)({className:"comment__float-container comment__float-container--left hidden-xs"},e.renderVoteButton()):void 0,e.renderUserAvatar(_),Object(v.div)({className:"comment__container"},Object(v.div)({className:"comment__row comment__row--header"},e.renderUsername(_),e.renderOwnerBadge(n),e.props.comment.pinned?Object(v.span)({className:"comment__row-item  comment__row-item--pinned"},Object(v.span)({className:"fa fa-thumbtack"})," ",osu.trans("comments.pinned")):void 0,null!=u?Object(v.span)({className:"comment__row-item comment__row-item--parent"},e.parentLink(u)):void 0,e.props.comment.isDeleted?Object(v.span)({className:"comment__row-item comment__row-item--deleted"},osu.trans("comments.deleted")):void 0),e.state.editing?Object(v.div)({className:"comment__editor"},r(d.a,{id:e.props.comment.id,message:e.props.comment.message,modifiers:e.props.modifiers,close:e.closeEdit})):null!=e.props.comment.messageHtml?r(b.Fragment,null,Object(v.div)({className:"comment__message",dangerouslySetInnerHTML:{__html:e.props.comment.messageHtml}}),t?e.renderToggleClipButton():void 0):void 0,Object(v.div)({className:"comment__row comment__row--footer"},e.props.comment.canHaveVote?Object(v.div)({className:"comment__row-item visible-xs"},e.renderVoteButton(!0)):void 0,Object(v.div)({className:"comment__row-item comment__row-item--info",dangerouslySetInnerHTML:{__html:osu.timeago(e.props.comment.createdAt)}}),e.renderPermalink(),e.renderReplyButton(),e.renderEdit(),e.renderRestore(),e.renderDelete(),e.renderPin(),e.renderReport(),e.renderEditedBy(),e.renderRepliesText()),e.renderReplyBox())),e.props.comment.repliesCount>0?Object(v.div)({className:g},e.children.map(e.renderComment),r(h.a,{comments:e.children}),r(p.a,{parent:e.props.comment,comments:e.children,total:e.props.comment.repliesCount,modifiers:e.props.modifiers,label:0===e.children.length?osu.trans("comments.load_replies"):void 0,ref:e.loadMoreRef})):void 0)}));var e},P.prototype.renderComment=function(e){return(e=a.comments.get(e.id)).isDeleted&&!l.comments.isShowDeleted?null:r(P,{key:e.id,comment:e,depth:this.props.depth+1,parent:this.props.comment,modifiers:this.props.modifiers,expandReplies:this.props.expandReplies})},P.prototype.renderDelete=function(){if(!this.props.comment.isDeleted&&this.props.comment.canDelete)return Object(v.div)({className:"comment__row-item"},Object(v.button)({type:"button",className:"comment__action",onClick:this.delete},osu.trans("common.buttons.delete")))},P.prototype.renderPin=function(){if(this.props.comment.canPin)return Object(v.div)({className:"comment__row-item"},Object(v.button)({type:"button",className:"comment__action",onClick:this.togglePinned},osu.trans("common.buttons."+(this.props.comment.pinned?"unpin":"pin"))))},P.prototype.renderEdit=function(){if(this.props.comment.canEdit)return Object(v.div)({className:"comment__row-item"},Object(v.button)({type:"button",className:"comment__action "+(this.state.editing?"comment__action--active":""),onClick:this.toggleEdit},osu.trans("common.buttons.edit")))},P.prototype.renderEditedBy=function(){var t;if(!this.props.comment.isDeleted&&this.props.comment.isEdited)return t=c.get(this.props.comment.editedById),Object(v.div)({className:"comment__row-item comment__row-item--info",dangerouslySetInnerHTML:{__html:osu.trans("comments.edited",{timeago:osu.timeago(this.props.comment.editedAt),user:null!=t.id?osu.link(laroute.route("users.show",{user:t.id}),t.username):e.escape(t.username)})}})},P.prototype.renderOwnerBadge=function(e){return this.props.comment.userId!==e.owner_id?null:Object(v.div)({className:"comment__row-item"},Object(v.div)({className:"comment__owner-badge"},e.owner_title))},P.prototype.renderPermalink=function(){return Object(v.div)({className:"comment__row-item"},Object(v.span)({className:"comment__action comment__action--permalink"},r(u.a,{value:laroute.route("comments.show",{comment:this.props.comment.id}),label:osu.trans("common.buttons.permalink"),valueAsUrl:!0})))},P.prototype.renderRepliesText=function(){var e,t;if(0!==this.props.comment.repliesCount)return this.state.expandReplies||0!==this.children.length?(e=this.toggleReplies,t=osu.transChoice("comments.replies_count",this.props.comment.repliesCount)):(e=this.loadReplies,t=osu.trans("comments.load_replies")),Object(v.div)({className:"comment__row-item comment__row-item--replies"},r(g.a,{direction:this.state.expandReplies?"up":"down",hasMore:!0,label:t,callback:e,modifiers:["comment-replies"]}))},P.prototype.renderRepliesToggle=function(){if(0===this.props.depth&&this.children.length>0)return Object(v.div)({className:"comment__float-container comment__float-container--right"},Object(v.button)({className:"comment__top-show-replies",type:"button",onClick:this.toggleReplies},Object(v.span)({className:"fas "+(this.state.expandReplies?"fa-angle-up":"fa-angle-down")})))},P.prototype.renderReplyBox=function(){if(this.state.showNewReply)return Object(v.div)({className:"comment__reply-box"},r(d.a,{close:this.closeNewReply,modifiers:this.props.modifiers,onPosted:this.handleReplyPosted,parent:this.props.comment}))},P.prototype.renderReplyButton=function(){if(!this.props.comment.isDeleted)return Object(v.div)({className:"comment__row-item"},Object(v.button)({type:"button",className:"comment__action "+(this.state.showNewReply?"comment__action--active":""),onClick:this.toggleNewReply},osu.trans("common.buttons.reply")))},P.prototype.renderReport=function(){if(this.props.comment.canReport)return Object(v.div)({className:"comment__row-item"},r(y.a,{className:"comment__action",reportableId:this.props.comment.id,reportableType:"comment",user:this.userFor(this.props.comment)}))},P.prototype.renderRestore=function(){if(this.props.comment.isDeleted&&this.props.comment.canRestore)return Object(v.div)({className:"comment__row-item"},Object(v.button)({type:"button",className:"comment__action",onClick:this.restore},osu.trans("common.buttons.restore")))},P.prototype.renderToggleClipButton=function(){return Object(v.button)({type:"button",className:"comment__toggle-clip",onClick:this.toggleClip},this.state.clipped?osu.trans("common.buttons.read_more"):osu.trans("common.buttons.show_less"))},P.prototype.renderUserAvatar=function(e){return null!=e.id?Object(v.a)({className:"comment__avatar js-usercard","data-user-id":e.id,href:laroute.route("users.show",{user:e.id})},r(w.a,{user:e,modifiers:["full-circle"]})):Object(v.span)({className:"comment__avatar"},r(w.a,{user:e,modifiers:["full-circle"]}))},P.prototype.renderUsername=function(e){return null!=e.id?Object(v.a)({"data-user-id":e.id,href:laroute.route("users.show",{user:e.id}),className:"js-usercard comment__row-item"},e.username):Object(v.span)({className:"comment__row-item"},e.username)},P.prototype.renderVoteButton=function(e){var t,s,o;return null==e&&(e=!1),s=this.hasVoted(),t=Object(E.a)("comment-vote",this.props.modifiers),t+=Object(E.a)("comment-vote",{disabled:!this.props.comment.canVote,inline:e,on:s,posting:this.state.postingVote},!0),e||s||(o=Object(v.div)({className:"comment-vote__hover"},"+1")),Object(v.button)({className:t,type:"button",onClick:this.voteToggle,disabled:this.state.postingVote||!this.props.comment.canVote},Object(v.span)({className:"comment-vote__text"},"+"+Object(j.b)(this.props.comment.votesCount,null,{maximumFractionDigits:1})),this.state.postingVote?Object(v.span)({className:"comment-vote__spinner"},r(_.a)):void 0,o)},P.prototype.renderCommentableMeta=function(e){var t,s;if(this.props.showCommentableMeta)return e.url?(t=v.a,s={href:e.url,className:"comment__link"}):(t=v.span,s=null),Object(v.div)({className:"comment__commentable-meta"},null!=this.props.comment.commentableType?Object(v.span)({className:"comment__commentable-meta-type"},Object(v.span)({className:"comment__commentable-meta-icon fas fa-comment"})," ",osu.trans("comments.commentable_name."+this.props.comment.commentableType)):void 0,t(s,e.title))},P.prototype.renderToolbar=function(){if(this.props.showToolbar)return Object(v.div)({className:"comment__toolbar"},Object(v.div)({className:"sort"},Object(v.div)({className:"sort__items"},Object(v.button)({type:"button",className:"sort__item sort__item--button",onClick:this.onShowDeletedToggleClick},Object(v.span)({className:"sort__item-icon"},Object(v.span)({className:l.comments.isShowDeleted?"fas fa-check-square":"far fa-square"})),osu.trans("common.buttons.show_deleted")))))},P.prototype.hasVoted=function(){return a.userVotes.has(this.props.comment.id)},P.prototype.delete=function(){var e;if(confirm(osu.trans("common.confirmation")))return null!=(e=this.xhr.delete)&&e.abort(),this.xhr.delete=o.ajax(laroute.route("comments.destroy",{comment:this.props.comment.id}),{method:"DELETE"}).done((function(e){return o.publish("comment:updated",e)})).fail((function(e,t){if("abort"!==t)return osu.ajaxError(e)}))},P.prototype.togglePinned=function(){var e;if(this.props.comment.canPin)return null!=(e=this.xhr.pin)&&e.abort(),this.xhr.pin=o.ajax(laroute.route("comments.pin",{comment:this.props.comment.id}),{method:this.props.comment.pinned?"DELETE":"POST"}).done((function(e){return o.publish("comment:updated",e)})).fail((function(e,t){if("abort"!==t)return osu.ajaxError(e)}))},P.prototype.handleReplyPosted=function(e){if("reply"===e)return this.setState({expandReplies:!0})},P.prototype.toggleEdit=function(){return this.setState({editing:!this.state.editing})},P.prototype.closeEdit=function(){return this.setState({editing:!1})},P.prototype.loadReplies=function(){var e;return null!=(e=this.loadMoreRef.current)&&e.load(),this.toggleReplies()},P.prototype.onShowDeletedToggleClick=function(){return o.publish("comments:toggle-show-deleted")},P.prototype.parentLink=function(e){var t,s;return s={title:S(e)},this.props.linkParent?(t=v.a,s.href=laroute.route("comments.show",{comment:e.id}),s.className="comment__link"):t=v.span,t(s,Object(v.span)({className:"fas fa-reply"})," ",this.userFor(e).username)},P.prototype.userFor=function(e){var t,s;return null!=(s=null!=(t=c.get(e.userId))?t.toJson():void 0)?s:null!=e.legacyName?{username:e.legacyName}:n},P.prototype.restore=function(){var e;return null!=(e=this.xhr.restore)&&e.abort(),this.xhr.restore=o.ajax(laroute.route("comments.restore",{comment:this.props.comment.id}),{method:"POST"}).done((function(e){return o.publish("comment:updated",e)})).fail((function(e,t){if("abort"!==t)return osu.ajaxError(e)}))},P.prototype.toggleNewReply=function(){return this.setState({showNewReply:!this.state.showNewReply})},P.prototype.voteToggle=function(e){var t,s,i,n,r;if(n=e.target,!f.a.userLogin.showIfGuest(Object(j.a)(n)))return this.setState({postingVote:!0}),this.hasVoted()?(t="DELETE",i="removeUserVote"):(t="POST",i="addUserVote"),null!=(s=this.xhr.vote)&&s.abort(),this.xhr.vote=o.ajax(laroute.route("comments.vote",{comment:this.props.comment.id}),{method:t}).always((r=this,function(){return r.setState({postingVote:!1})})).done(function(e){return function(t){return o.publish("comment:updated",t),a[i](e.props.comment)}}(this)).fail((function(e,t){if("abort"!==t)return 401===e.status?o(n).trigger("ajax:error",[e,t]):osu.ajaxError(e)}))},P.prototype.closeNewReply=function(){return this.setState({showNewReply:!1})},P.prototype.toggleReplies=function(){return this.setState({expandReplies:!this.state.expandReplies})},P.prototype.toggleClip=function(){return this.setState({clipped:!this.state.clipped})},P}(b.PureComponent)}).call(this,s("Hs9Z"),s("5wds"))},UZmH:function(e,t,s){"use strict";s.d(t,"a",(function(){return n}));var o=s("EaLk"),i=function(e,t,s,o){var i,n=arguments.length,r=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,s):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,s,o);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(r=(n<3?i(r):n>3?i(t,s,r):i(t,s))||r);return n>3&&r&&Object.defineProperty(t,s,r),r};class n{constructor(){this.beatmapsetIds=new Set,this.hasMore=!1,this.total=0}get hasMoreForPager(){return this.hasMore&&this.beatmapsetIds.size<this.total}get isExpired(){return null==this.fetchedAt||(new Date).getTime()-this.fetchedAt.getTime()>n.CACHE_DURATION_MS}append(e){for(const t of e.beatmapsets)this.beatmapsetIds.add(t.id);this.cursor=e.cursor,this.fetchedAt=new Date,this.hasMore=null!==e.cursor,this.total=e.total}reset(){this.beatmapsetIds.clear(),this.fetchedAt=void 0,this.cursor=void 0,this.hasMore=!1,this.total=0}}n.CACHE_DURATION_MS=6e4,i([o.m],n.prototype,"beatmapsetIds",void 0),i([o.m],n.prototype,"hasMore",void 0),i([o.m],n.prototype,"total",void 0),i([o.e],n.prototype,"hasMoreForPager",null),i([o.e],n.prototype,"isExpired",null),i([o.d],n.prototype,"append",null),i([o.d],n.prototype,"reset",null)},VEn2:function(e,t,s){"use strict";s.d(t,"a",(function(){return l}));var o=s("7EfK"),i=s("/G9H"),n=s("0h6b");class r extends i.Component{constructor(e){if(super(e),this.state={expanded:!1},this.stateRecord=null,this.recordState=()=>{null!=this.stateRecord&&(this.stateRecord.dataset[this.stateRecordKey]=this.state.expanded?"1":"")},this.renderPost=e=>{let t="news-sidebar-month__item";return null!=this.props.currentPost&&this.props.currentPost.id===e.id&&(t+=" news-sidebar-month__item--active"),i.createElement("li",{key:e.id},i.createElement("a",{className:t,href:Object(n.route)("news.show",{news:e.slug})},e.title))},this.toggleExpand=()=>{this.setState({expanded:!this.state.expanded},this.recordState)},osu.isMobile())this.state.expanded=!1;else if(null==e.currentPost)this.state.expanded=e.initialExpand;else{const t=o.utc(e.currentPost.published_at);this.state.expanded=t.year()===e.date.year()&&t.month()===e.date.month()}const t=document.querySelector(".js-news-sidebar-record");t instanceof HTMLElement&&(this.stateRecord=t),null==this.stateRecordValue?this.recordState():this.state.expanded=this.stateRecordValue}get stateRecordKey(){return this.props.date.format("YYYYMM")}get stateRecordValue(){return this.stateRecord instanceof HTMLElement&&null!=this.stateRecord.dataset[this.stateRecordKey]?"1"===this.stateRecord.dataset[this.stateRecordKey]:null}render(){return i.createElement("div",{className:"news-sidebar-month"},i.createElement("button",{className:"news-sidebar-month__toggle",onClick:this.toggleExpand,type:"button"},this.props.date.format(osu.trans("common.datetime.year_month_short.moment")),i.createElement("span",{className:"news-sidebar-month__toggle-icon"},i.createElement("i",{className:this.state.expanded?"fas fa-chevron-up":"fas fa-chevron-down"}))),i.createElement("ul",{className:`news-sidebar-month__items ${this.state.expanded?"":"hidden"}`},this.props.posts.map(this.renderPost)))}}function a(e){return i.createElement("div",{className:"news-sidebar-years"},e.years.map(t=>i.createElement("a",{key:t,className:`news-sidebar-years__item ${t===e.currentYear?"news-sidebar-years__item--active":""}`,href:Object(n.route)("news.index",{year:t})},t)))}function l(e){var t;const s={},n={},l=new Set;for(const i of e.data.news_posts){const e=o.utc(i.published_at),r=e.format("YYYY-MM");(s[r]=null!==(t=s[r])&&void 0!==t?t:[]).push(i),n[r]=e,l.add(r)}const c=[...l];c.sort().reverse();let u=!0;return i.createElement("div",{className:"sidebar"},i.createElement("button",{className:"sidebar__mobile-toggle sidebar__mobile-toggle--mobile-only js-mobile-toggle","data-mobile-toggle-target":"news-archive",type:"button"},i.createElement("h2",{className:"sidebar__title"},osu.trans("news.sidebar.archive")),i.createElement("div",{className:"sidebar__mobile-toggle-icon"},i.createElement("i",{className:"fas fa-chevron-down"}))),i.createElement("div",{className:"sidebar__content hidden-xs js-mobile-toggle","data-mobile-toggle-id":"news-archive"},i.createElement(a,{currentYear:e.data.current_year,years:e.data.years}),c.map(t=>{if(null==s[t]||null==n[t])return;const o=n[t],a=u;return u=!1,i.createElement(r,{key:t,currentPost:e.currentPost,date:o,initialExpand:a,posts:s[t]})})))}},VefT:function(e,t,s){"use strict";s.d(t,"a",(function(){return n}));var o=s("Hs9Z"),i=s("/G9H");const n=e=>{const t=osu.classWithModifiers("supporter-icon",e.modifiers);return i.createElement("span",{className:t,title:osu.trans("users.show.is_supporter")},Object(o.times)(e.level||1,e=>i.createElement("span",{key:e,className:"fas fa-heart"})))}},VsY1:function(e,t,s){"use strict";s.d(t,"a",(function(){return ie}));var o=s("va1x"),i=s("XvDi");class n{constructor(e){this.channelId=e}}var r=s("bpgk"),a=s("iRgH"),l=s("WLnA"),c=s("Hs9Z"),u=s("EaLk"),d=function(e,t,s,o){var i,n=arguments.length,r=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,s):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,s,o);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(r=(n<3?i(r):n>3?i(t,s,r):i(t,s))||r);return n>3&&r&&Object.defineProperty(t,s,r),r},p=function(e,t,s,o){return new(s||(s=Promise))((function(i,n){function r(e){try{l(o.next(e))}catch(t){n(t)}}function a(e){try{l(o.throw(e))}catch(t){n(t)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(r,a)}l((o=o.apply(e,t||[])).next())}))};let h=class{constructor(e){this.channelStore=e,this.autoScroll=!1,this.selectedBoxed=u.m.box(0),this.selectedIndex=0,e.channels.observe(e=>{"delete"===e.type&&this.refocusSelectedChannel()})}get selected(){return this.selectedBoxed.get()}set selected(e){this.selectedBoxed.set(e)}get selectedChannel(){return this.channelStore.get(this.selected)}flushStore(){this.selected=0,this.autoScroll=!1}handleDispatchAction(e){e instanceof i.a?this.autoScroll=!0:e instanceof n?this.handleChatNewConversationAdded(e):e instanceof r.b?this.flushStore():e instanceof a.b&&this.handleWindowFocusAction()}selectChannel(e){var t,s;return p(this,void 0,void 0,(function*(){if(this.selected===e)return;const o=this.channelStore.get(e);null!=o?(null===(s=null===(t=this.selectedChannel)||void 0===t?void 0:t.transient)||void 0===s||s||(this.autoScroll=!1),this.selected=e,this.selectedIndex=this.channelStore.channelList.indexOf(o),yield this.channelStore.loadChannel(e),this.channelStore.markAsRead(e)):console.error(`Trying to switch to non-existent channel ${e}`)}))}focusChannelAtIndex(e){const t=this.channelStore.channelList;if(0===t.length)return;const s=Object(c.clamp)(e,0,t.length-1),o=this.channelStore.channelList[s];this.selectChannel(o.channelId)}handleChatNewConversationAdded(e){this.selectChannel(e.channelId)}handleWindowFocusAction(){this.channelStore.markAsRead(this.selected)}refocusSelectedChannel(){null!=this.selectedChannel?this.selectChannel(this.selectedChannel.channelId):this.focusChannelAtIndex(this.selectedIndex)}};d([u.m],h.prototype,"autoScroll",void 0),d([u.m],h.prototype,"selectedBoxed",void 0),d([u.e],h.prototype,"selected",null),d([u.e],h.prototype,"selectedChannel",null),d([u.d],h.prototype,"flushStore",null),d([u.d],h.prototype,"selectChannel",null),d([u.d],h.prototype,"focusChannelAtIndex",null),d([u.d],h.prototype,"handleChatNewConversationAdded",null),d([u.d],h.prototype,"handleWindowFocusAction",null),d([u.d],h.prototype,"refocusSelectedChannel",null);var m=h=d([l.b],h),f=function(e,t,s,o){var i,n=arguments.length,r=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,s):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,s,o);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(r=(n<3?i(r):n>3?i(t,s,r):i(t,s))||r);return n>3&&r&&Object.defineProperty(t,s,r),r};class b{constructor(){this.beatmapsets=u.m.map()}get(e){return this.beatmapsets.get(e)}handleDispatchAction(e){(e instanceof r.a||e instanceof r.b)&&this.flushStore()}update(e){this.beatmapsets.set(e.id,e)}flushStore(){this.beatmapsets.clear()}}f([u.m],b.prototype,"beatmapsets",void 0),f([u.d],b.prototype,"update",null),f([u.d],b.prototype,"flushStore",null);var v=s("bfq+"),y=s("sTr9"),g=s("d+cC"),_=s("f4vq"),w=function(e,t,s,o){var i,n=arguments.length,r=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,s):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,s,o);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(r=(n<3?i(r):n>3?i(t,s,r):i(t,s))||r);return n>3&&r&&Object.defineProperty(t,s,r),r},E=function(e,t,s,o){return new(s||(s=Promise))((function(i,n){function r(e){try{l(o.next(e))}catch(t){n(t)}}function a(e){try{l(o.throw(e))}catch(t){n(t)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(r,a)}l((o=o.apply(e,t||[])).next())}))};let O=class{constructor(e){this.userStore=e,this.channels=u.m.map(),this.lastPolledMessageId=0,this.loaded=!1,this.api=new v.a,this.markingAsRead={}}get channelList(){return[...this.nonPmChannels,...this.pmChannels]}get nonPmChannels(){const e=[];return this.channels.forEach(t=>{"PM"!==t.type&&t.isDisplayable&&e.push(t)}),e.sort((e,t)=>e.name===t.name?0:e.name>t.name?-1:1)}get pmChannels(){const e=[];return this.channels.forEach(t=>{(t.newPmChannel||"PM"===t.type&&t.isDisplayable)&&e.push(t)}),e.sort((e,t)=>e.newPmChannel?-1:t.newPmChannel?1:e.lastMessageId===t.lastMessageId?0:e.lastMessageId>t.lastMessageId?-1:1)}addNewConversation(e,t){const s=this.getOrCreate(e.channel_id);return s.updateWithJson(e),s.newPmChannelTransient=!0,this.handleChatChannelNewMessages(s.channelId,[t]),s}findPM(e){var t;if(e===(null===(t=_.a.currentUser)||void 0===t?void 0:t.id))return null;for(const[,s]of this.channels)if("PM"===s.type&&s.users.includes(e))return s;return null}flushStore(){this.channels.clear(),this.loaded=!1}get(e){return this.channels.get(e)}getOrCreate(e){let t=this.channels.get(e);return t||(t=new y.a(e),this.channels.set(e,t)),t}handleDispatchAction(e){e instanceof i.a?this.handleChatMessageSendAction(e):e instanceof r.b&&this.handleUserLogoutAction(e)}loadChannel(e){return E(this,void 0,void 0,(function*(){const t=this.getOrCreate(e);if(!t.loading&&!t.newPmChannel&&!t.loaded){t.loading=!0;try{const s=yield this.api.getMessages(e);this.handleChatChannelNewMessages(e,s)}finally{Object(u.o)(()=>{t.loading=!1})}}}))}loadChannelEarlierMessages(e){return E(this,void 0,void 0,(function*(){const t=this.get(e);if(null==t||!t.hasEarlierMessages||t.loadingEarlierMessages)return;let s;t.loadingEarlierMessages=!0,t.minMessageId>0&&(s=t.minMessageId);try{const o=yield this.api.getMessages(t.channelId,{until:s});this.handleChatChannelNewMessages(e,o)}finally{Object(u.o)(()=>{t.loadingEarlierMessages=!1})}}))}markAsRead(e){const t=this.get(e);if(null==t||!t.isUnread)return;if(null!=this.markingAsRead[e])return;t.markAsRead();const s=window.setTimeout(()=>{var o;this.markingAsRead[e]===s&&delete this.markingAsRead[e],(null===(o=t.lastMessage)||void 0===o?void 0:o.sender.id)!==window.currentUser.id&&this.api.markAsRead(t.channelId,t.lastMessageId)},1e3);this.markingAsRead[e]=s}partChannel(e){e>0&&this.api.partChannel(e,window.currentUser.id),this.channels.delete(e)}updateWithJson(e){var t,s;this.updateWithPresence(e.presence),this.lastPolledMessageId=null!==(s=null===(t=Object(c.maxBy)(e.messages,"message_id"))||void 0===t?void 0:t.message_id)&&void 0!==s?s:this.lastPolledMessageId;const o=Object(c.groupBy)(e.messages,"channel_id");for(const n of Object.keys(o)){const e=parseInt(n,10);this.handleChatChannelNewMessages(e,o[e])}const i=new Set(e.silences.map(e=>e.user_id));this.removePublicMessagesFromUserIds(i)}updateWithPresence(e){e.forEach(e=>{this.getOrCreate(e.channel_id).updatePresence(e)}),this.channels.forEach(t=>{t.newPmChannel||t.newPmChannelTransient||e.find(e=>e.channel_id===t.channelId)||this.channels.delete(t.channelId)}),this.loaded=!0}handleChatChannelNewMessages(e,t){const s=t.map(e=>(null!=e.sender&&this.userStore.getOrCreate(e.sender_id,e.sender),g.a.fromJson(e))),o=this.channels.get(e);null!=o&&(0!==s.length?(o.addMessages(s),o.loaded=!0):o.firstMessageId=o.minMessageId)}handleChatMessageSendAction(e){return E(this,void 0,void 0,(function*(){const t=e.message,s=this.getOrCreate(t.channelId);s.addMessages([t],!0),s.markAsRead();try{if(s.newPmChannel){const e=s.users.slice().find(e=>e!==currentUser.id);if(null==e)return void console.debug("sendMessage:: userId not found?? this shouldn't happen");const o=yield this.api.newConversation(e,t);Object(u.o)(()=>{this.channels.delete(t.channelId);const e=this.addNewConversation(o.channel,o.message);Object(l.a)(new n(e.channelId))})}else{const e=yield this.api.sendMessage(t);s.afterSendMesssage(t,e)}}catch(o){s.afterSendMesssage(t,null),osu.ajaxError(o)}}))}handleUserLogoutAction(e){this.flushStore()}removePublicMessagesFromUserIds(e){this.nonPmChannels.forEach(t=>{t.removeMessagesFromUserIds(e)})}};w([u.m],O.prototype,"channels",void 0),w([u.m],O.prototype,"loaded",void 0),w([u.e],O.prototype,"channelList",null),w([u.e],O.prototype,"nonPmChannels",null),w([u.e],O.prototype,"pmChannels",null),w([u.d],O.prototype,"addNewConversation",null),w([u.d],O.prototype,"flushStore",null),w([u.d],O.prototype,"getOrCreate",null),w([u.d],O.prototype,"loadChannel",null),w([u.d],O.prototype,"loadChannelEarlierMessages",null),w([u.d],O.prototype,"markAsRead",null),w([u.d],O.prototype,"partChannel",null),w([u.d],O.prototype,"updateWithJson",null),w([u.d],O.prototype,"updateWithPresence",null),w([u.d],O.prototype,"handleChatChannelNewMessages",null),w([u.d],O.prototype,"handleChatMessageSendAction",null),w([u.d],O.prototype,"handleUserLogoutAction",null),w([u.d],O.prototype,"removePublicMessagesFromUserIds",null);var j=O=w([l.b],O),k=s("Cfan"),N=function(e,t,s,o){var i,n=arguments.length,r=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,s):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,s,o);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(r=(n<3?i(r):n>3?i(t,s,r):i(t,s))||r);return n>3&&r&&Object.defineProperty(t,s,r),r};class S{constructor(){this.clients=new Map}handleDispatchAction(e){(e instanceof r.a||e instanceof r.b)&&this.flushStore()}initialize(e){for(const t of e){const e=new k.a(t);this.clients.set(e.id,e)}}flushStore(){this.clients.clear()}}N([u.m],S.prototype,"clients",void 0),N([u.d],S.prototype,"flushStore",null);var T=s("fxEp"),P=function(e,t,s,o){var i,n=arguments.length,r=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,s):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,s,o);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(r=(n<3?i(r):n>3?i(t,s,r):i(t,s))||r);return n>3&&r&&Object.defineProperty(t,s,r),r};class C{constructor(){this.comments=u.m.map(),this.userVotes=new Set,this.groupedByParentId={}}addUserVote(e){this.userVotes.add(e.id)}addVoted(e){null!=e&&e.forEach(e=>this.userVotes.add(e))}flushStore(){this.invalidate(),this.comments.clear(),this.userVotes.clear()}getRepliesByParentId(e){return this.groupedByParentId[String(e)]}handleDispatchAction(e){e instanceof r.b&&this.flushStore()}initialize(e,t){this.flushStore(),this.addVoted(t),this.updateWithJson(e)}removeUserVote(e){this.userVotes.delete(e.id)}updateWithJson(e){if(null!=e)for(const t of e){const e=new T.a(t),s=this.comments.has(e.id);if(this.comments.set(e.id,e),!s){const t=String(e.parentId);null!=this.groupedByParentId[t]?this.groupedByParentId[t].push(e):this.groupedByParentId[t]=[e]}}}invalidate(){this.groupedByParentId={}}}P([u.m],C.prototype,"comments",void 0),P([u.m],C.prototype,"userVotes",void 0),P([u.d],C.prototype,"addUserVote",null),P([u.d],C.prototype,"addVoted",null),P([u.d],C.prototype,"flushStore",null),P([u.d],C.prototype,"initialize",null),P([u.d],C.prototype,"removeUserVote",null),P([u.d],C.prototype,"updateWithJson",null);var x=function(e,t,s,o){var i,n=arguments.length,r=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,s):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,s,o);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(r=(n<3?i(r):n>3?i(t,s,r):i(t,s))||r);return n>3&&r&&Object.defineProperty(t,s,r),r};class D{constructor(){this.meta=u.m.map()}flushStore(){this.meta.clear()}get(e,t){const s=this.meta.get(`${e}-${t}`);return null!=s?s:this.meta.get(null)}handleDispatchAction(e){e instanceof r.b&&this.flushStore()}initialize(e){this.flushStore(),this.updateWithJson(e)}updateWithJson(e){if(null!=e)for(const t of e){const e=null!=t.type&&null!=t.id?`${t.type}-${t.id}`:null;this.meta.set(e,t)}}}x([u.m],D.prototype,"meta",void 0),x([u.d],D.prototype,"flushStore",null),x([u.d],D.prototype,"initialize",null),x([u.d],D.prototype,"updateWithJson",null);var M=s("uW+8"),R=s("nxXY"),I=s("3Zv4"),H=s("y2EG"),A=s("5evE"),U=function(e,t,s,o){var i,n=arguments.length,r=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,s):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,s,o);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(r=(n<3?i(r):n>3?i(t,s,r):i(t,s))||r);return n>3&&r&&Object.defineProperty(t,s,r),r};class B{constructor(e,t,s,o){this.objectId=e,this.objectType=t,this.category=s,this.resolver=o,this.cursor=null,this.displayOrder=0,this.isDeleting=!1,this.isLoading=!1,this.isMarkingAsRead=!1,this.notifications=new Map,this.total=0,this.lastNotification=null}get canMarkAsRead(){for(const[,e]of this.notifications)if(e.canMarkRead)return!0;return!1}get first(){var e;return null!==(e=this.orderedNotifications[0])&&void 0!==e?e:this.lastNotification}get hasMore(){return!(this.notifications.size>=this.total||null==this.cursor)}get hasVisibleNotifications(){return this.notifications.size>0}get id(){return`${this.objectType}-${this.objectId}-${this.category}`}get identity(){return{category:this.category,objectId:this.objectId,objectType:this.objectType}}get isSingle(){return 1===this.total}get orderedNotifications(){return[...this.notifications.values()].sort((e,t)=>t.id-e.id)}get type(){return this.objectType}static fromJson(e,t){const s=new B(e.object_id,e.object_type,Object(A.a)(e.name),t);return s.updateWithJson(e),s}add(e){this.notifications.set(e.id,e),this.displayOrder=Math.max(e.id,this.displayOrder)}delete(){this.resolver.delete(this)}deleteItem(e){null!=e&&this.notifications.has(e.id)&&this.resolver.delete(e)}loadMore(e){null!=this.cursor&&(this.isLoading=!0,this.resolver.loadMore(this.identity,e,this.cursor).always(Object(u.d)(()=>{this.isLoading=!1})))}markAsRead(e){null!=e&&this.notifications.has(e.id)&&this.resolver.queueMarkAsRead(e)}markStackAsRead(){this.resolver.queueMarkAsRead(this)}remove(e){1===this.notifications.size&&(this.lastNotification=this.notifications.values().next().value);const t=this.notifications.delete(e.id);return t&&this.total--,t}updateWithJson(e){this.cursor=e.cursor,this.total=e.total}}U([u.m],B.prototype,"cursor",void 0),U([u.m],B.prototype,"displayOrder",void 0),U([u.m],B.prototype,"isDeleting",void 0),U([u.m],B.prototype,"isLoading",void 0),U([u.m],B.prototype,"isMarkingAsRead",void 0),U([u.m],B.prototype,"notifications",void 0),U([u.m],B.prototype,"total",void 0),U([u.m],B.prototype,"lastNotification",void 0),U([u.e],B.prototype,"canMarkAsRead",null),U([u.e],B.prototype,"first",null),U([u.e],B.prototype,"hasMore",null),U([u.e],B.prototype,"hasVisibleNotifications",null),U([u.e],B.prototype,"id",null),U([u.e],B.prototype,"isSingle",null),U([u.e],B.prototype,"orderedNotifications",null),U([u.d],B.prototype,"add",null),U([u.d],B.prototype,"delete",null),U([u.d],B.prototype,"deleteItem",null),U([u.d],B.prototype,"loadMore",null),U([u.d],B.prototype,"markAsRead",null),U([u.d],B.prototype,"markStackAsRead",null),U([u.d],B.prototype,"remove",null),U([u.d],B.prototype,"updateWithJson",null);var L=s("JlDh"),G=s("kiUL"),W=function(e,t,s,o){var i,n=arguments.length,r=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,s):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,s,o);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(r=(n<3?i(r):n>3?i(t,s,r):i(t,s))||r);return n>3&&r&&Object.defineProperty(t,s,r),r};let F=class{constructor(e){this.notificationStore=e,this.legacyPm=new I.a,this.types=new Map,this.deletedStacks=new Set,this.resolver=new G.a,this.removeByNotification=e=>{var t,s;if(null==e.id)return;const o=this.getStack(e),i=this.getOrCreateType(e),n=null==o?void 0:o.notifications.get(e.id);null==n?null!=o&&e.id<(null!==(s=null===(t=o.cursor)||void 0===t?void 0:t.id)&&void 0!==s?s:0)&&(this.total--,o.total--,i.total--):(null==o||o.remove(n),i.total--,this.total--)},this.getOrCreateType({objectType:null})}get allStacks(){return this.allType.stacks}get allType(){return this.getOrCreateType({objectType:null})}get isEmpty(){return 1===this.types.size&&0===this.allStacks.size}get total(){return this.allType.total}set total(e){this.allType.total=e}flushStore(){this.types.clear()}getOrCreateType(e){let t=this.types.get(e.objectType);return null==t&&(t=new L.a(e.objectType,this.resolver),this.types.set(t.name,t)),t}getStack(e){var t;return null===(t=this.types.get(e.objectType))||void 0===t?void 0:t.stacks.get(Object(R.c)(e))}handleDispatchAction(e){e instanceof M.a?this.handleNotificationEventDelete(e):e instanceof M.c?this.handleNotificationEventNew(e):e instanceof M.b?this.handleNotificationEventMoreLoaded(e):e instanceof M.d?this.handleNotificationEventRead(e):(e instanceof r.a||e instanceof r.b)&&this.flushStore()}handleNotificationEventDelete(e){this.removeByEvent(e)}handleNotificationEventMoreLoaded(e){e.context.isWidget||this.updateWithBundle(e.data)}handleNotificationEventNew(e){const t=e.data;let s=this.notificationStore.get(t.id);null==s?(s=H.a.fromJson(t),this.notificationStore.add(s)):s.updateFromJson(t);const o=s.identity,i=this.getOrCreateType(o);let n=this.getStack(o);null==n&&(n=new B(t.object_id,t.object_type,Object(A.a)(t.name),this.resolver)),n.notifications.has(s.id)||(n.total++,i.total++,this.total++),n.add(s),i.stacks.set(n.id,n),this.allStacks.set(n.id,n)}handleNotificationEventRead(e){}orderedStacksOfType(e){return this.stacksOfType(e).sort((e,t)=>t.displayOrder-e.displayOrder)}removeByEvent(e){for(const t of e.data){switch(Object(R.b)(t)){case"type":this.removeByType(t);break;case"stack":this.removeByStack(t,e.readCount);break;case"notification":this.removeByNotification(t)}}}stacksOfType(e){var t,s;const o=this.types.get(e),i=[];if(null==o)return i;const n=null!==(s=null===(t=o.cursor)||void 0===t?void 0:t.id)&&void 0!==s?s:0;for(const[,r]of o.stacks)void 0!==(null==o?void 0:o.cursor)&&r.displayOrder>=n&&i.push(r);return i}updateWithBundle(e){var t,s,o;null===(t=e.types)||void 0===t||t.forEach(e=>this.updateWithTypeJson(e)),null===(s=e.stacks)||void 0===s||s.forEach(e=>this.updateWithStackJson(e)),null===(o=e.notifications)||void 0===o||o.forEach(e=>this.updateWithNotificationJson(e))}removeByStack(e,t){const s=this.getStack(e),o=Object(R.c)(e);null!=s?(this.deletedStacks.add(o),this.allStacks.delete(o),this.total-=s.total,this.getOrCreateType(e).removeStack(s)):this.deletedStacks.has(o)||(this.deletedStacks.add(o),this.total-=t)}removeByType(e){const t=this.getOrCreateType(e);if(null===t.name){for(const[e,t]of this.types)null!==e&&this.removeType(t);t.total=0}else this.removeType(t)}removeType(e){e.stacks.forEach(e=>{this.allType.removeStack(e)}),e.total=0,this.types.delete(e.name)}updateWithNotificationJson(e){var t;let s=this.notificationStore.get(e.id);null==s?(s=H.a.fromJson(e),this.notificationStore.add(s)):s.updateFromJson(e),null===(t=this.getOrCreateType(s.identity).stacks.get(s.stackId))||void 0===t||t.add(s)}updateWithStackJson(e){const t=this.getOrCreateType(Object(R.a)(e));let s=t.stacks.get(function(e){return`${e.object_type}-${e.object_id}-${Object(A.a)(e.name)}`}(e));null==s?(s=B.fromJson(e,this.resolver),t.stacks.set(s.id,s),this.allType.stacks.set(s.id,s)):s.updateWithJson(e)}updateWithTypeJson(e){this.getOrCreateType({objectType:e.name}).updateWithJson(e)}};W([u.m],F.prototype,"legacyPm",void 0),W([u.m],F.prototype,"types",void 0),W([u.e],F.prototype,"total",null),W([u.d],F.prototype,"flushStore",null),W([u.d],F.prototype,"getOrCreateType",null),W([u.d],F.prototype,"handleDispatchAction",null),W([u.d],F.prototype,"handleNotificationEventDelete",null),W([u.d],F.prototype,"handleNotificationEventMoreLoaded",null),W([u.d],F.prototype,"handleNotificationEventNew",null),W([u.d],F.prototype,"handleNotificationEventRead",null),W([u.d],F.prototype,"removeByEvent",null),W([u.d],F.prototype,"updateWithBundle",null);var $=F=W([l.b],F),V=function(e,t,s,o){var i,n=arguments.length,r=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,s):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,s,o);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(r=(n<3?i(r):n>3?i(t,s,r):i(t,s))||r);return n>3&&r&&Object.defineProperty(t,s,r),r};let q=class extends ${get totalWithPm(){return this.total+this.legacyPm.count}handleNotificationEventMoreLoaded(e){e.context.isWidget&&this.updateWithBundle(e.data)}handleNotificationEventNew(e){e.data.is_read||super.handleNotificationEventNew(e)}handleNotificationEventRead(e){this.removeByEvent(e)}updateWithBundle(e){super.updateWithBundle(e),null!=e.unread_count&&(this.total=e.unread_count)}};V([u.e],q.prototype,"totalWithPm",null),V([u.d],q.prototype,"handleNotificationEventMoreLoaded",null),V([u.d],q.prototype,"handleNotificationEventNew",null),V([u.d],q.prototype,"handleNotificationEventRead",null),V([u.d],q.prototype,"updateWithBundle",null);var J=q=V([l.b],q),z=function(e,t,s,o){var i,n=arguments.length,r=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,s):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,s,o);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(r=(n<3?i(r):n>3?i(t,s,r):i(t,s))||r);return n>3&&r&&Object.defineProperty(t,s,r),r};let K=class{constructor(){this.notifications=new Map,this.stacks=new $(this),this.unreadStacks=new J(this)}add(e){this.notifications.set(e.id,e)}flushStore(){this.notifications.clear()}get(e){return this.notifications.get(e)}handleDispatchAction(e){e instanceof M.a?this.handleNotificationEventDelete(e):e instanceof M.d?this.handleNotificationEventRead(e):(e instanceof r.a||e instanceof r.b)&&this.flushStore()}handleNotificationEventDelete(e){this.eachByEvent(e,e=>{this.notifications.delete(e.id)})}handleNotificationEventRead(e){this.eachByEvent(e,e=>{e.isRead=!0})}eachByEvent(e,t){for(const s of e.data){switch(Object(R.b)(s)){case"type":this.eachByType(s,t);break;case"stack":this.eachByStack(s,t);break;case"notification":if(null==s.id)return;const e=this.get(s.id);null!=e&&t(e)}}}eachByStack(e,t){const s=Object(R.c)(e);this.notifications.forEach(e=>{e.stackId===s&&t(e)})}eachByType(e,t){this.notifications.forEach(s=>{null!=e.objectType&&s.objectType!==e.objectType||t(s)})}};z([u.m],K.prototype,"notifications",void 0),z([u.d],K.prototype,"add",null),z([u.d],K.prototype,"flushStore",null),z([u.d],K.prototype,"handleDispatchAction",null),z([u.d],K.prototype,"handleNotificationEventDelete",null),z([u.d],K.prototype,"handleNotificationEventRead",null);var Z=K=z([l.b],K),X=s("IfWv"),Q=function(e,t,s,o){var i,n=arguments.length,r=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,s):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,s,o);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(r=(n<3?i(r):n>3?i(t,s,r):i(t,s))||r);return n>3&&r&&Object.defineProperty(t,s,r),r};class Y{constructor(){this.clients=new Map}handleDispatchAction(e){(e instanceof r.a||e instanceof r.b)&&this.flushStore()}initialize(e){for(const t of e)this.updateWithJson(t)}updateWithJson(e){const t=new X.a(e);return this.clients.set(t.id,t),t}flushStore(){this.clients.clear()}}Q([u.m],Y.prototype,"clients",void 0),Q([u.d],Y.prototype,"updateWithJson",null),Q([u.d],Y.prototype,"flushStore",null);var ee=s("FIbR"),te=s("srn7"),se=function(e,t,s,o){var i,n=arguments.length,r=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,s):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,s,o);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(r=(n<3?i(r):n>3?i(t,s,r):i(t,s))||r);return n>3&&r&&Object.defineProperty(t,s,r),r};class oe{constructor(){this.users=u.m.map()}flushStore(){this.users=u.m.map()}get(e){return this.users.get(e)}getOrCreate(e,t){let s=this.users.get(e);return s&&s.loaded?s:(s=t?te.a.fromJson(t):new te.a(e),this.users.set(e,s),s.loaded||s.load(),s)}handleDispatchAction(e){e instanceof r.b&&this.flushStore()}updateWithJson(e){if(null!=e)for(const t of e){const e=te.a.fromJson(t);this.users.set(e.id,e)}}}se([u.m],oe.prototype,"users",void 0),se([u.d],oe.prototype,"flushStore",null),se([u.d],oe.prototype,"getOrCreate",null),se([u.d],oe.prototype,"updateWithJson",null);class ie{constructor(){this.beatmapsetStore=new b,this.beatmapsetSearch=new o.a(this.beatmapsetStore),this.clientStore=new S,this.commentableMetaStore=new D,this.commentStore=new C,this.notificationStore=new Z,this.ownClientStore=new Y,this.userStore=new oe,this.channelStore=new j(this.userStore),this.chatState=new m(this.channelStore),this.uiState=new ee.a(this.commentStore)}updateWithCommentBundleJson(e){this.commentableMetaStore.updateWithJson(e.commentable_meta),this.commentStore.updateWithJson(e.comments),this.commentStore.updateWithJson(e.included_comments),this.commentStore.updateWithJson(e.pinned_comments),this.userStore.updateWithJson(e.users),this.commentStore.addVoted(e.user_votes)}}(function(e,t,s,o){var i,n=arguments.length,r=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,s):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,s,o);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(r=(n<3?i(r):n>3?i(t,s,r):i(t,s))||r);n>3&&r&&Object.defineProperty(t,s,r)})([u.d],ie.prototype,"updateWithCommentBundleJson",null)},VxeA:function(e,t,s){"use strict";const o=Object.freeze({colour:"hsl(var(--hsl-l1))",id:-1,identifier:"owner",is_probationary:!1,name:"Beatmap Mapper",short_name:"MAPPER"});t.a=o},WD1s:function(e,t,s){"use strict";s.d(t,"a",(function(){return r}));var o=s("EaLk"),i=function(e,t,s,o){var i,n=arguments.length,r=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,s):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,s,o);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(r=(n<3?i(r):n>3?i(t,s,r):i(t,s))||r);return n>3&&r&&Object.defineProperty(t,s,r),r};const n=["extra","general","genre","language","mode","nsfw","played","query","rank","sort","status"];class r{constructor(e){var t;this.extra=null,this.general=null,this.genre=null,this.language=null,this.mode=null,this.nsfw=null,this.played=null,this.query=null,this.rank=null,this.sort=null,this.status=null;const s=BeatmapsetFilter.filtersFromUrl(e);for(const o of n)this[o]=null!==(t=s[o])&&void 0!==t?t:null;Object(o.i)(this,"query",e=>{var t;return e.newValue=osu.presence(null===(t=e.newValue)||void 0===t?void 0:t.trim()),e})}get displaySort(){return this.selectedValue("sort")}get queryParams(){const e=this.values;return BeatmapsetFilter.queryParamsFromFilters(e)}get searchSort(){const[e,t]=this.displaySort.split("_");return{field:e,order:t}}selectedValue(e){const t=this[e];return null==t?BeatmapsetFilter.getDefault(this.values,e):t}toKeyString(){const e=this.values,t=BeatmapsetFilter.fillDefaults(e),s=[];for(const o of n)s.push(`${o}=${t[o]}`);return s.join("&")}update(e){(void 0!==e.query&&e.query!==this.query||void 0!==e.status&&e.status!==this.status)&&(this.sort=null);for(const t of n){const s=e[t];void 0!==s&&(this[t]=s)}}get values(){return Object.assign({},this)}}i([o.m],r.prototype,"extra",void 0),i([o.m],r.prototype,"general",void 0),i([o.m],r.prototype,"genre",void 0),i([o.m],r.prototype,"language",void 0),i([o.m],r.prototype,"mode",void 0),i([o.m],r.prototype,"nsfw",void 0),i([o.m],r.prototype,"played",void 0),i([o.m],r.prototype,"query",void 0),i([o.m],r.prototype,"rank",void 0),i([o.m],r.prototype,"sort",void 0),i([o.m],r.prototype,"status",void 0),i([o.e],r.prototype,"displaySort",null),i([o.e],r.prototype,"queryParams",null),i([o.e],r.prototype,"searchSort",null),i([o.d],r.prototype,"update",null),i([o.e],r.prototype,"values",null)},WLnA:function(e,t,s){"use strict";s.d(t,"c",(function(){return o})),s.d(t,"a",(function(){return i})),s.d(t,"b",(function(){return n}));const o=new class{constructor(){this.listeners=new Set,this.trace=!1}dispatch(e){this.trace&&console.debug("Dispatcher::dispatch",e),this.listeners.forEach(t=>{t.handleDispatchAction(e)})}register(e){this.listeners.add(e)}unregister(e){this.listeners.delete(e)}};function i(e){o.dispatch(e)}function n(e){return class extends e{constructor(...e){var t;super(...e),"object"==typeof(t=this)&&null!=t&&"handleDispatchAction"in t&&o.register(this)}}}},XFVs:function(e,t,s){"use strict";s.d(t,"a",(function(){return a}));var o=s("0h6b"),i=s("7EfK"),n=s("/G9H"),r=s("mk7q");function a({modifiers:e,post:t}){let s;null!=t.first_image&&(s=n.createElement("img",{className:"news-card__cover",src:t.first_image}));let a=t.preview;return null==a&&(a=""),n.createElement("a",{className:osu.classWithModifiers("news-card",null!=e?e:["index","hover"]),href:Object(o.route)("news.show",{news:t.slug})},n.createElement("div",{className:"news-card__cover-container"},s,n.createElement("div",{className:"news-card__time js-tooltip-time",title:t.published_at},i.utc(t.published_at).format("ll"))),n.createElement("div",{className:"news-card__main"},n.createElement("div",{className:"news-card__row news-card__row--title"},t.title),n.createElement("div",{dangerouslySetInnerHTML:{__html:a},className:"news-card__row news-card__row--preview"}),n.createElement("div",{className:"news-card__row news-card__row--author"},n.createElement(r.a,{mappings:{":user":n.createElement("strong",{key:"author"},t.author)},pattern:osu.trans("news.show.by")}))))}},XMXc:function(e,t,s){"use strict";s.d(t,"a",(function(){return m}));var o=s("/G9H"),i=s("KHX3"),n=s("iH//");function r(){function e(e,t,s){const o=new RegExp(osu.urlRegex).exec(t);if(!o||0!==o.index)return;if(s)return!0;const[i,,n]=o;return e(i)({children:[{type:"text",value:n}],type:"link",url:i})}const t=this.Parser,s=t.prototype.inlineTokenizers,o=t.prototype.inlineMethods;e.locator=function(e,t){return e.indexOf("http",t)},s.link=e,o.unshift("link")}var a=s("Cy5r"),l=s("+AAq"),c=s("Y9Pv"),u=s("DHbW");const d=({data:e})=>{const t="beatmap-discussion-review-post-embed-preview",s=o.useContext(u.a),i=o.useContext(c.a),n=s[e.discussion_id];if(!n)return o.createElement("div",{className:osu.classWithModifiers(t,["deleted","lighter"])},o.createElement("div",{className:`${t}__missing`},osu.trans("beatmaps.discussions.review.embed.missing")));const r=null==n.beatmap_id?void 0:i[n.beatmap_id],a=["lighter"];"praise"===n.message_type?a.push("praise"):n.resolved&&a.push("resolved"),null!==n.beatmap_id||a.push("general-all"),n.deleted_at&&a.push("deleted");const d=()=>{if(n.parent_id)return o.createElement("div",{className:`${t}__link`},o.createElement("a",{className:`${t}__link-text js-beatmap-discussion--jump`,href:BeatmapDiscussionHelper.url({discussion:n}),title:osu.trans("beatmap_discussions.review.go_to_child")},o.createElement("i",{className:"fas fa-external-link-alt"})))};return o.createElement("div",{className:osu.classWithModifiers(t,a)},o.createElement("div",{className:`${t}__content`},o.createElement("div",{className:`${t}__selectors`},o.createElement("div",{className:"icon-dropdown-menu icon-dropdown-menu--disabled"},null!=r&&o.createElement(l.a,{beatmap:r}),!n.beatmap_id&&o.createElement("i",{className:"fas fa-fw fa-star-of-life",title:osu.trans("beatmaps.discussions.mode.scopes.generalAll")})),o.createElement("div",{className:"icon-dropdown-menu icon-dropdown-menu--disabled"},(()=>{const e=n.message_type;return o.createElement("div",{className:`beatmap-discussion-message-type beatmap-discussion-message-type--${e}`},o.createElement("i",{className:BeatmapDiscussionHelper.messageType.icon[e],title:osu.trans(`beatmaps.discussions.message_type.${e}`)}))})()),o.createElement("div",{className:`${t}__timestamp`},(()=>o.createElement("div",{className:`${t}__timestamp-text`},null!==n.timestamp?BeatmapDiscussionHelper.formatTimestamp(n.timestamp):osu.trans("beatmap_discussions.timestamp_display.general")))()),o.createElement("div",{className:`${t}__stripe`}),d()),o.createElement("div",{className:`${t}__stripe`}),o.createElement("div",{className:`${t}__message-container`},o.createElement("div",{className:`${t}__body`,dangerouslySetInnerHTML:{__html:BeatmapDiscussionHelper.format((n.starting_post||n.posts[0]).message)}})),d()))};var p=s("bucr");function h(){function e(e,t,s){const o=new RegExp(/^((\d{2,}:[0-5]\d[:.]\d{3})( \((?:\d[,|])*\d\))?)/).exec(t);if(!o)return;if(s)return!0;const[i,n]=o;return e(i)({children:[{type:"text",value:n}],href:p.a.openBeatmapEditor(n),type:"timestamp"})}const t=this.Parser,s=t.prototype.inlineTokenizers,o=t.prototype.inlineMethods;e.locator=function(e,t){const s=e.substr(t).search(/[0-9]{2}:/);return s<0?s:s+t},s.timestamp=e,o.unshift("timestamp")}class m extends o.Component{constructor(){super(...arguments),this.linkRenderer=e=>{const t=Object(n.b)(e.href);return o.createElement("a",Object.assign({},e,t))}}embed(e){return o.createElement("div",{key:osu.uuid(),className:"beatmap-discussion-review-post__block"},o.createElement(d,{data:{discussion_id:e}}))}paragraph(e){return o.createElement(i,{key:osu.uuid(),plugins:[[a.a,{allowedBlocks:["paragraph"],allowedInlines:["emphasis","strong"]}],r,h],renderers:{link:this.linkRenderer,paragraph:e=>o.createElement("div",{className:"beatmap-discussion-review-post__block"},o.createElement("div",Object.assign({className:"beatmapset-discussion-message"},e))),timestamp:e=>o.createElement("a",Object.assign({className:"beatmap-discussion-timestamp-decoration"},e))},source:e,unwrapDisallowed:!0})}render(){const e=[];try{JSON.parse(this.props.message).forEach(t=>{switch(t.type){case"paragraph":const s=""===t.text.trim()?"&nbsp;":t.text;e.push(this.paragraph(s));break;case"embed":t.discussion_id&&e.push(this.embed(t.discussion_id))}})}catch(t){e.push(o.createElement("div",{key:osu.uuid()},"[error parsing review]"))}return o.createElement("div",{className:"beatmap-discussion-review-post"},e)}}},XMjx:function(e,t,s){"use strict";s.d(t,"a",(function(){return r}));var o=s("SifC"),i=s("GhGe"),n=s("Cy5r");function r(e,t){let s;try{s=JSON.parse(e)}catch(c){return console.error("error parsing srcDoc"),[]}const r=i().use(o).use(n.a,{allowedBlocks:["paragraph"],allowedInlines:["emphasis","strong"]}),l=[];return s.forEach(e=>{switch(e.type){case"paragraph":if(osu.present(e.text.trim())){const t=r.parse(e.text);if(!t.children||t.children.length<1){console.error("children missing... ?");break}l.push({children:a(t.children),type:"paragraph"})}else l.push({children:[{text:""}],type:"paragraph"});break;case"embed":const s=e,o=t[s.discussion_id];if(null==o){console.error("unknown/external discussion referenced",s.discussion_id);break}l.push({beatmapId:o.beatmap_id,children:[{text:(o.starting_post||o.posts[0]).message}],discussionId:o.id,discussionType:o.message_type,timestamp:BeatmapDiscussionHelper.formatTimestamp(o.timestamp),type:"embed"});break;default:console.error("unknown block encountered",e)}}),l}function a(e,t){let s=[];const o=null!=t?t:{bold:!1,italic:!1};return e?(e.forEach(e=>{const t={bold:o.bold||"strong"===e.type,italic:o.italic||"emphasis"===e.type};if(Array.isArray(e.children))s=s.concat(a(e.children,t));else{const o={text:e.value||""};t.bold&&(o.bold=!0),t.italic&&(o.italic=!0),s.push(o)}}),s):[{text:""}]}},XPyy:function(e,t,s){"use strict";s.d(t,"b",(function(){return v})),s.d(t,"a",(function(){return y}));var o=s("jbZF"),i=s("jEEn"),n=s("L2k0"),r=s("FVE9"),a=s("0h6b"),l=s("Hs9Z"),c=s("C92G"),u=s("/G9H"),d=s("hc33"),p=s("PPOh"),h=s("VefT"),m=s("bQFK"),f=s("AJEZ"),b=s("tX/w");const v=["card","list","brick"];class y extends u.PureComponent{constructor(){super(...arguments),this.state={avatarLoaded:!1,backgroundLoaded:!1},this.onAvatarLoad=()=>{this.setState({avatarLoaded:!0})},this.onBackgroundLoad=()=>{this.setState({backgroundLoaded:!0})}}get canMessage(){return!this.isSelf&&null==l.find(currentUser.blocks,{target_id:this.user.id})}get isOnline(){return this.user.is_online}get isSelf(){return currentUser.id===this.user.id}get isUserLoaded(){return Number.isFinite(this.user.id)&&this.user.id>0}get isUserNotFound(){return-1===this.user.id}get isUserVisible(){return this.isUserLoaded&&!this.user.is_deleted}get user(){return this.props.user||y.userLoading}render(){if("brick"===this.props.mode)return null==this.props.user?null:u.createElement(m.a,Object.assign({},this.props,{user:this.props.user}));const e=this.props.modifiers.slice();return e.push(this.props.activated?"active":"highlightable"),e.push(this.props.mode),this.url=this.isUserVisible?Object(a.route)("users.show",{user:this.user.id}):void 0,u.createElement("div",{className:osu.classWithModifiers("user-card",e)},this.renderBackground(),u.createElement("div",{className:"user-card__card"},u.createElement("div",{className:"user-card__content user-card__content--details"},u.createElement("div",{className:"user-card__user"},this.renderAvatar()),u.createElement("div",{className:"user-card__details"},this.renderIcons(),u.createElement("div",{className:"user-card__username-row"},this.renderUsername(),u.createElement("div",{className:"user-card__group-badges"},u.createElement(f.a,{groups:this.user.groups,short:!0,wrapper:"user-card__group-badge"}))),this.renderListModeIcons())),this.renderStatusBar()))}renderAvatar(){const e={loaded:this.state.avatarLoaded},t=osu.present(this.user.avatar_url)&&!this.isUserNotFound;return u.createElement("div",{className:"user-card__avatar-space"},u.createElement("div",{className:Object(b.a)("user-card__avatar-spinner",e)},t&&u.createElement(p.a,{modifiers:e})),this.isUserLoaded&&t&&u.createElement("img",{className:Object(b.a)("user-card__avatar",e),onError:this.onAvatarLoad,onLoad:this.onAvatarLoad,src:this.user.avatar_url}))}renderBackground(){let e,t;const s=osu.classWithModifiers("user-card__background-overlay",this.isOnline?["online"]:[]);if(this.user.cover&&this.user.cover.url){let t="user-card__background";this.state.backgroundLoaded||(t+=" user-card__background--loading"),e=u.createElement(u.Fragment,null,u.createElement("img",{className:t,onLoad:this.onBackgroundLoad,src:this.user.cover.url}),u.createElement("div",{className:s}))}else e=u.createElement("div",{className:s});return t=this.isUserVisible?u.createElement("a",{className:"user-card__background-container",href:this.url},e):e}renderIcons(){return this.isUserVisible?u.createElement("div",{className:"user-card__icons"},u.createElement("a",{className:"user-card__icon user-card__icon--flag",href:Object(a.route)("rankings",{mode:"osu",type:"performance",country:this.user.country_code})},u.createElement(i.a,{country:this.user.country})),"card"===this.props.mode&&u.createElement(u.Fragment,null,this.user.is_supporter&&u.createElement("a",{className:"user-card__icon",href:Object(a.route)("support-the-game")},u.createElement(h.a,{modifiers:["user-card"]})),u.createElement("div",{className:"user-card__icon"},u.createElement(r.a,{modifiers:["user-card"],userId:this.user.id})),u.createElement("div",{className:"user-card__icon"},u.createElement(n.a,{modifiers:["user-card"],userId:this.user.id})))):null}renderListModeIcons(){return"list"===this.props.mode&&this.isUserVisible?u.createElement("div",{className:"user-card__icons"},this.user.is_supporter&&u.createElement("a",{className:"user-card__icon",href:Object(a.route)("support-the-game")},u.createElement(h.a,{level:this.user.support_level,modifiers:["user-list"]})),u.createElement("div",{className:"user-card__icon"},u.createElement(r.a,{modifiers:["user-list"],userId:this.user.id})),u.createElement("div",{className:"user-card__icon"},u.createElement(n.a,{modifiers:["user-list"],userId:this.user.id}))):null}renderMenuButton(){if(this.isSelf)return null;return u.createElement("div",{className:"user-card__icon user-card__icon--menu"},u.createElement(c.a,null,e=>u.createElement(u.Fragment,null,this.canMessage?u.createElement("a",{className:"simple-menu__item js-login-required--click",href:Object(a.route)("messages.users.show",{user:this.user.id}),onClick:e},u.createElement("span",{className:"fas fa-envelope"}),` ${osu.trans("users.card.send_message")}`):null,u.createElement(o.a,{modifiers:["inline"],onClick:e,userId:this.user.id,wrapperClass:"simple-menu__item"}),u.createElement(d.a,{className:"simple-menu__item",icon:!0,onFormClose:e,reportableId:this.user.id.toString(),reportableType:"user",user:this.user}))))}renderStatusBar(){if(!this.isUserVisible)return null;const e=this.isOnline||null==this.user.last_visit?"":osu.trans("users.show.lastvisit",{date:osu.timeago(this.user.last_visit)}),t=this.isOnline?osu.trans("users.status.online"):osu.trans("users.status.offline");return u.createElement("div",{className:"user-card__content user-card__content--status"},u.createElement("div",{className:"user-card__status"},this.renderStatusIcon(),u.createElement("div",{className:"user-card__status-messages"},u.createElement("span",{className:"user-card__status-message user-card__status-message--sub u-ellipsis-overflow",dangerouslySetInnerHTML:{__html:e}}),u.createElement("span",{className:"user-card__status-message u-ellipsis-overflow"},t))),u.createElement("div",{className:"user-card__icons user-card__icons--menu"},this.renderMenuButton()))}renderStatusIcon(){return this.isUserVisible?u.createElement("div",{className:"user-card__status-icon-container"},u.createElement("div",{className:`user-card__status-icon user-card__status-icon--${this.isOnline?"online":"offline"}`})):null}renderUsername(){const e=this.user.is_deleted?osu.trans("users.deleted"):this.user.username;return null==this.url?u.createElement("div",{className:"user-card__username u-ellipsis-pre-overflow"},e):u.createElement("a",{href:this.url,className:"user-card__username u-ellipsis-pre-overflow"},e)}}y.defaultProps={activated:!1,mode:"card",modifiers:[]},y.userLoading={avatar_url:"",country_code:"",cover:{},default_group:"",id:0,is_active:!1,is_bot:!1,is_deleted:!1,is_online:!1,is_supporter:!1,last_visit:"",pm_friends_only:!0,profile_colour:"",username:osu.trans("users.card.loading")}},XvDi:function(e,t,s){"use strict";s.d(t,"a",(function(){return o}));class o{constructor(e){this.message=e}}},Y9Pv:function(e,t,s){"use strict";s.d(t,"a",(function(){return i}));var o=s("/G9H");const i=o.createContext({})},Yin1:function(e,t,s){"use strict";s.d(t,"a",(function(){return n}));s("/G9H");var o,i=s("I8Ok");o="beatmap-discussion-message-length-counter";var n=function(e){var t,s,n;return n=e.message,e.isTimeline?(s=BeatmapDiscussionHelper.MAX_LENGTH_TIMELINE,t=o,n.length>s?t+=" "+o+"--over":n.length>.95*s&&(t+=" "+o+"--almost-over"),Object(i.div)({className:t},n.length+" / "+s)):null}},ZG74:function(e,t,s){"use strict";s.d(t,"c",(function(){return i})),s.d(t,"a",(function(){return n})),s.d(t,"b",(function(){return r}));var o=s("/G9H");function i(e){this.setState({activeKey:e})}const n=Object(o.createContext)({activeKeyDidChange:e=>{}}),r=Object(o.createContext)(null)},ZJc0:function(e,t,s){"use strict";s.d(t,"a",(function(){return n}));var o=s("/G9H"),i=s("tX/w");class n extends o.PureComponent{constructor(){super(...arguments),this.bn="circular-progress"}render(){const e=this.bn,t=Math.min(1,this.props.current/this.props.max);if(this.props.onlyShowAsWarning&&t<.75)return null;const s=this.props.ignoreProgress?void 0:{transform:`rotate(${t}turn)`};return o.createElement("div",{className:Object(i.a)(e,{over:1===t,over50:t>.5,warn:t>=.75&&t<1,[this.props.theme]:osu.present(this.props.theme)}),title:this.props.tooltip||`${this.props.current} / ${this.props.max}`},o.createElement("div",{className:`${e}__label`},this.props.max-this.props.current),o.createElement("div",{className:`${e}__slice`},o.createElement("div",{className:`${e}__circle`,style:s}),o.createElement("div",{className:`${e}__circle ${e}__circle--fill`})))}}n.defaultProps={ignoreProgress:!1,onlyShowAsWarning:!1,theme:""}},bQFK:function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return r}));var o=s("0h6b"),i=s("/G9H"),n=s("oQBk");class r extends i.PureComponent{constructor(){super(...arguments),this.eventId=`user-card-brick-${osu.uuid()}`,this.addFriendModifier=e=>{let t=!1,s=!1;if(null!=currentUser.friends){const e=currentUser.friends.find(e=>e.target_id===this.props.user.id);null!=e&&(t=!0,s=e.mutual)}s?e.push("mutual"):t&&!this.context.isFriendsPage&&e.push("friend")},this.refresh=()=>{this.forceUpdate()}}componentDidMount(){e.subscribe(`friendButton:refresh.${this.eventId}`,this.refresh)}componentWillUnmount(){e.unsubscribe(`.${this.eventId}`)}render(){var e,t,s;const n=this.props.modifiers.concat(this.props.mode);return this.addFriendModifier(n),i.createElement("a",{className:`js-usercard ${osu.classWithModifiers("user-card-brick",n)}`,"data-user-id":this.props.user.id,href:Object(o.route)("users.show",{user:this.props.user.id})},i.createElement("div",{className:"user-card-brick__group-bar",style:osu.groupColour(null===(e=this.props.user.groups)||void 0===e?void 0:e[0]),title:null===(s=null===(t=this.props.user.groups)||void 0===t?void 0:t[0])||void 0===s?void 0:s.name}),i.createElement("div",{className:"user-card-brick__username u-ellipsis-overflow"},this.props.user.username))}}r.contextType=n.a,r.defaultProps={mode:"brick",modifiers:[]}}).call(this,s("5wds"))},"bfq+":function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return i}));var o=s("0h6b");class i{getMessages(t,s){return e.get(Object(o.route)("chat.channels.messages.index",Object.assign({channel:t},s)))}getUpdates(t,s){return e.get(Object(o.route)("chat.updates"),{since:t,history_since:s})}markAsRead(t,s){return e.ajax({type:"PUT",url:Object(o.route)("chat.channels.mark-as-read",{channel:t,message:s})})}newConversation(t,s){return e.post(Object(o.route)("chat.new"),{is_action:s.isAction,message:s.content,target_id:t})}partChannel(t,s){return e.ajax(Object(o.route)("chat.channels.part",{channel:t,user:s}),{method:"DELETE"})}sendMessage(t){return e.post(Object(o.route)("chat.channels.messages.store",{channel:t.channelId}),{is_action:t.isAction,message:t.content,target_id:t.channelId,target_type:"channel"})}}}).call(this,s("5wds"))},bpgk:function(e,t,s){"use strict";s.d(t,"a",(function(){return o})),s.d(t,"b",(function(){return i}));class o{}class i{}},bucr:function(e,t,s){"use strict";s.d(t,"a",(function(){return n}));var o=s("0h6b"),i=s("Hs9Z");class n{static beatmapDownloadDirect(e){return`osu://b/${e}`}static beatmapsetDownloadDirect(e){return`osu://s/${e}`}static changelogBuild(e){return o.route("changelog.build",{stream:e.update_stream.name,build:e.version})}static isHTML(e){return e.isHTML()||i.startsWith(e.getPath(),"/home/changelog/")}static isInternal(e){return RegExp(`^/(?:${this.internalUrls})(?:$|/|#)`).test(e.getPath())}static openBeatmapEditor(e){return`osu://edit/${e}`}}n.internalUrls=["admin","api/v2","beatmaps","beatmapsets","client-verifications","comments","community","help","home","legal","multiplayer","oauth","rankings","session","store","users","wiki"].join("|")},cp7W:function(e,t,s){"use strict";function o(e){return null!=e.accuracy}s.d(t,"a",(function(){return o}))},"d+cC":function(e,t,s){"use strict";s.d(t,"a",(function(){return c}));var o=s("Hs9Z"),i=s("EaLk"),n=s("srn7"),r=s("7EfK"),a=s("f4vq"),l=function(e,t,s,o){var i,n=arguments.length,r=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,s):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,s,o);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(r=(n<3?i(r):n>3?i(t,s,r):i(t,s))||r);return n>3&&r&&Object.defineProperty(t,s,r),r};class c{constructor(){this.channelId=-1,this.content="",this.errored=!1,this.isAction=!1,this.messageId=osu.uuid(),this.persisted=!1,this.senderId=-1,this.timestamp=r().toISOString(),this.uuid=this.messageId}get parsedContent(){return osu.linkify(Object(o.escape)(this.content),!0)}get sender(){var e;return null!==(e=a.a.dataStore.userStore.get(this.senderId))&&void 0!==e?e:new n.a(-1)}static fromJson(e){const t=Object.create(c.prototype);return Object.assign(t,{channelId:e.channel_id,content:e.content,isAction:e.is_action,messageId:e.message_id,persisted:!0,senderId:e.sender_id,timestamp:e.timestamp,uuid:osu.uuid()})}persist(){return this.persisted=!0,this}}l([i.m],c.prototype,"channelId",void 0),l([i.m],c.prototype,"content",void 0),l([i.m],c.prototype,"errored",void 0),l([i.m],c.prototype,"isAction",void 0),l([i.m],c.prototype,"messageId",void 0),l([i.m],c.prototype,"persisted",void 0),l([i.m],c.prototype,"senderId",void 0),l([i.m],c.prototype,"timestamp",void 0),l([i.m],c.prototype,"uuid",void 0),l([i.e],c.prototype,"parsedContent",null),l([i.e],c.prototype,"sender",null),l([i.d],c.prototype,"persist",null)},dUQf:function(e,t,s){"use strict";const o={in:e=>{null==e||e.setAttribute("data-visibility","visible")},isVisible:e=>"hidden"!==(null==e?void 0:e.getAttribute("data-visibility")),out:e=>{null==e||e.setAttribute("data-visibility","hidden")},toggle:(e,t)=>{null!=e&&((t=null!=t?t:!o.isVisible(e))?o.in(e):o.out(e))}};t.a=o},dqUM:function(e,t,s){"use strict";(function(e,o){s.d(t,"a",(function(){return u}));var i,n,r=s("/G9H"),a=s("I8Ok"),l=function(e,t){return function(){return e.apply(t,arguments)}},c={}.hasOwnProperty;r.createElement,i="notification-banner-v2",n=document.getElementsByClassName("js-notification-banners");var u=function(t){function s(e){this.createPortalContainer=l(this.createPortalContainer,this),this.removePortalContainer=l(this.removePortalContainer,this),this.render=l(this.render,this),this.componentWillUnmount=l(this.componentWillUnmount,this),this.componentDidMount=l(this.componentDidMount,this),s.__super__.constructor.call(this,e),this.eventId="notification-banner-"+osu.uuid(),this.createPortalContainer()}return function(e,t){for(var s in t)c.call(t,s)&&(e[s]=t[s]);function o(){this.constructor=e}o.prototype=t.prototype,e.prototype=new o,e.__super__=t.prototype}(s,t),s.prototype.componentDidMount=function(){return e(document).on("turbolinks:before-cache."+this.eventId,this.removePortalContainer)},s.prototype.componentWillUnmount=function(){return e(document).off("."+this.eventId),this.removePortalContainer()},s.prototype.render=function(){var e;return e=Object(a.div)({className:i+" "+i+"--"+this.props.type},Object(a.div)({className:i+"__col "+i+"__col--icon"}),Object(a.div)({className:i+"__col "+i+"__col--label"},Object(a.div)({className:i+"__type"},this.props.type),Object(a.div)({className:i+"__text"},this.props.title)),Object(a.div)({className:i+"__col"},Object(a.div)({className:i+"__text"},this.props.message))),o.createPortal(e,this.portalContainer)},s.prototype.removePortalContainer=function(){return this.portalContainer.remove()},s.prototype.createPortalContainer=function(){return this.portalContainer=document.createElement("div"),n[0].appendChild(this.portalContainer)},s}(r.PureComponent)}).call(this,s("5wds"),s("WKXC"))},dxU0:function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return i}));const o="js-mobile-toggle--active";class i{constructor(){this.toggle=e=>{const t=e.currentTarget;if(!(t instanceof HTMLElement))return;const s=t.dataset.mobileToggleTarget;if(null==s)return;const i=document.querySelector(`.js-mobile-toggle[data-mobile-toggle-id=${s}]`);if(!(i instanceof HTMLElement))return;const n=!t.classList.contains(o);t.classList.toggle(o,n),i.classList.toggle("hidden-xs",!n)},e(document).on("click",".js-mobile-toggle",this.toggle)}}}).call(this,s("5wds"))},ed4P:function(e,t,s){"use strict";s.d(t,"a",(function(){return r}));var o=s("/G9H"),i=s("ZG74"),n=s("XPyy");class r extends o.PureComponent{constructor(){super(...arguments),this.activeKeyDidChange=i.c.bind(this),this.state={}}render(){const e=null!=this.state.activeKey?["menu-active"]:[];return e.push(this.props.viewMode),o.createElement(i.a.Provider,{value:{activeKeyDidChange:this.activeKeyDidChange}},o.createElement("div",{className:osu.classWithModifiers("user-cards",e)},this.props.users.map(e=>{const t=this.state.activeKey===e.id;return o.createElement(i.b.Provider,{key:e.id,value:e.id},o.createElement(n.a,{activated:t,mode:this.props.viewMode,modifiers:["has-outline",...this.props.modifiers],user:e}))})))}}r.defaultProps={modifiers:[]}},f4vq:function(e,t,s){"use strict";const o=new(s("BSzr").a);window.osuCore=o,t.a=o},f60u:function(e,t,s){"use strict";s.d(t,"a",(function(){return i}));var o=s("/G9H");function i(e){let t=osu.classWithModifiers("mod",e.modifiers);return t+=` mod--${e.mod}`,o.createElement("div",{className:t,title:osu.trans(`beatmaps.mods.${e.mod}`)})}},f7bm:function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return r}));var o=s("iBbO"),i=s("/G9H");const n="click-to-copy";class r extends i.Component{constructor(){super(...arguments),this.title=null,this.click=t=>{t.preventDefault();const s=t.currentTarget;null==this.api&&(this.api=e(s).qtip("api")),o.writeText(this.props.value),this.api.set("content.text",osu.trans("common.buttons.click_to_copy_copied")),window.clearTimeout(this.timer),this.timer=window.setTimeout(this.restoreTooltipText,1e3),null==this.title&&(this.title=s.getAttribute("title")||s.dataset.origTitle||null)},this.restoreTooltipText=()=>{null!=this.title&&(this.api.hide(),window.setTimeout(()=>{this.api.set("content.text",this.title)},100))}}componentWillMount(){this.restoreTooltipText()}render(){return this.props.value?i.createElement("a",{className:n,"data-tooltip-hide-events":"mouseleave","data-tooltip-pin-position":!0,"data-tooltip-position":"bottom center",href:this.props.valueAsUrl?this.props.value:"#",onClick:this.click,title:osu.trans("common.buttons.click_to_copy")},this.props.label||this.props.value,this.props.showIcon&&i.createElement("i",{className:`fas fa-paste ${n}__icon`})):i.createElement("span",null)}}r.defaultProps={showIcon:!1,valueAsUrl:!1}}).call(this,s("5wds"))},fxEp:function(e,t,s){"use strict";s.d(t,"a",(function(){return n}));var o=s("EaLk"),i=function(e,t,s,o){var i,n=arguments.length,r=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,s):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,s,o);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(r=(n<3?i(r):n>3?i(t,s,r):i(t,s))||r);return n>3&&r&&Object.defineProperty(t,s,r),r};class n{constructor(e){this.commentableId=e.commentable_id,this.commentableType=e.commentable_type,this.createdAt=e.created_at,this.deletedAt=e.deleted_at,this.editedAt=e.edited_at,this.editedById=e.edited_by_id,this.id=e.id,this.legacyName=e.legacy_name,this.message=e.message,this.messageHtml=e.message_html,this.parentId=e.parent_id,this.pinned=e.pinned,this.repliesCount=e.replies_count,this.updatedAt=e.updated_at,this.userId=e.user_id,this.votesCount=e.votes_count}get canDelete(){return this.canModerate||this.isOwner}get canEdit(){return this.canModerate||this.isOwner&&!this.isDeleted}get canHaveVote(){return!this.isDeleted}get canModerate(){return currentUser.is_admin||currentUser.is_moderator}get canPin(){return currentUser.is_admin&&(null==this.parentId||this.pinned)}get canReport(){return null!=currentUser.id&&this.userId!==currentUser.id}get canRestore(){return this.canModerate}get canVote(){return!this.isOwner}get isDeleted(){return null!=this.deletedAt}get isEdited(){return null!=this.editedAt}get isOwner(){return null!=currentUser.id&&this.userId===currentUser.id}}i([o.e],n.prototype,"canDelete",null),i([o.e],n.prototype,"canEdit",null),i([o.e],n.prototype,"canHaveVote",null),i([o.e],n.prototype,"canModerate",null),i([o.e],n.prototype,"canPin",null),i([o.e],n.prototype,"canReport",null),i([o.e],n.prototype,"canRestore",null),i([o.e],n.prototype,"canVote",null),i([o.e],n.prototype,"isDeleted",null),i([o.e],n.prototype,"isEdited",null),i([o.e],n.prototype,"isOwner",null)},g1Eu:function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return a}));var o=s("/G9H"),i=s("I8Ok"),n=function(e,t){return function(){return e.apply(t,arguments)}},r={}.hasOwnProperty,a=function(t){function s(e){this.reset=n(this.reset,this),this.render=n(this.render,this),this.mountObserver=n(this.mountObserver,this),this.onScroll=n(this.onScroll,this),this.onClick=n(this.onClick,this),this.componentWillUnmount=n(this.componentWillUnmount,this),s.__super__.constructor.call(this,e),this.state={lastScrollY:null}}return function(e,t){for(var s in t)r.call(t,s)&&(e[s]=t[s]);function o(){this.constructor=e}o.prototype=t.prototype,e.prototype=new o,e.__super__=t.prototype}(s,t),s.prototype.componentWillUnmount=function(){if(document.removeEventListener("scroll",this.onScroll),null!=this.observer)return this.observer.disconnect(),this.observer=null},s.prototype.onClick=function(t){var s,o;return null!=this.state.lastScrollY?(window.scrollTo(window.pageXOffset,this.state.lastScrollY),this.setState({lastScrollY:null})):(o=null!=(null!=(s=this.props.anchor)?s.current:void 0)?e(this.props.anchor.current).offset().top:0,window.pageYOffset>o?(this.setState({lastScrollY:window.pageYOffset}),window.scrollTo(window.pageXOffset,o),this.mountObserver()):void 0)},s.prototype.onScroll=function(e){if(this.setState({lastScrollY:null}),document.removeEventListener("scroll",this.onScroll),null!=this.observer)return this.observer.disconnect(),this.observer=null},s.prototype.mountObserver=function(){var e,t,s,o;return null!=window.IntersectionObserver?(s=null!=(e=null!=(t=this.props.anchor)?t.current:void 0)?e:document.body,this.observer=new IntersectionObserver((o=this,function(e){var t,i,n,r;for(r=[],i=0,n=e.length;i<n;i++){if((t=e[i]).target===s&&0===t.boundingClientRect.top){document.addEventListener("scroll",o.onScroll);break}r.push(void 0)}return r})),this.observer.observe(s)):Timeout.set(0,function(e){return function(){return document.addEventListener("scroll",e.onScroll)}}(this))},s.prototype.render=function(){return Object(i.button)({className:"back-to-top","data-tooltip-float":"fixed",onClick:this.onClick,title:null!=this.state.lastScrollY?osu.trans("common.buttons.back_to_previous"):osu.trans("common.buttons.back_to_top")},Object(i.i)({className:null!=this.state.lastScrollY?"fas fa-angle-down":"fas fa-angle-up"}))},s.prototype.reset=function(){return this.setState({lastScrollY:null})},s}(o.PureComponent)}).call(this,s("5wds"))},gcbN:function(e,t,s){"use strict";s.d(t,"a",(function(){return r}));var o=s("/G9H"),i=s("rLgU"),n=s("ss8h");const r=e=>{const t=o.useContext(n.a),s=o.useCallback(s=>{s.preventDefault(),Object(i.h)(t,e.format)},[t,e.format]);return o.createElement("button",{className:osu.classWithModifiers("beatmap-discussion-editor-toolbar__button",[Object(i.d)(t,e.format)?"active":""]),onMouseDown:s},o.createElement("i",{className:`fas fa-${e.format}`}))}},"h/Ip":function(e,t,s){"use strict";s.d(t,"a",(function(){return i}));var o=s("/G9H");const i=Object(o.createContext)({excludes:[],isWidget:!1})},h70U:function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return i}));var o=s("V/vD");class i{constructor(){this.init=()=>{var e;null!==(e=this.layzr)&&void 0!==e||(this.layzr=Object(o.a)()),this.reinit(),this.observer.observe(document.body,{childList:!0,subtree:!0})},this.reinit=()=>{var e;null===(e=this.layzr)||void 0===e||e.update().check().handlers(!0)},this.observer=new MutationObserver(this.reinit),e(document).on("turbolinks:load",this.init)}}}).call(this,s("5wds"))},"hC+F":function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return a}));var o=s("0h6b"),i=s("/G9H"),n=s("PPOh"),r=s("tX/w");class a extends i.PureComponent{constructor(t){super(t),this.eventId=`follow-toggle-${osu.uuid()}`,this.toggleXhr=null,this.onClick=()=>{var t;const s={follow:{notifiable_id:this.props.follow.notifiable_id,notifiable_type:this.props.follow.notifiable_type,subtype:this.props.follow.subtype}},i=this.state.following?"DELETE":"POST";null===(t=this.toggleXhr)||void 0===t||t.abort(),this.setState({toggling:!0},()=>{this.toggleXhr=e.ajax(Object(o.route)("follows.store"),{method:i,data:s}).done(()=>{"mapping"===this.props.follow.subtype?e.publish("user:followUserMapping:update",{following:!this.state.following,userId:this.props.follow.notifiable_id}):this.setState({following:!this.state.following})}).always(()=>{this.setState({toggling:!1})})})},this.refresh=()=>{"mapping"===this.props.follow.subtype&&this.setState({following:currentUser.follow_user_mapping.includes(this.props.follow.notifiable_id)})},this.state={following:this.props.following,toggling:!1}}componentDidMount(){"mapping"===this.props.follow.subtype&&e.subscribe(`user:followUserMapping:refresh.${this.eventId}`,this.refresh)}componentWillUnmount(){e.unsubscribe(`.${this.eventId}`)}render(){return i.createElement("button",{className:Object(r.a)("btn-circle",this.props.modifiers),disabled:this.state.toggling,onClick:this.onClick,type:"button"},i.createElement("span",{className:"btn-circle__content"},this.renderToggleIcon()))}renderToggleIcon(){if(this.state.toggling)return i.createElement("span",{className:"btn-circle__icon"},i.createElement(n.a,null));let e,t;return this.state.following?(t="fas fa-bell",e="fas fa-bell-slash"):(t="far fa-bell",e="fas fa-bell"),i.createElement(i.Fragment,null,i.createElement("span",{className:"btn-circle__icon btn-circle__icon--hover-show"},i.createElement("span",{className:e})),i.createElement("span",{className:"btn-circle__icon btn-circle__icon--hover-hide"},i.createElement("span",{className:t})))}}a.defaultProps={following:!0}}).call(this,s("5wds"))},hTAd:function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return i}));var o=s("dUQf");class i{constructor(){this.current=null,this.close=()=>{this.show()},this.restoreSaved=()=>{this.show(document.body.dataset.clickMenuCurrent)},this.saveCurrent=()=>{null==this.current?delete document.body.dataset.clickMenuCurrent:document.body.dataset.clickMenuCurrent=this.current},this.show=t=>{var s,i;const n=this.tree();this.current=t;const r=this.tree(),a=document.querySelectorAll(".js-click-menu[data-click-menu-id]");let l=null,c=!1;for(const e of a){if(!(e instanceof HTMLElement))continue;const t=e.dataset.clickMenuId;null==t||-1===r.indexOf(t)?(o.a.out(e),e.classList.remove("js-click-menu--active"),null===(s=this.menuLink(t))||void 0===s||s.classList.remove("js-click-menu--active")):(o.a.in(e),e.classList.add("js-click-menu--active"),null===(i=this.menuLink(t))||void 0===i||i.classList.add("js-click-menu--active"),c=!0,t===this.current&&(l=e))}c||(this.current=null),e.publish("click-menu:current",{previousTree:n,target:this.current,tree:r});const u=null==l?void 0:l.querySelector(".js-click-menu--autofocus");u instanceof HTMLElement&&u.focus()},this.toggle=e=>{const t=e.currentTarget,s=this.tree();e.preventDefault(),e.stopPropagation();const o=t.dataset.clickMenuTarget;let i=o;if(null!=o){const e=s.indexOf(o);-1!==e&&(i=s[e+1])}this.show(i)},this.tree=()=>{if(null==this.current)return[];let e=this.current;const t=[e];for(;null!=(e=this.closestMenuId(this.menuLink(e)));)t.push(e);return t},this.onDocumentMousedown=e=>{this.documentMouseEventTarget=0===e.button?e.target:null},this.onDocumentMouseup=t=>{this.documentMouseEventTarget===t.target&&0===t.button&&(osu.popupShowing()||null!=this.current&&(e(t.target).closest(".js-click-menu").length>0||this.show()))},e(document).on("click",".js-click-menu--close",this.close),e(document).on("click",".js-click-menu[data-click-menu-target]",this.toggle),e(document).on("mousedown",this.onDocumentMousedown),e(document).on("mouseup",this.onDocumentMouseup),document.addEventListener("turbolinks:load",this.restoreSaved),document.addEventListener("turbolinks:before-cache",this.saveCurrent)}closestMenuId(t){if(null!=t)return e(t).parents("[data-click-menu-id]").attr("data-click-menu-id")}menu(e){return document.querySelector(`.js-click-menu[data-click-menu-id${null==e?"":`='${e}'`}]`)}menuLink(e){return document.querySelector(`.js-click-menu[data-click-menu-target${null==e?"":`='${e}'`}]`)}}}).call(this,s("5wds"))},hc33:function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return l}));var o=s("0h6b"),i=s("/G9H"),n=s("i+hk"),r=function(e,t){var s={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(s[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(o=Object.getOwnPropertySymbols(e);i<o.length;i++)t.indexOf(o[i])<0&&Object.prototype.propertyIsEnumerable.call(e,o[i])&&(s[o[i]]=e[o[i]])}return s};const a={beatmapset_discussion_post:["Insults","Spam","UnwantedContent","Nonsense","Other"],comment:["Insults","Spam","UnwantedContent","Nonsense","Other"],forum_post:["Insults","Spam","UnwantedContent","Nonsense","Other"],scores:["Cheating","Other"]};class l extends i.PureComponent{constructor(t){super(t),this.onFormClose=()=>{this.setState({disabled:!1,showingForm:!1},this.props.onFormClose)},this.onSubmit=t=>{this.setState({disabled:!0});const s={data:{comments:t.comments,reason:t.reason,reportable_id:this.props.reportableId,reportable_type:this.props.reportableType},dataType:"json",type:"POST",url:Object(o.route)("reports.store")};e.ajax(s).done(()=>{this.timeout=window.setTimeout(this.onFormClose,1e3),this.setState({completed:!0})}).fail(e=>{osu.ajaxError(e),this.setState({disabled:!1})})},this.showForm=()=>{window.clearTimeout(this.timeout),this.setState({disabled:!1,showingForm:!0})},this.onShowFormButtonClick=e=>{0===e.button&&(e.preventDefault(),this.showForm())},this.state={completed:!1,disabled:!1,showingForm:!1}}render(){const e=this.props,{baseKey:t,icon:s,onFormClose:o,reportableId:l,reportableType:c,user:u}=e,d=r(e,["baseKey","icon","onFormClose","reportableId","reportableType","user"]),p=t||this.props.reportableType;return i.createElement(i.Fragment,null,i.createElement("button",Object.assign({key:"button",onClick:this.onShowFormButtonClick},d),s?i.createElement("span",{className:"textual-button textual-button--inline"},i.createElement("i",{className:"textual-button__icon fas fa-exclamation-triangle"})," ",osu.trans(`report.${p}.button`)):osu.trans(`report.${p}.button`)),this.state.showingForm&&i.createElement(n.a,{completed:this.state.completed,disabled:this.state.disabled,onClose:this.onFormClose,onSubmit:this.onSubmit,title:osu.trans(`report.${p}.title`,{username:`<strong>${u.username}</strong>`}),visible:!0,visibleOptions:a[p]}))}}l.defaultProps={icon:!1,onFormClose:()=>{}}}).call(this,s("5wds"))},"i+hk":function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return d}));var o,i=s("Hs9Z"),n=s("txhI"),r=s("/G9H"),a=s("I8Ok"),l=s("MeXQ"),c=function(e,t){return function(){return e.apply(t,arguments)}},u={}.hasOwnProperty;o="report-form";var d=function(t){function s(t){this.sendReport=c(this.sendReport,this),this.renderFormContent=c(this.renderFormContent,this),this.renderForm=c(this.renderForm,this),this.render=c(this.render,this),this.handleReasonChange=c(this.handleReasonChange,this),s.__super__.constructor.call(this,t),this.options=[{id:"Cheating",text:osu.trans("users.report.options.cheating")},{id:"Insults",text:osu.trans("users.report.options.insults")},{id:"Spam",text:osu.trans("users.report.options.spam")},{id:"UnwantedContent",text:osu.trans("users.report.options.unwanted_content")},{id:"Nonsense",text:osu.trans("users.report.options.nonsense")},{id:"Other",text:osu.trans("users.report.options.other")}],null!=t.visibleOptions&&(this.options=e.intersectionWith(this.options,t.visibleOptions,(function(e,t){return e.id===t}))),this.textarea=Object(r.createRef)(),this.state={selectedReason:this.options[0]}}return function(e,t){for(var s in t)u.call(t,s)&&(e[s]=t[s]);function o(){this.constructor=e}o.prototype=t.prototype,e.prototype=new o,e.__super__=t.prototype}(s,t),s.prototype.handleReasonChange=function(e){return this.setState({selectedReason:e})},s.prototype.render=function(){return this.props.visible?this.renderForm():null},s.prototype.renderForm=function(){var e;return e=this.props.completed?osu.trans("users.report.thanks"):this.props.title,Object(r.createElement)(n.a,{onClose:this.props.onClose,visible:this.props.visible},Object(a.div)({className:o},Object(a.div)({className:o+"__header"},Object(a.div)({className:o+"__row "+o+"__row--exclamation"},Object(a.i)({className:"fas fa-exclamation-triangle"})),Object(a.div)({className:o+"__row "+o+"__row--title",dangerouslySetInnerHTML:{__html:"<span>"+e+"</span>"}})),this.props.completed?void 0:this.renderFormContent()))},s.prototype.renderFormContent=function(){return Object(a.div)(null,Object(i.isEmpty)(this.options)?void 0:[Object(a.div)({key:"label",className:o+"__row"},osu.trans("users.report.reason")),Object(a.div)({key:"options",className:o+"__row"},Object(r.createElement)(l.a,{blackout:!1,bn:o+"-select-options",onChange:this.handleReasonChange,options:this.options,selected:this.state.selectedReason}))],Object(a.div)({className:o+"__row"},osu.trans("users.report.comments")),Object(a.div)({className:o+"__row"},Object(a.textarea)({className:o+"__textarea",placeholder:osu.trans("users.report.placeholder"),ref:this.textarea})),Object(a.div)({className:o+"__row "+o+"__row--buttons"},[Object(a.button)({className:o+"__button "+o+"__button--report",disabled:this.props.disabled,key:"report",type:"button",onClick:this.sendReport},osu.trans("users.report.actions.send")),Object(a.button)({className:o+"__button",disabled:this.props.disabled,key:"cancel",type:"button",onClick:this.props.onClose},osu.trans("users.report.actions.cancel"))]))},s.prototype.sendReport=function(e){var t,s,o;return s={reason:null!=(o=this.state.selectedReason)?o.id:void 0,comments:this.textarea.current.value},"function"==typeof(t=this.props).onSubmit?t.onSubmit(s):void 0},s}(r.PureComponent)}).call(this,s("Hs9Z"))},"iH//":function(e,t,s){"use strict";function o(e){return e.replace(osu.urlRegex,(e,t)=>{var s;const o=i(t),n="string"==typeof o.children?o.children:t,r=null===(s=o.className)||void 0===s?void 0:s.split(" ");return o.children=null,o.className=void 0,osu.link(t,n,{classNames:r,props:o,unescape:!0})})}function i(e){const t=BeatmapDiscussionHelper.urlParse(window.location.href),s={children:e,rel:"nofollow noreferrer",target:"_blank"};let o;try{o=new URL(e)}catch(i){}if(null!=o&&o.host===window.location.host){const e=BeatmapDiscussionHelper.urlParse(o.href,null,{forceDiscussionId:!0});null!=(null==e?void 0:e.discussionId)&&null!=e.beatmapsetId&&((null==t?void 0:t.beatmapsetId)===e.beatmapsetId?(s.children=`#${e.discussionId}`,s.className="js-beatmap-discussion--jump",s.target=void 0):s.children=`${e.beatmapsetId}#${e.discussionId}`)}return s}s.d(t,"a",(function(){return o})),s.d(t,"b",(function(){return i}))},iRgH:function(e,t,s){"use strict";s.d(t,"a",(function(){return o})),s.d(t,"b",(function(){return i}));class o{}class i{}},jEEn:function(e,t,s){"use strict";s.d(t,"a",(function(){return i}));var o=s("/G9H");function i({country:e,modifiers:t}){return null==e||null==e.code?null:o.createElement("div",{className:osu.classWithModifiers("flag-country",t),style:{backgroundImage:`url('/images/flags/${e.code}.png')`},title:e.name})}},jUJ3:function(e,t,s){"use strict";s.d(t,"a",(function(){return i}));let o=null;function i(e){var t;const s=function(){if(null==o&&null==(o=document.querySelector(".js-estimate-min-lines")))throw new Error("js-estimate-min-lines placeholder element is missing!");return o}();s.innerHTML=e;const i=s.firstChild;let n=s;i instanceof HTMLElement&&(n=i);const r=parseFloat(null!==(t=window.getComputedStyle(n).getPropertyValue("line-height"))&&void 0!==t?t:"0"),a=s.scrollHeight;return{count:Math.ceil(a/r),height:a,lineHeight:r}}},jbZF:function(e,t,s){"use strict";(function(e,o){s.d(t,"a",(function(){return d}));var i,n,r=s("/G9H"),a=s("I8Ok"),l=s("PPOh"),c=function(e,t){return function(){return e.apply(t,arguments)}},u={}.hasOwnProperty;n=r.createElement,i="textual-button";var d=function(t){function s(t){this.isVisible=c(this.isVisible,this),this.render=c(this.render,this),this.componentWillUnmount=c(this.componentWillUnmount,this),this.componentDidMount=c(this.componentDidMount,this),this.clicked=c(this.clicked,this),this.refresh=c(this.refresh,this),this.updateBlocks=c(this.updateBlocks,this),s.__super__.constructor.call(this,t),this.button=r.createRef(),this.eventId="blockButton-"+this.props.userId+"-"+osu.uuid(),this.state={block:e.find(currentUser.blocks,{target_id:t.userId})}}return function(e,t){for(var s in t)u.call(t,s)&&(e[s]=t[s]);function o(){this.constructor=e}o.prototype=t.prototype,e.prototype=new o,e.__super__=t.prototype}(s,t),s.defaultProps={onClick:function(){}},s.prototype.updateBlocks=function(t){return this.setState({block:e.find(t,{target_id:this.props.userId})},(function(){return currentUser.blocks=e.filter(t,{relation_type:"block"}),currentUser.friends=e.filter(t,{relation_type:"friend"}),o.publish("user:update",currentUser),o.publish("blockButton:refresh"),o.publish("friendButton:refresh")})),this.props.onClick()},s.prototype.refresh=function(t){return this.setState({block:e.find(currentUser.blocks,{target_id:this.props.userId})})},s.prototype.clicked=function(e){var t;if(confirm(osu.trans("common.confirmation")))return this.setState({loading:!0},(t=this,function(){return t.state.block?t.xhr=o.ajax({type:"DELETE",url:laroute.route("blocks.destroy",{block:t.props.userId})}):t.xhr=o.ajax({type:"POST",url:laroute.route("blocks.store",{target:t.props.userId})}),t.xhr.always((function(){return t.setState({loading:!1})})).fail(osu.emitAjaxError(t.button.current)).done(t.updateBlocks)}));this.props.onClick()},s.prototype.componentDidMount=function(){return o.subscribe("blockButton:refresh."+this.eventId,this.refresh)},s.prototype.componentWillUnmount=function(){var e;return o.unsubscribe("."+this.eventId),null!=(e=this.xhr)?e.abort():void 0},s.prototype.render=function(){var e,t,s;return this.isVisible()?(e=osu.classWithModifiers(i,["block"].concat(this.props.modifiers)),null!=this.props.wrapperClass?(s=this.props.wrapperClass,t=e):(s=e,t=null),Object(a.button)({type:"button",className:s,onClick:this.clicked,ref:this.button,disabled:this.state.loading},Object(a.span)({className:t},this.state.loading?Object(a.span)({className:i+"__icon fa-fw"},n(l.a)):Object(a.i)({className:i+"__icon fas fa-ban fa-fw"})," ",this.state.block?osu.trans("users.blocks.button.unblock"):osu.trans("users.blocks.button.block")))):null},s.prototype.isVisible=function(){return null!=currentUser.id&&e.isFinite(this.props.userId)&&this.props.userId!==currentUser.id},s}(r.PureComponent)}).call(this,s("Hs9Z"),s("5wds"))},kiUL:function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return d}));var o=s("WLnA"),i=s("0h6b"),n=s("Hs9Z"),r=s("EaLk"),a=s("y2EG"),l=s("nxXY"),c=s("uW+8"),u=function(e,t,s,o){var i,n=arguments.length,r=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,s):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,s,o);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(r=(n<3?i(r):n>3?i(t,s,r):i(t,s))||r);return n>3&&r&&Object.defineProperty(t,s,r),r};class d{constructor(){this.debouncedDeleteByIds=Object(n.debounce)(this.deleteByIds,500),this.debouncedSendQueuedMarkedAsRead=Object(n.debounce)(this.sendQueuedMarkedAsRead,500),this.deleteByIdsQueue=new Map,this.queuedMarkedAsRead=new Map,this.queuedMarkedAsReadIdentities=new Map}delete(t){if(t.isDeleting=!0,t instanceof a.a)return this.deleteByIdsQueue.set(t.id,t),void this.debouncedDeleteByIds();e.ajax({data:{identities:[Object(l.d)(t.identity)]},dataType:"json",method:"DELETE",url:Object(i.route)("notifications.index")}).then(Object(r.d)(()=>{Object(o.a)(new c.a([t.identity],0))})).catch(osu.ajaxError).always(Object(r.d)(()=>t.isDeleting=!1))}loadMore(t,s,n){const r=Object(l.d)(t);delete r.id;const a=Object(i.route)("notifications.index",r),u={data:{cursor:n,unread:s.isWidget},dataType:"json",url:a};return e.ajax(u).then(e=>{Object(o.a)(new c.b(e,s))})}queueMarkAsRead(e){e.isMarkingAsRead=!0;const t=e.identity;"stack"!==Object(l.b)(t)?(e instanceof a.a&&e.canMarkRead?this.queuedMarkedAsRead.set(e.id,e):this.queuedMarkedAsReadIdentities.set(Object(l.e)(t),e),this.debouncedSendQueuedMarkedAsRead()):this.sendMarkAsReadRequest({identities:[Object(l.d)(e.identity)]}).then(Object(r.d)(()=>{Object(o.a)(new c.d([t],0))})).always(Object(r.d)(()=>e.isMarkingAsRead=!1))}deleteByIds(){if(0===this.deleteByIdsQueue.size)return;const t=[...this.deleteByIdsQueue.values()],s=t.map(e=>e.identity);this.deleteByIdsQueue.clear(),e.ajax({data:{notifications:s.map(l.d)},dataType:"json",method:"DELETE",url:Object(i.route)("notifications.index")}).then(Object(r.d)(()=>{Object(o.a)(new c.a(s,0))})).always(Object(r.d)(()=>t.forEach(e=>e.isDeleting=!1)))}sendMarkAsReadRequest(t){return e.ajax({data:t,dataType:"json",method:"POST",url:Object(i.route)("notifications.mark-read")}).catch(osu.ajaxError)}sendQueuedMarkedAsRead(){if(this.queuedMarkedAsRead.size>0){const e=[...this.queuedMarkedAsRead.values()],t=e.map(e=>e.identity);this.queuedMarkedAsRead.clear(),this.sendMarkAsReadRequest({notifications:t.map(l.d)}).then(Object(r.d)(()=>{Object(o.a)(new c.d(t,0))})).always(Object(r.d)(()=>e.forEach(e=>e.isMarkingAsRead=!1)))}if(this.queuedMarkedAsReadIdentities.size>0){const e=[...this.queuedMarkedAsReadIdentities.values()],t=e.map(e=>e.identity);this.queuedMarkedAsReadIdentities.clear(),this.sendMarkAsReadRequest({identities:t.map(l.d)}).then(Object(r.d)(()=>{Object(o.a)(new c.d(t,0))})).always(Object(r.d)(()=>e.forEach(e=>e.isMarkingAsRead=!1)))}}}u([r.d],d.prototype,"delete",null),u([r.d],d.prototype,"loadMore",null),u([r.d],d.prototype,"queueMarkAsRead",null)}).call(this,s("5wds"))},"l+Wg":function(e,t,s){"use strict";s.d(t,"a",(function(){return r}));var o=s("qpPZ"),i=s("0h6b"),n=s("/G9H");function r(e){const t=[{active:"index"===e.section,title:osu.trans("news.index.title.info"),url:Object(i.route)("news.index")}];return"show"===e.section&&null!=e.post&&t.push({active:!0,title:e.post.title,url:Object(i.route)("news.show",{news:e.post.slug})}),n.createElement(o.a,{links:t,linksBreadcrumb:!0,theme:"news"})}},leGJ:function(e,t,s){"use strict";(function(e,o){s.d(t,"a",(function(){return g}));var i,n,r,a=s("svbn"),l=s("AU96"),c=s("ukW2"),u=s("CnOT"),d=s("VxeA"),p=s("/G9H"),h=s("xZyo"),m=s("I8Ok"),f=s("TY2o"),b=s("tX/w"),v=function(e,t){return function(){return e.apply(t,arguments)}},y={}.hasOwnProperty;r=p.createElement,n="beatmap-discussion",i=function(e){var t,s,o;return s=e.type,t=e.discussion,o=e.users,Object(m.div)({className:"user-list-popup user-list-popup--blank"},t.votes[s]<1?osu.trans("beatmaps.discussions.votes.none."+s):r(p.Fragment,null,Object(m.div)({className:"user-list-popup__title"},osu.trans("beatmaps.discussions.votes.latest."+s),":"),t.votes.voters[s].map((function(e){var t;return Object(m.a)({href:laroute.route("users.show",{user:e}),className:"js-usercard user-list-popup__user",key:e,"data-user-id":e},r(f.a,{user:null!=(t=o[e])?t:[],modifiers:["full"]}))})),t.votes[s]>t.votes.voters[s].length?Object(m.div)({className:"user-list-popup__remainder-count"},osu.transChoice("common.count.plus_others",t.votes[s]-t.votes.voters[s].length)):void 0))};var g=function(t){function s(e){this.toggleCollapse=v(this.toggleCollapse,this),this.timestamp=v(this.timestamp,this),this.resolvedSystemPostId=v(this.resolvedSystemPostId,this),this.post=v(this.post,this),this.canBeRepliedTo=v(this.canBeRepliedTo,this),this.canDownvote=v(this.canDownvote,this),this.isVisible=v(this.isVisible,this),this.isRead=v(this.isRead,this),this.isOwner=v(this.isOwner,this),this.emitSetHighlight=v(this.emitSetHighlight,this),this.doVote=v(this.doVote,this),this.showVoters=v(this.showVoters,this),this.refreshTooltip=v(this.refreshTooltip,this),this.getTooltipContent=v(this.getTooltipContent,this),this.displayVote=v(this.displayVote,this),this.postFooter=v(this.postFooter,this),this.postButtons=v(this.postButtons,this),this.render=v(this.render,this),this.componentDidUpdate=v(this.componentDidUpdate,this),this.componentWillUnmount=v(this.componentWillUnmount,this),s.__super__.constructor.call(this,e),this.eventId="beatmap-discussion-entry-"+this.props.discussion.id,this.tooltips={}}return function(e,t){for(var s in t)y.call(t,s)&&(e[s]=t[s]);function o(){this.constructor=e}o.prototype=t.prototype,e.prototype=new o,e.__super__=t.prototype}(s,t),s.prototype.componentWillUnmount=function(){var e;return null!=(e=this.voteXhr)?e.abort():void 0},s.prototype.componentDidUpdate=function(){var e,t,s,o;for(o in t=[],e=this.tooltips)y.call(e,o)&&(s=e[o],t.push(this.refreshTooltip(s.qtip("api"),o)));return t},s.prototype.render=function(){var e,t,s,o,i,a,l;return this.isVisible(this.props.discussion)&&(this.props.discussion.starting_post||this.props.discussion.posts&&0!==this.props.discussion.posts.length)?(s=Object(b.a)(n+"__line",{resolved:this.props.discussion.resolved}),!1,this._resolvedSystemPostId=null,e=this.props.discussion.starting_post||this.props.discussion.posts[0],a=Object(b.a)(n,{"horizontal-desktop":"review"!==this.props.discussion.message_type,deleted:null!=this.props.discussion.deleted_at,highlighted:this.props.highlighted,preview:this.props.preview,review:"review"===this.props.discussion.message_type,timeline:null!=this.props.discussion.timestamp,unread:!this.isRead(e)}),a+=" js-beatmap-discussion-jump",t=(l=null!=(o=this.props.users[this.props.discussion.user_id])?o:this.props.users.null).id===this.props.beatmapset.user_id?d.a:null!=(i=l.groups)?i[0]:void 0,Object(m.div)({className:a,"data-id":this.props.discussion.id,onClick:this.emitSetHighlight},Object(m.div)({className:n+"__timestamp hidden-xs"},this.timestamp()),Object(m.div)({className:n+"__discussion"},Object(m.div)({className:n+"__top",style:osu.groupColour(t)},Object(m.div)({className:n+"__top-user"},r(u.a,{user:l,group:t,hideStripe:!0})),Object(m.div)({className:n+"__top-message"},this.post(e,"discussion",!0)),Object(m.div)({className:n+"__top-actions"},this.props.preview?void 0:this.postButtons())),this.props.preview?void 0:this.postFooter(),Object(m.div)({className:s})))):null},s.prototype.postButtons=function(){return Object(m.div)({className:n+"__actions"},null!=this.props.parentDiscussion?Object(m.a)({href:BeatmapDiscussionHelper.url({discussion:this.props.parentDiscussion}),title:osu.trans("beatmap_discussions.review.go_to_parent"),className:n+"__link-to-parent js-beatmap-discussion--jump"},Object(m.i)({className:"fas fa-tasks"})):void 0,["up","down"].map((e=this,function(t){return Object(m.div)({key:t,"data-type":t,className:n+"__action",onMouseOver:e.showVoters,onTouchStart:e.showVoters},e.displayVote(t))})),Object(m.button)({className:n+"__action "+n+"__action--with-line",onClick:this.toggleCollapse},Object(m.div)({className:"beatmap-discussion-expand "+(this.props.collapsed?void 0:"beatmap-discussion-expand--expanded")},Object(m.i)({className:"fas fa-chevron-down"}))));var e},s.prototype.postFooter=function(){var e,t,s;return Object(m.div)({className:n+"__expanded "+(this.props.collapsed?"hidden":void 0)},Object(m.div)({className:n+"__replies"},function(){var o,i,n,r;for(r=[],o=0,i=(n=this.props.discussion.posts.slice(1)).length;o<i;o++)if(s=n[o],this.isVisible(s)){if(s.system&&"resolved"===s.message.type){if(e=s.message.value,t===e)continue;t=e}r.push(this.post(s,"reply"))}return r}.call(this)),this.canBeRepliedTo()?r(a.a,{currentUser:this.props.currentUser,beatmapset:this.props.beatmapset,currentBeatmap:this.props.currentBeatmap,discussion:this.props.discussion}):void 0)},s.prototype.displayVote=function(e){var t,s,o,i,n,r,a,l,c,u,d;if(d="beatmap-discussion-vote",t=(n=function(){switch(e){case"up":return[1,"thumbs-up"];case"down":return[-1,"thumbs-down"]}}())[0],i=n[1],null!=t)return s=null!=(r=this.props.discussion.current_user_attributes)?r.vote_score:void 0,c=d+" "+d+"--"+e,0!==(l=s===t?0:t)&&(c+=" "+d+"--inactive"),u=null!=(a=this.props.users[this.props.discussion.user_id])?a:this.props.users.null,o=this.isOwner()||u.is_bot||"down"===e&&!this.canDownvote()||!this.canBeRepliedTo(),Object(m.button)({className:c,"data-score":l,disabled:o,onClick:this.doVote},Object(m.i)({className:"fas fa-"+i}),Object(m.span)({className:d+"__count"},this.props.discussion.votes[e]))},s.prototype.getTooltipContent=function(e){return Object(h.renderToStaticMarkup)(r(i,{type:e,discussion:this.props.discussion,users:this.props.users}))},s.prototype.refreshTooltip=function(e,t){return null!=e?e.set("content.text",this.getTooltipContent(t)):void 0},s.prototype.showVoters=function(t){var s,o;if(!(s=t.currentTarget)._tooltip)return s._tooltip=!0,o=s.getAttribute("data-type"),this.tooltips[o]=e(s).qtip({style:{classes:"user-list-popup",def:!1,tip:!1},content:{text:this.getTooltipContent(o)},position:{at:"top center",my:"bottom center",viewport:e(window)},show:{delay:100,ready:!0,solo:!0,effect:function(){return e(this).fadeTo(110,1)}},hide:{fixed:!0,delay:500,effect:function(){return e(this).fadeTo(250,0)}}})},s.prototype.doVote=function(t){var s;return LoadingOverlay.show(),null!=(s=this.voteXhr)&&s.abort(),this.voteXhr=e.ajax(laroute.route("beatmapsets.discussions.vote",{discussion:this.props.discussion.id}),{method:"PUT",data:{beatmap_discussion_vote:{score:t.currentTarget.dataset.score}}}).done((function(t){return e.publish("beatmapsetDiscussions:update",{beatmapset:t})})).fail(osu.ajaxError).always(LoadingOverlay.hide)},s.prototype.emitSetHighlight=function(){return e.publish("beatmapset-discussions:highlight",{discussionId:this.props.discussion.id})},s.prototype.isOwner=function(e){return null==e&&(e=this.props.discussion),null!=this.props.currentUser.id&&e.user_id===this.props.currentUser.id},s.prototype.isRead=function(e){var t;return(null!=(t=this.props.readPostIds)?t.has(e.id):void 0)||this.isOwner(e)||this.props.preview},s.prototype.isVisible=function(e){return null!=e&&(this.props.showDeleted||null==e.deleted_at)},s.prototype.canDownvote=function(){return this.props.currentUser.is_admin||this.props.currentUser.is_moderator||this.props.currentUser.is_bng},s.prototype.canBeRepliedTo=function(){return(!this.props.beatmapset.discussion_locked||BeatmapDiscussionHelper.canModeratePosts(this.props.currentUser))&&(null==this.props.discussion.beatmap_id||null==this.props.currentBeatmap.deleted_at)},s.prototype.post=function(e,t,s){var o,i,n,a,u,d,p;if(null!=e.id)return a=e.system?c.a:l.a,n=BeatmapDiscussionHelper.canModeratePosts(this.props.currentUser),i=this.isOwner(e)&&e.id>this.resolvedSystemPostId()&&!this.props.beatmapset.discussion_locked,o="discussion"===t?null!=(u=this.props.discussion.current_user_attributes)?u.can_destroy:void 0:n||i,r(a,{key:e.id,beatmapset:this.props.beatmapset,beatmap:this.props.currentBeatmap,discussion:this.props.discussion,post:e,type:t,read:this.isRead(e),users:this.props.users,user:null!=(d=this.props.users[e.user_id])?d:this.props.users.null,lastEditor:null!=e.last_editor_id?null!=(p=this.props.users[e.last_editor_id])?p:this.props.users.null:void 0,canBeEdited:this.props.currentUser.is_admin||i,canBeDeleted:o,canBeRestored:n,currentUser:this.props.currentUser,hideUserCard:s})},s.prototype.resolvedSystemPostId=function(){var e,t;return null==this._resolvedSystemPostId&&(t=o.findLast(this.props.discussion.posts,(function(e){return null!=e&&e.system&&"resolved"===e.message.type})),this._resolvedSystemPostId=null!=(e=null!=t?t.id:void 0)?e:-1),this._resolvedSystemPostId},s.prototype.timestamp=function(){var e;return e="beatmap-discussion-timestamp",Object(m.div)({className:e},null!=this.props.discussion.timestamp&&this.props.isTimelineVisible?Object(m.div)({className:e+"__point"}):void 0,Object(m.div)({className:e+"__icons-container"},Object(m.div)({className:e+"__icons"},Object(m.div)({className:e+"__icon"},Object(m.span)({className:"beatmap-discussion-message-type beatmap-discussion-message-type--"+o.kebabCase(this.props.discussion.message_type)},Object(m.i)({className:BeatmapDiscussionHelper.messageType.icon[o.camelCase(this.props.discussion.message_type)]}))),this.props.discussion.resolved?Object(m.div)({className:e+"__icon "+e+"__icon--resolved"},Object(m.i)({className:"far fa-check-circle"})):void 0),Object(m.div)({className:e+"__text"},BeatmapDiscussionHelper.formatTimestamp(this.props.discussion.timestamp))))},s.prototype.toggleCollapse=function(){return e.publish("beatmapset-discussions:collapse",{discussionId:this.props.discussion.id})},s}(p.PureComponent)}).call(this,s("5wds"),s("Hs9Z"))},lo2x:function(e,t,s){"use strict";(function(e){var o=s("OjW+"),i=s("ZJc0"),n=s("NW+U"),r=s("0h6b"),a=s("Hs9Z"),l=s("EaLk"),c=s("cF9b"),u=s("bucr"),d=s("/G9H"),p=s("X4fg"),h=s("mk7q"),m=s("peKF"),f=s("sAkl"),b=s("yun6"),v=s("ubBH"),y=s("tX/w"),g=s("phBA"),_=function(e,t,s,o){var i,n=arguments.length,r=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,s):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,s,o);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(r=(n<3?i(r):n>3?i(t,s,r):i(t,s))||r);return n>3&&r&&Object.defineProperty(t,s,r),r};const w={approved:"ranked_date",graveyard:"last_updated",loved:"ranked_date",pending:"last_updated",qualified:"ranked_date",ranked:"ranked_date",wip:"last_updated"},E=e=>{e.currentTarget.style.display="none"},O=Object(c.e)(({beatmap:e})=>d.createElement("div",{className:"beatmapset-panel__beatmap-dot",style:{"--bg":`var(--diff-${b.d(e.difficulty_rating)})`}})),j=Object(c.e)(({compact:e,group:t})=>d.createElement("div",{className:"beatmapset-panel__extra-item beatmapset-panel__extra-item--dots"},d.createElement("div",{className:"beatmapset-panel__beatmap-icon"},d.createElement("i",{className:`fal fa-extra-mode-${t.mode}`})),e?d.createElement("div",{className:"beatmapset-panel__beatmap-count"},t.beatmaps.length):t.beatmaps.map(e=>d.createElement(O,{key:e.id,beatmap:e})))),k=Object(c.e)(({beatmapset:e})=>d.createElement(f.a,{className:"beatmapset-panel__mapper-link u-hover",user:{id:e.user_id,username:e.creator}})),N=()=>d.createElement("span",{className:"nsfw-badge nsfw-badge--panel"},osu.trans("beatmapsets.nsfw_badge.label")),S=({icon:e,titleVariant:t})=>d.createElement("div",{className:"beatmapset-panel__play-icon",title:osu.trans(`beatmapsets.show.info.${t}`)},d.createElement("i",{className:e})),T=({icon:e,title:t,value:s})=>d.createElement("div",{className:"beatmapset-panel__stats-item",title:t},d.createElement("span",{className:"beatmapset-panel__stats-item-icon"},d.createElement("i",{className:e})),d.createElement("span",null,Object(g.b)(s,0)));let P=class extends d.Component{constructor(){super(...arguments),this.beatmapsPopupHover=!1,this.beatmapsPopupRef=d.createRef(),this.blockRef=d.createRef(),this.mobileExpanded=!1,this.timeouts={},this.beatmapsPopupDelayedHide=()=>{window.clearTimeout(this.timeouts.beatmapsPopup),this.beatmapsPopupHover&&(this.timeouts.beatmapsPopup=window.setTimeout(()=>{this.beatmapsPopupHover=!1},500))},this.beatmapsPopupDelayedShow=()=>{window.clearTimeout(this.timeouts.beatmapsPopup),this.beatmapsPopupHover||(this.timeouts.beatmapsPopup=window.setTimeout(()=>{this.beatmapsPopupHover=!0},100))},this.beatmapsPopupHide=()=>{window.clearTimeout(this.timeouts.beatmapsPopup),this.beatmapsPopupHover=!1},this.beatmapsPopupKeep=()=>{window.clearTimeout(this.timeouts.beatmapsPopup),this.beatmapsPopupHover=!0},this.onBeatmapsPopupEnter=()=>{this.beatmapsPopupKeep()},this.onBeatmapsPopupLeave=()=>{this.beatmapsPopupDelayedHide()},this.onDocumentClick=t=>{var s,o,i;this.mobileExpanded&&(null!==(s=this.blockRef.current)&&void 0!==s&&s.contains(t.target)||null!==(i=null===(o=this.beatmapsPopupRef.current)||void 0===o?void 0:o.contentRef.current)&&void 0!==i&&i.contains(t.target)||(e(document).off("click",this.onDocumentClick),this.mobileExpanded=!1))},this.onExtraRowEnter=()=>{this.beatmapsPopupDelayedShow()},this.onExtraRowLeave=()=>{this.beatmapsPopupDelayedHide()},this.onMobileExpandToggleClick=()=>{this.mobileExpanded=!this.mobileExpanded,this.mobileExpanded&&e(document).on("click",this.onDocumentClick)},this.toggleFavourite=()=>{Object(v.c)(this.props.beatmapset)}}get beatmapDotsCompact(){return null!=this.props.beatmapset.beatmaps&&this.props.beatmapset.beatmaps.length>12}get displayDate(){const e=w[this.props.beatmapset.status];return this.props.beatmapset[e]}get downloadLink(){var e;if(null==currentUser.id)return{title:osu.trans("beatmapsets.show.details.logged-out")};if(null===(e=this.props.beatmapset.availability)||void 0===e?void 0:e.download_disabled)return{title:osu.trans("beatmapsets.availability.disabled")};let t,s,o=currentUser.user_preferences.beatmapset_download;if("direct"!==o||currentUser.is_supporter||(o="all"),"direct"===o)t=u.a.beatmapsetDownloadDirect(this.props.beatmapset.id),s="direct";else{const e={beatmapset:this.props.beatmapset.id};this.props.beatmapset.video?"no_video"===o?(e.noVideo=1,s="no_video"):s="video":s="all",t=Object(r.route)("beatmapsets.download",e)}return{title:osu.trans(`beatmapsets.panel.download.${s}`),url:t}}get favourite(){return this.props.beatmapset.has_favourited?{icon:"fas fa-heart",toggleTitleVariant:"unfavourite"}:{icon:"far fa-heart",toggleTitleVariant:"favourite"}}get groupedBeatmaps(){var e;const t=b.f(null!==(e=this.props.beatmapset.beatmaps)&&void 0!==e?e:[]),s=[];return b.g.forEach(e=>{const o=t[e];null!=o&&s.push({beatmaps:o,mode:e})}),s}get isBeatmapsPopupVisible(){return this.beatmapsPopupHover||this.mobileExpanded}get nominations(){return null!=this.props.beatmapset.nominations_summary?this.props.beatmapset.nominations_summary:null!=this.props.beatmapset.nominations?this.props.beatmapset.nominations.legacy_mode?this.props.beatmapset.nominations:{current:Object(a.sum)(Object(a.values)(this.props.beatmapset.nominations.current)),required:Object(a.sum)(Object(a.values)(this.props.beatmapset.nominations.required))}:void 0}get showHypeCounts(){return null!=this.props.beatmapset.hype}get showVisual(){return Object(v.b)(this.props.beatmapset)}get url(){return Object(r.route)("beatmapsets.show",{beatmapset:this.props.beatmapset.id})}componentWillUnmount(){e(document).off("click",this.onDocumentClick),Object.values(this.timeouts).forEach(e=>{window.clearTimeout(e)})}render(){let e=Object(y.a)("beatmapset-panel",{"beatmaps-popup-visible":this.isBeatmapsPopupVisible,"mobile-expanded":this.mobileExpanded});return this.showVisual&&(e+=" js-audio--player"),d.createElement("div",{ref:this.blockRef,className:e,"data-audio-url":this.props.beatmapset.preview_url,onMouseLeave:this.beatmapsPopupHide,style:{"--beatmaps-popup-transition-duration":"150ms"}},this.renderBeatmapsPopup(),this.renderCover(),d.createElement("div",{className:"beatmapset-panel__content"},this.renderPlayArea(),this.renderInfoArea(),this.renderMenuArea()),d.createElement("button",{className:"beatmapset-panel__mobile-expand",onClick:this.onMobileExpandToggleClick,type:"button"},d.createElement("span",{className:`fas fa-angle-${this.mobileExpanded?"up":"down"}`})))}renderBeatmapsPopup(){return d.createElement(p.a,{in:this.isBeatmapsPopupVisible,mountOnEnter:!0,timeout:{enter:0,exit:150},unmountOnExit:!0},e=>d.createElement(o.a,{ref:this.beatmapsPopupRef,groupedBeatmaps:this.groupedBeatmaps,onMouseEnter:this.onBeatmapsPopupEnter,onMouseLeave:this.onBeatmapsPopupLeave,parent:this.blockRef.current,state:e,transitionDuration:150}))}renderCover(){return d.createElement("a",{className:"beatmapset-panel__cover-container",href:this.url},d.createElement("div",{className:"beatmapset-panel__cover-col beatmapset-panel__cover-col--play"},d.createElement("div",{className:"beatmapset-panel__cover beatmapset-panel__cover--default"}),this.showVisual&&d.createElement("img",{className:"beatmapset-panel__cover",onError:E,src:Object(g.c)(this.props.beatmapset.covers.list)})),d.createElement("div",{className:"beatmapset-panel__cover-col beatmapset-panel__cover-col--info"},d.createElement("div",{className:"beatmapset-panel__cover beatmapset-panel__cover--default"}),this.showVisual&&d.createElement(n.a,{className:"beatmapset-panel__cover",onError:E,src:this.props.beatmapset.covers.card})))}renderInfoArea(){return d.createElement("div",{className:"beatmapset-panel__info"},d.createElement("div",{className:"beatmapset-panel__info-row beatmapset-panel__info-row--title"},d.createElement("a",{className:"beatmapset-panel__main-link u-ellipsis-overflow",href:this.url},b.e(this.props.beatmapset)),this.props.beatmapset.nsfw&&d.createElement(N,null)),d.createElement("div",{className:"beatmapset-panel__info-row beatmapset-panel__info-row--artist"},d.createElement("a",{className:"beatmapset-panel__main-link u-ellipsis-overflow",href:this.url},osu.trans("beatmapsets.show.details.by_artist",{artist:b.c(this.props.beatmapset)}))),d.createElement("div",{className:"beatmapset-panel__info-row beatmapset-panel__info-row--mapper"},d.createElement("div",{className:"u-ellipsis-overflow"},d.createElement(h.a,{mappings:{":mapper":d.createElement(k,{key:"mapper",beatmapset:this.props.beatmapset})},pattern:osu.trans("beatmapsets.show.details.mapped_by")}))),d.createElement("div",{className:"beatmapset-panel__info-row beatmapset-panel__info-row--stats"},this.showHypeCounts&&null!=this.props.beatmapset.hype&&d.createElement(T,{icon:"fas fa-bullhorn",title:osu.trans("beatmaps.hype.required_text",{current:osu.formatNumber(this.props.beatmapset.hype.current),required:osu.formatNumber(this.props.beatmapset.hype.required)}),value:this.props.beatmapset.hype.current}),this.showHypeCounts&&null!=this.nominations&&d.createElement(T,{icon:"fas fa-thumbs-up",title:osu.trans("beatmaps.nominations.required_text",{current:osu.formatNumber(this.nominations.current),required:osu.formatNumber(this.nominations.required)}),value:this.nominations.current}),d.createElement(T,{icon:"fas fa-play-circle",title:osu.trans("beatmaps.panel.playcount",{count:osu.formatNumber(this.props.beatmapset.play_count)}),value:this.props.beatmapset.play_count}),d.createElement(T,{icon:this.favourite.icon,title:osu.trans("beatmaps.panel.favourites",{count:osu.formatNumber(this.props.beatmapset.favourite_count)}),value:this.props.beatmapset.favourite_count}),d.createElement("div",{className:"beatmapset-panel__stats-item"},d.createElement("span",{className:"beatmapset-panel__stats-item-icon"},d.createElement("i",{className:"fas fa-fw fa-check-circle"})),d.createElement(m.a,{dateTime:this.displayDate}))),d.createElement("a",{className:"beatmapset-panel__info-row beatmapset-panel__info-row--extra",href:this.url,onMouseEnter:this.onExtraRowEnter,onMouseLeave:this.onExtraRowLeave},d.createElement("div",{className:"beatmapset-panel__extra-item"},d.createElement("div",{className:"beatmapset-status beatmapset-status--panel",style:{"--bg":`var(--beatmapset-${this.props.beatmapset.status}-bg)`,"--colour":`var(--beatmapset-${this.props.beatmapset.status}-colour)`}},osu.trans(`beatmapsets.show.status.${this.props.beatmapset.status}`))),this.groupedBeatmaps.map(e=>d.createElement(j,{key:e.mode,compact:this.beatmapDotsCompact,group:e}))))}renderMenuArea(){return d.createElement("div",{className:"beatmapset-panel__menu-container"},d.createElement("div",{className:"beatmapset-panel__menu"},null==currentUser.id?d.createElement("span",{className:"beatmapset-panel__menu-item beatmapset-panel__menu-item--disabled",title:osu.trans("beatmapsets.show.details.favourite_login")},d.createElement("span",{className:this.favourite.icon})):d.createElement("button",{className:"beatmapset-panel__menu-item",onClick:this.toggleFavourite,title:osu.trans(`beatmapsets.show.details.${this.favourite.toggleTitleVariant}`),type:"button"},d.createElement("span",{className:this.favourite.icon})),null==this.downloadLink.url?d.createElement("span",{className:"beatmapset-panel__menu-item beatmapset-panel__menu-item--disabled",title:this.downloadLink.title},d.createElement("span",{className:"fas fa-file-download"})):d.createElement("a",{className:"beatmapset-panel__menu-item","data-turbolinks":"false",href:this.downloadLink.url,title:this.downloadLink.title},d.createElement("span",{className:"fas fa-file-download"}))))}renderPlayArea(){return d.createElement("div",{className:"beatmapset-panel__play-container"},this.showVisual&&d.createElement("button",{className:"beatmapset-panel__play js-audio--play",type:"button"}),d.createElement("div",{className:"beatmapset-panel__play-progress"},d.createElement(i.a,{current:0,ignoreProgress:!0,max:1,onlyShowAsWarning:!1,theme:"beatmapset-panel"})),d.createElement("div",{className:"beatmapset-panel__play-icons"},this.props.beatmapset.video&&d.createElement(S,{icon:"fas fa-film",titleVariant:"video"}),this.props.beatmapset.storyboard&&d.createElement(S,{icon:"fas fa-image",titleVariant:"storyboard"})))}};_([l.m],P.prototype,"beatmapsPopupHover",void 0),_([l.m],P.prototype,"mobileExpanded",void 0),_([l.e],P.prototype,"beatmapDotsCompact",null),_([l.e],P.prototype,"displayDate",null),_([l.e],P.prototype,"downloadLink",null),_([l.e],P.prototype,"favourite",null),_([l.e],P.prototype,"groupedBeatmaps",null),_([l.e],P.prototype,"isBeatmapsPopupVisible",null),_([l.e],P.prototype,"nominations",null),_([l.e],P.prototype,"showHypeCounts",null),_([l.e],P.prototype,"showVisual",null),_([l.e],P.prototype,"url",null),P=_([c.e],P),t.a=P}).call(this,s("5wds"))},mQSo:function(e,t,s){"use strict";(function(e,o){s.d(t,"a",(function(){return p}));var i,n,r=s("/G9H"),a=s("I8Ok"),l=s("mk7q"),c=s("peKF"),u=function(e,t){return function(){return e.apply(t,arguments)}},d={}.hasOwnProperty;n=r.createElement,i="beatmapset-mapping";var p=function(t){function s(){return this.renderDate=u(this.renderDate,this),this.render=u(this.render,this),s.__super__.constructor.apply(this,arguments)}return function(e,t){for(var s in t)d.call(t,s)&&(e[s]=t[s]);function o(){this.constructor=e}o.prototype=t.prototype,e.prototype=new o,e.__super__=t.prototype}(s,t),s.prototype.render=function(){var e,t,s;return s={id:this.props.beatmapset.user_id,username:this.props.beatmapset.creator,avatar_url:null!=(e=null!=(t=this.props.user)?t:this.props.beatmapset.user)?e.avatar_url:void 0},Object(a.div)({className:i},null!=s.id?Object(a.a)({href:laroute.route("users.show",{user:s.id}),className:"avatar avatar--beatmapset",style:{backgroundImage:osu.urlPresence(s.avatar_url)}}):Object(a.span)({className:"avatar avatar--beatmapset avatar--guest"}),Object(a.div)({className:i+"__content"},Object(a.div)({className:i+"__mapper",dangerouslySetInnerHTML:{__html:osu.trans("beatmapsets.show.details.mapped_by",{mapper:this.userLink(s)})}}),this.renderDate("submitted","submitted_date"),this.props.beatmapset.ranked>0?this.renderDate(this.props.beatmapset.status,"ranked_date"):this.renderDate("updated","last_updated")))},s.prototype.renderDate=function(t,s){return Object(a.div)(null,n(l.a,{pattern:osu.trans("beatmapsets.show.details_date."+t),mappings:{":timeago":Object(a.strong)({key:"timeago"},n(c.a,{dateTime:this.props.beatmapset[s],relative:Math.abs(e().diff(e(this.props.beatmapset[s]),"weeks"))<4}))}}))},s.prototype.userLink=function(e){var t;return null!=e.id?laroute.link_to_route("users.show",e.username,{user:e.id},{class:i+"__user js-usercard","data-user-id":e.id}):"<span class='"+i+"__user'>"+o.escape(null!=(t=e.username)?t:osu.trans("users.deleted"))+"</span>"},s}(r.PureComponent)}).call(this,s("7EfK"),s("Hs9Z"))},mjdM:function(e,t,s){"use strict";var o=s("cF9b"),i=s("h/Ip"),n=s("8Xmz"),r=s("9zVE"),a=s("/G9H"),l=function(e,t,s,o){var i,n=arguments.length,r=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,s):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,s,o);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(r=(n<3?i(r):n>3?i(t,s,r):i(t,s))||r);return n>3&&r&&Object.defineProperty(t,s,r),r};let c=class extends a.Component{constructor(){super(...arguments),this.handleContainerClick=e=>{osu.isClickable(e.target)||null!=this.props.markRead&&this.props.markRead()}}get canMarkAsRead(){var e;return null!==(e=this.props.canMarkAsRead)&&void 0!==e?e:this.props.item.canMarkRead}render(){return a.createElement("div",{className:this.blockClass(),onClick:this.handleContainerClick},this.renderCover(),a.createElement("div",{className:"notification-popup-item__main"},a.createElement("div",{className:"notification-popup-item__content"},this.renderCategory(),this.renderMessage(),this.renderTime(),this.renderExpandButton()),this.renderMarkAsReadButton(),this.renderDeleteButton()),this.renderUnreadStripe())}blockClass(){const e=[...this.props.modifiers,this.props.item.category];return this.props.item.isRead&&!this.props.canMarkAsRead&&e.push("read"),`clickable-row ${osu.classWithModifiers("notification-popup-item",e)}`}renderCategory(){if(!this.props.withCategory)return null;const e=osu.trans(`notifications.item.${this.props.item.displayType}.${this.props.item.category}._`);return""===e?null:a.createElement("div",{className:"notification-popup-item__row notification-popup-item__row--category"},e)}renderCover(){const e=this.props.withCoverImage?this.props.item.details.coverUrl:null;return a.createElement("div",{className:"notification-popup-item__cover",style:{backgroundImage:osu.urlPresence(e)}},a.createElement("div",{className:"notification-popup-item__cover-overlay"},this.renderCoverIcons()))}renderCoverIcons(){return null==this.props.icons?null:this.props.icons.map(e=>a.createElement("div",{key:e,className:"notification-popup-item__cover-icon"},a.createElement("span",{className:e})))}renderDeleteButton(){var e;return this.context.isWidget?null:a.createElement(n.a,{isDeleting:null!==(e=this.props.isDeleting)&&void 0!==e?e:this.props.item.isDeleting,modifiers:["fancy"],onDelete:this.props.delete})}renderExpandButton(){return null==this.props.expandButton?null:a.createElement("div",{className:"notification-popup-item__row notification-popup-item__row--expand"},this.props.expandButton)}renderMarkAsReadButton(){var e;return this.canMarkAsRead?a.createElement(r.a,{isMarkingAsRead:null!==(e=this.props.isMarkingAsRead)&&void 0!==e?e:this.props.item.isMarkingAsRead,modifiers:["fancy"],onMarkAsRead:this.props.markRead}):null}renderMessage(){return a.createElement("a",{className:"notification-popup-item__row notification-popup-item__row--message clickable-row-link",href:this.props.url,onClick:this.props.markRead},this.props.message)}renderTime(){if(null!=this.props.item.createdAtJson)return a.createElement("div",{className:"notification-popup-item__row notification-popup-item__row--time",dangerouslySetInnerHTML:{__html:osu.timeago(this.props.item.createdAtJson)}})}renderUnreadStripe(){return this.context.isWidget||!this.canMarkAsRead?null:a.createElement("span",{className:"notification-popup-item__unread-stripe"})}};c.contextType=i.a,c=l([o.e],c),t.a=c},mk7q:function(e,t,s){"use strict";s.d(t,"a",(function(){return i}));var o=s("/G9H");function i(e){const t=Object.keys(e.mappings),s=new RegExp(`(${t.join("|")})`),i=e.pattern.split(s);return o.createElement(o.Fragment,null,i.map(t=>e.mappings[t]?e.mappings[t]:t))}},mkgZ:function(e,t,s){"use strict";s.d(t,"a",(function(){return o}));class o{}},nN9y:function(e,t,s){"use strict";var o=s("iRgH"),i=s("WLnA"),n=s("Hs9Z"),r=s("EaLk"),a=s("bfq+");let l=class{constructor(e){this.channelStore=e,this.api=new a.a,this.lastHistoryId=null,this.pollingEnabled=!0,this.pollTime=1e3,this.pollTimeIdle=5e3,this.updateXHR=!1,this.windowIsActive=!0,this.pollForUpdates=()=>{this.updateXHR||(this.updateXHR=!0,this.api.getUpdates(this.channelStore.lastPolledMessageId,this.lastHistoryId).then(e=>{this.updateXHR=!1,this.pollingEnabled&&(this.updateTimerId=window.setTimeout(this.pollForUpdates,this.pollingTime())),e&&Object(r.q)(()=>{var t;const s=null===(t=Object(n.maxBy)(e.silences,"id"))||void 0===t?void 0:t.id;null!=s&&(this.lastHistoryId=s),this.channelStore.updateWithJson(e)})}).catch(e=>{this.updateXHR=!1,this.pollingEnabled&&(this.updateTimerId=window.setTimeout(this.pollForUpdates,this.pollingTime()))}))}}handleDispatchAction(e){e instanceof o.b?this.windowIsActive=!0:e instanceof o.a&&(this.windowIsActive=!1)}pollingTime(){return this.windowIsActive?this.pollTime:this.pollTimeIdle}startPolling(){this.updateTimerId||(this.updateTimerId=window.setTimeout(this.pollForUpdates,this.pollingTime()))}stopPolling(){this.updateTimerId&&(window.clearTimeout(this.updateTimerId),this.updateTimerId=void 0,this.updateXHR=!1)}};l=function(e,t,s,o){var i,n=arguments.length,r=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,s):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,s,o);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(r=(n<3?i(r):n>3?i(t,s,r):i(t,s))||r);return n>3&&r&&Object.defineProperty(t,s,r),r}([i.b],l),t.a=l},nxXY:function(e,t,s){"use strict";function o(e){return`${e.objectType}-${e.objectId}-${e.category}`}function i(e){return null!=e.objectId&&null!=e.category?null!=e.id?"notification":"stack":"type"}function n(e){return{category:e.category,id:e.id,objectId:e.object_id,objectType:e.object_type}}function r(e){return{category:e.category,id:e.id,object_id:e.objectId,object_type:e.objectType}}function a(e){return`${e.objectType}-${e.objectId}-${e.category}-${e.id}`}s.d(t,"c",(function(){return o})),s.d(t,"b",(function(){return i})),s.d(t,"a",(function(){return n})),s.d(t,"d",(function(){return r})),s.d(t,"e",(function(){return a}))},o0W1:function(e,t,s){e.exports=function(){var e=Object.prototype.hasOwnProperty,t=Array.isArray,s=function(){for(var e=[],t=0;t<256;++t)e.push("%"+((t<16?"0":"")+t.toString(16)).toUpperCase());return e}(),o=function(e,t){for(var s=t&&t.plainObjects?Object.create(null):{},o=0;o<e.length;++o)void 0!==e[o]&&(s[o]=e[o]);return s},i={arrayToObject:o,assign:function(e,t){return Object.keys(t).reduce((function(e,s){return e[s]=t[s],e}),e)},combine:function(e,t){return[].concat(e,t)},compact:function(e){for(var s=[{obj:{o:e},prop:"o"}],o=[],i=0;i<s.length;++i)for(var n=s[i],r=n.obj[n.prop],a=Object.keys(r),l=0;l<a.length;++l){var c=a[l],u=r[c];"object"==typeof u&&null!==u&&-1===o.indexOf(u)&&(s.push({obj:r,prop:c}),o.push(u))}return function(e){for(;e.length>1;){var s=e.pop(),o=s.obj[s.prop];if(t(o)){for(var i=[],n=0;n<o.length;++n)void 0!==o[n]&&i.push(o[n]);s.obj[s.prop]=i}}}(s),e},decode:function(e,t,s){var o=e.replace(/\+/g," ");if("iso-8859-1"===s)return o.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(o)}catch(e){return o}},encode:function(e,t,o){if(0===e.length)return e;var i=e;if("symbol"==typeof e?i=Symbol.prototype.toString.call(e):"string"!=typeof e&&(i=String(e)),"iso-8859-1"===o)return escape(i).replace(/%u[0-9a-f]{4}/gi,(function(e){return"%26%23"+parseInt(e.slice(2),16)+"%3B"}));for(var n="",r=0;r<i.length;++r){var a=i.charCodeAt(r);45===a||46===a||95===a||126===a||a>=48&&a<=57||a>=65&&a<=90||a>=97&&a<=122?n+=i.charAt(r):a<128?n+=s[a]:a<2048?n+=s[192|a>>6]+s[128|63&a]:a<55296||a>=57344?n+=s[224|a>>12]+s[128|a>>6&63]+s[128|63&a]:(a=65536+((1023&a)<<10|1023&i.charCodeAt(r+=1)),n+=s[240|a>>18]+s[128|a>>12&63]+s[128|a>>6&63]+s[128|63&a])}return n},isBuffer:function(e){return!(!e||"object"!=typeof e||!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e)))},isRegExp:function(e){return"[object RegExp]"===Object.prototype.toString.call(e)},maybeMap:function(e,s){if(t(e)){for(var o=[],i=0;i<e.length;i+=1)o.push(s(e[i]));return o}return s(e)},merge:function s(i,n,r){if(!n)return i;if("object"!=typeof n){if(t(i))i.push(n);else{if(!i||"object"!=typeof i)return[i,n];(r&&(r.plainObjects||r.allowPrototypes)||!e.call(Object.prototype,n))&&(i[n]=!0)}return i}if(!i||"object"!=typeof i)return[i].concat(n);var a=i;return t(i)&&!t(n)&&(a=o(i,r)),t(i)&&t(n)?(n.forEach((function(t,o){if(e.call(i,o)){var n=i[o];n&&"object"==typeof n&&t&&"object"==typeof t?i[o]=s(n,t,r):i.push(t)}else i[o]=t})),i):Object.keys(n).reduce((function(t,o){var i=n[o];return t[o]=e.call(t,o)?s(t[o],i,r):i,t}),a)}},n=String.prototype.replace,r=/%20/g,a={RFC1738:"RFC1738",RFC3986:"RFC3986"},l=i.assign({default:a.RFC3986,formatters:{RFC1738:function(e){return n.call(e,r,"+")},RFC3986:function(e){return String(e)}}},a),c=Object.prototype.hasOwnProperty,u={brackets:function(e){return e+"[]"},comma:"comma",indices:function(e,t){return e+"["+t+"]"},repeat:function(e){return e}},d=Array.isArray,p=Array.prototype.push,h=function(e,t){p.apply(e,d(t)?t:[t])},m=Date.prototype.toISOString,f=l.default,b={addQueryPrefix:!1,allowDots:!1,charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encoder:i.encode,encodeValuesOnly:!1,format:f,formatter:l.formatters[f],indices:!1,serializeDate:function(e){return m.call(e)},skipNulls:!1,strictNullHandling:!1},v=function e(t,s,o,n,r,a,l,c,u,p,m,f,v){var y,g=t;if("function"==typeof l?g=l(s,g):g instanceof Date?g=p(g):"comma"===o&&d(g)&&(g=i.maybeMap(g,(function(e){return e instanceof Date?p(e):e})).join(",")),null===g){if(n)return a&&!f?a(s,b.encoder,v,"key"):s;g=""}if("string"==typeof(y=g)||"number"==typeof y||"boolean"==typeof y||"symbol"==typeof y||"bigint"==typeof y||i.isBuffer(g))return a?[m(f?s:a(s,b.encoder,v,"key"))+"="+m(a(g,b.encoder,v,"value"))]:[m(s)+"="+m(String(g))];var _,w=[];if(void 0===g)return w;if(d(l))_=l;else{var E=Object.keys(g);_=c?E.sort(c):E}for(var O=0;O<_.length;++O){var j=_[O],k=g[j];if(!r||null!==k){var N=d(g)?"function"==typeof o?o(s,j):s:s+(u?"."+j:"["+j+"]");h(w,e(k,N,o,n,r,a,l,c,u,p,m,f,v))}}return w},y=Object.prototype.hasOwnProperty,g=Array.isArray,_={allowDots:!1,allowPrototypes:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decoder:i.decode,delimiter:"&",depth:5,ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictNullHandling:!1},w=function(e){return e.replace(/&#(\d+);/g,(function(e,t){return String.fromCharCode(parseInt(t,10))}))},E=function(e,t){return e&&"string"==typeof e&&t.comma&&e.indexOf(",")>-1?e.split(","):e},O=function(e,t,s,o){if(e){var i=s.allowDots?e.replace(/\.([^.[]+)/g,"[$1]"):e,n=/(\[[^[\]]*])/g,r=s.depth>0&&/(\[[^[\]]*])/.exec(i),a=r?i.slice(0,r.index):i,l=[];if(a){if(!s.plainObjects&&y.call(Object.prototype,a)&&!s.allowPrototypes)return;l.push(a)}for(var c=0;s.depth>0&&null!==(r=n.exec(i))&&c<s.depth;){if(c+=1,!s.plainObjects&&y.call(Object.prototype,r[1].slice(1,-1))&&!s.allowPrototypes)return;l.push(r[1])}return r&&l.push("["+i.slice(r.index)+"]"),function(e,t,s,o){for(var i=o?t:E(t,s),n=e.length-1;n>=0;--n){var r,a=e[n];if("[]"===a&&s.parseArrays)r=[].concat(i);else{r=s.plainObjects?Object.create(null):{};var l="["===a.charAt(0)&&"]"===a.charAt(a.length-1)?a.slice(1,-1):a,c=parseInt(l,10);s.parseArrays||""!==l?!isNaN(c)&&a!==l&&String(c)===l&&c>=0&&s.parseArrays&&c<=s.arrayLimit?(r=[])[c]=i:r[l]=i:r={0:i}}i=r}return i}(l,t,s,o)}},j=function(e,t){var s=function(e){if(!e)return _;if(null!=e.decoder&&"function"!=typeof e.decoder)throw new TypeError("Decoder has to be a function.");if(void 0!==e.charset&&"utf-8"!==e.charset&&"iso-8859-1"!==e.charset)throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");return{allowDots:void 0===e.allowDots?_.allowDots:!!e.allowDots,allowPrototypes:"boolean"==typeof e.allowPrototypes?e.allowPrototypes:_.allowPrototypes,arrayLimit:"number"==typeof e.arrayLimit?e.arrayLimit:_.arrayLimit,charset:void 0===e.charset?_.charset:e.charset,charsetSentinel:"boolean"==typeof e.charsetSentinel?e.charsetSentinel:_.charsetSentinel,comma:"boolean"==typeof e.comma?e.comma:_.comma,decoder:"function"==typeof e.decoder?e.decoder:_.decoder,delimiter:"string"==typeof e.delimiter||i.isRegExp(e.delimiter)?e.delimiter:_.delimiter,depth:"number"==typeof e.depth||!1===e.depth?+e.depth:_.depth,ignoreQueryPrefix:!0===e.ignoreQueryPrefix,interpretNumericEntities:"boolean"==typeof e.interpretNumericEntities?e.interpretNumericEntities:_.interpretNumericEntities,parameterLimit:"number"==typeof e.parameterLimit?e.parameterLimit:_.parameterLimit,parseArrays:!1!==e.parseArrays,plainObjects:"boolean"==typeof e.plainObjects?e.plainObjects:_.plainObjects,strictNullHandling:"boolean"==typeof e.strictNullHandling?e.strictNullHandling:_.strictNullHandling}}(t);if(""===e||null==e)return s.plainObjects?Object.create(null):{};for(var o="string"==typeof e?function(e,t){var s,o={},n=(t.ignoreQueryPrefix?e.replace(/^\?/,""):e).split(t.delimiter,1/0===t.parameterLimit?void 0:t.parameterLimit),r=-1,a=t.charset;if(t.charsetSentinel)for(s=0;s<n.length;++s)0===n[s].indexOf("utf8=")&&("utf8=%E2%9C%93"===n[s]?a="utf-8":"utf8=%26%2310003%3B"===n[s]&&(a="iso-8859-1"),r=s,s=n.length);for(s=0;s<n.length;++s)if(s!==r){var l,c,u=n[s],d=u.indexOf("]="),p=-1===d?u.indexOf("="):d+1;-1===p?(l=t.decoder(u,_.decoder,a,"key"),c=t.strictNullHandling?null:""):(l=t.decoder(u.slice(0,p),_.decoder,a,"key"),c=i.maybeMap(E(u.slice(p+1),t),(function(e){return t.decoder(e,_.decoder,a,"value")}))),c&&t.interpretNumericEntities&&"iso-8859-1"===a&&(c=w(c)),u.indexOf("[]=")>-1&&(c=g(c)?[c]:c),o[l]=y.call(o,l)?i.combine(o[l],c):c}return o}(e,s):e,n=s.plainObjects?Object.create(null):{},r=Object.keys(o),a=0;a<r.length;++a){var l=r[a],c=O(l,o[l],s,"string"==typeof e);n=i.merge(n,c,s)}return i.compact(n)};class k{constructor(e,t,s){var o;this.name=e,this.definition=t,this.bindings=null!=(o=t.bindings)?o:{},this.config=s}get template(){return((this.config.absolute?this.definition.domain?""+this.config.url.match(/^\w+:\/\//)[0]+this.definition.domain+(this.config.port?":"+this.config.port:""):this.config.url:"")+"/"+this.definition.uri).replace(/\/+$/,"")}get parameterSegments(){var e,t;return null!=(e=null===(t=this.template.match(/{[^}?]+\??}/g))||void 0===t?void 0:t.map(e=>({name:e.replace(/{|\??}/g,""),required:!/\?}$/.test(e)})))?e:[]}matchesUrl(e){if(!this.definition.methods.includes("GET"))return!1;const t=this.template.replace(/\/{[^}?]*\?}/g,"(/[^/?]+)?").replace(/{[^}]+}/g,"[^/?]+").replace(/^\w+:\/\//,"");return new RegExp("^"+t+"$").test(e.replace(/\/+$/,"").split("?").shift())}compile(e){return this.parameterSegments.length?this.template.replace(/{([^}?]+)\??}/g,(t,s)=>{var o;if([null,void 0].includes(e[s])&&this.parameterSegments.find(({name:e})=>e===s).required)throw new Error("Ziggy error: '"+s+"' parameter is required for route '"+this.name+"'.");return encodeURIComponent(null!=(o=e[s])?o:"")}).replace(/\/+$/,""):this.template}}class N extends String{constructor(e,t,s=!0,o){var i;if(super(),this.t=null!=(i=null!=o?o:Ziggy)?i:null===globalThis||void 0===globalThis?void 0:globalThis.Ziggy,this.t={...this.t,absolute:s},e){if(!this.t.routes[e])throw new Error("Ziggy error: route '"+e+"' is not in the route list.");this.i=new k(e,this.t.routes[e],this.t),this.u=this.s(t)}}toString(){const e=Object.keys(this.u).filter(e=>!this.i.parameterSegments.some(({name:t})=>t===e)).filter(e=>"_query"!==e).reduce((e,t)=>({...e,[t]:this.u[t]}),{});return this.i.compile(this.u)+function(e,t){var s,o=e,i=function(e){if(!e)return b;if(null!=e.encoder&&"function"!=typeof e.encoder)throw new TypeError("Encoder has to be a function.");var t=e.charset||b.charset;if(void 0!==e.charset&&"utf-8"!==e.charset&&"iso-8859-1"!==e.charset)throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var s=l.default;if(void 0!==e.format){if(!c.call(l.formatters,e.format))throw new TypeError("Unknown format option provided.");s=e.format}var o=l.formatters[s],i=b.filter;return("function"==typeof e.filter||d(e.filter))&&(i=e.filter),{addQueryPrefix:"boolean"==typeof e.addQueryPrefix?e.addQueryPrefix:b.addQueryPrefix,allowDots:void 0===e.allowDots?b.allowDots:!!e.allowDots,charset:t,charsetSentinel:"boolean"==typeof e.charsetSentinel?e.charsetSentinel:b.charsetSentinel,delimiter:void 0===e.delimiter?b.delimiter:e.delimiter,encode:"boolean"==typeof e.encode?e.encode:b.encode,encoder:"function"==typeof e.encoder?e.encoder:b.encoder,encodeValuesOnly:"boolean"==typeof e.encodeValuesOnly?e.encodeValuesOnly:b.encodeValuesOnly,filter:i,formatter:o,serializeDate:"function"==typeof e.serializeDate?e.serializeDate:b.serializeDate,skipNulls:"boolean"==typeof e.skipNulls?e.skipNulls:b.skipNulls,sort:"function"==typeof e.sort?e.sort:null,strictNullHandling:"boolean"==typeof e.strictNullHandling?e.strictNullHandling:b.strictNullHandling}}(t);"function"==typeof i.filter?o=(0,i.filter)("",o):d(i.filter)&&(s=i.filter);var n=[];if("object"!=typeof o||null===o)return"";var r=u[t&&t.arrayFormat in u?t.arrayFormat:t&&"indices"in t?t.indices?"indices":"repeat":"indices"];s||(s=Object.keys(o)),i.sort&&s.sort(i.sort);for(var a=0;a<s.length;++a){var p=s[a];i.skipNulls&&null===o[p]||h(n,v(o[p],p,r,i.strictNullHandling,i.skipNulls,i.encode?i.encoder:null,i.filter,i.sort,i.allowDots,i.serializeDate,i.formatter,i.encodeValuesOnly,i.charset))}var m=n.join(i.delimiter),f=!0===i.addQueryPrefix?"?":"";return i.charsetSentinel&&(f+="iso-8859-1"===i.charset?"utf8=%26%2310003%3B&":"utf8=%E2%9C%93&"),m.length>0?f+m:""}({...e,...this.u._query},{addQueryPrefix:!0,arrayFormat:"indices",encodeValuesOnly:!0,skipNulls:!0,encoder:(e,t)=>"boolean"==typeof e?Number(e):t(e)})}current(e,t){const s=this.t.absolute?window.location.host+window.location.pathname:window.location.pathname.replace(this.t.url.replace(/^\w*:\/\/[^/]+/,""),"").replace(/^\/+/,"/"),[o,i]=Object.entries(this.t.routes).find(([t,o])=>new k(e,o,this.t).matchesUrl(s))||[void 0,void 0];if(!e)return o;const n=new RegExp("^"+e.replace(".","\\.").replace("*",".*")+"$").test(o);if([null,void 0].includes(t)||!n)return n;const r=new k(o,i,this.t);t=this.s(t,r);const a=this.l(i);return!(!Object.values(t).every(e=>!e)||Object.values(a).length)||Object.entries(t).every(([e,t])=>a[e]==t)}get params(){return this.l(this.t.routes[this.current()])}has(e){return Object.keys(this.t.routes).includes(e)}s(e={},t=this.i){e=["string","number"].includes(typeof e)?[e]:e;const s=t.parameterSegments.filter(({name:e})=>!this.t.defaults[e]);return Array.isArray(e)?e=e.reduce((e,t,o)=>{var i;return{...e,[null===(i=s[o])||void 0===i?void 0:i.name]:t}},{}):1!==s.length||e[s[0].name]||!e.hasOwnProperty(Object.values(t.bindings)[0])&&!e.hasOwnProperty("id")||(e={[s[0].name]:e}),{...this.p(t),...this.h(e,t.bindings)}}p(e){return e.parameterSegments.filter(({name:e})=>this.t.defaults[e]).reduce((e,{name:t},s)=>({...e,[t]:this.t.defaults[t]}),{})}h(e,t={}){return Object.entries(e).reduce((e,[s,o])=>{if(!o||"object"!=typeof o||Array.isArray(o)||"_query"===s)return{...e,[s]:o};if(!o.hasOwnProperty(t[s])){if(!o.hasOwnProperty("id"))throw new Error("Ziggy error: object passed as '"+s+"' parameter is missing route model binding key '"+t[s]+"'.");t[s]="id"}return{...e,[s]:o[t[s]]}},{})}l(e){var t;let s=window.location.pathname.replace(this.t.url.replace(/^\w*:\/\/[^/]+/,""),"").replace(/^\/+/,"");const o=(e,t="",s)=>{const[o,i]=[e,t].map(e=>e.split(s));return i.reduce((e,t,s)=>/^{[^}?]+\??}$/.test(t)&&o[s]?{...e,[t.replace(/^{|\??}$/g,"")]:o[s]}:e,{})};return{...o(window.location.host,e.domain,"."),...o(s,e.uri,"/"),...j(null===(t=window.location.search)||void 0===t?void 0:t.replace(/^\?/,""))}}valueOf(){return this.toString()}check(e){return this.has(e)}}return function(e,t,s,o){const i=new N(e,t,s,o);return e?i.toString():i}}()},oQBk:function(e,t,s){"use strict";var o=s("/G9H");const i=Object(o.createContext)({isFriendsPage:!1});t.a=i},ou1O:function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return i}));const o="//platform.enchant.com";class i{constructor(t){this.turbolinksReload=t,this.load=()=>{null!=document.querySelector(".enchant-help-center")&&(window.enchant=[],this.turbolinksReload.load(o))},this.showMessageWindow=e=>{e.preventDefault(),null!=window.enchant&&null!=window.enchant.messenger&&"function"==typeof window.enchant.messenger.open&&window.enchant.messenger.open()},this.unload=()=>{this.turbolinksReload.forget(o),e('#enchant-messenger-main, #enchant-messenger-launcher, iframe[src^="https://enchantwidgets-"]').remove(),document.querySelectorAll("style").forEach(t=>{const s=t.textContent;null!=s&&s.match(/#enchant-/)&&e(t).remove()})},e(document).on("turbolinks:load",this.load),e(document).on("turbolinks:before-cache",this.unload),e(document).on("click",".js-enchant--show",this.showMessageWindow)}}}).call(this,s("5wds"))},peKF:function(e,t,s){"use strict";s.d(t,"a",(function(){return r}));var o=s("7EfK"),i=s("/G9H"),n=function(e,t){var s={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(s[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(o=Object.getOwnPropertySymbols(e);i<o.length;i++)t.indexOf(o[i])<0&&Object.prototype.propertyIsEnumerable.call(e,o[i])&&(s[o[i]]=e[o[i]])}return s};function r(e){const{format:t="ll",relative:s=!1}=e,r=n(e,["format","relative"]),a=s?"js-timeago":"js-tooltip-time";return i.createElement("time",Object.assign({className:a,title:e.dateTime},r),o(e.dateTime).format(t))}},phBA:function(e,t,s){"use strict";(function(e){function o(t){if(t instanceof HTMLElement)return t instanceof HTMLFormElement?()=>e(t).submit():()=>t.click()}function i(e,t,s){if(null==e)return;const o=["","k","m","b","t"],i=e=>(null!=s||(s={}),null!=t&&(s.minimumFractionDigits=t,s.maximumFractionDigits=t),e.toLocaleString("en",s));if(e<1e3)return i(e);const n=Math.min(o.length-1,Math.floor(Math.log(e)/Math.log(1e3)));return`${i(e/Math.pow(1e3,n))}${o[n]}`}function n(e){if(null!=e)return e.replace(/(\.[^.]+)$/,"@2x$1")}s.d(t,"a",(function(){return o})),s.d(t,"b",(function(){return i})),s.d(t,"c",(function(){return n}))}).call(this,s("5wds"))},"qhp/":function(e,t,s){"use strict";s.d(t,"a",(function(){return l}));var o=s("0h6b"),i=s("Hs9Z"),n=s("srn7"),r=s("/G9H"),a=s("peKF");class l extends r.PureComponent{get beatmapsetId(){var e;return null===(e=this.props.event.beatmapset)||void 0===e?void 0:e.id}get discussionId(){var e;return null===(e=this.props.event.comment)||void 0===e?void 0:e.beatmap_discussion_id}get discussion(){var e,t,s;return null!==(e=this.props.event.discussion)&&void 0!==e?e:null===(t=this.props.discussions)||void 0===t?void 0:t[null!==(s=this.discussionId)&&void 0!==s?s:""]}get firstPost(){var e,t,s,o;return null!==(t=null===(e=this.discussion)||void 0===e?void 0:e.starting_post)&&void 0!==t?t:null===(o=null===(s=this.discussion)||void 0===s?void 0:s.posts)||void 0===o?void 0:o[0]}render(){return"discussions"===this.props.mode?this.renderDiscussionsVersion():this.renderProfileVersion()}renderDiscussionsVersion(){var e;const t=null!==(e=this.props.time)&&void 0!==e?e:this.props.event.created_at;return r.createElement("div",{className:"beatmapset-event"},r.createElement("div",{className:osu.classWithModifiers("beatmapset-event__icon",[Object(i.kebabCase)(this.props.event.type)])}),r.createElement("div",{className:"beatmapset-event__time"},r.createElement(a.a,{dateTime:t,format:"LT"})),r.createElement("div",{className:"beatmapset-event__content",dangerouslySetInnerHTML:{__html:this.contentText()}}))}renderProfileVersion(){var e,t;const s=null===(t=null===(e=this.props.event.beatmapset)||void 0===e?void 0:e.covers)||void 0===t?void 0:t.list;let n;return null!=this.beatmapsetId&&(n=Object(o.route)("beatmapsets.discussion",{beatmapset:this.beatmapsetId}),null!=this.discussionId&&(n=`${n}#/${this.discussionId}`)),r.createElement("div",{className:"beatmapset-event"},null!=n?r.createElement("a",{href:n},r.createElement("img",{className:"beatmapset-cover",src:s})):r.createElement("span",{className:"beatmapset-cover"},"beatmap deleted"),r.createElement("div",{className:osu.classWithModifiers("beatmapset-event__icon",[Object(i.kebabCase)(this.props.event.type),"beatmapset-activities"])}),r.createElement("div",null,r.createElement("div",{className:"beatmapset-event__content",dangerouslySetInnerHTML:{__html:this.contentText()}}),r.createElement("div",{className:"beatmap-discussion-post__info"},r.createElement(a.a,{dateTime:this.props.event.created_at,relative:!0}))))}contentText(){var e,t,s;let r,a="",l="[unknown user]",c="",u="";if(null!=this.discussionId){if(null==this.discussion)u=Object(o.route)("beatmapsets.discussions.show",{discussion:this.discussionId}),c=osu.trans("beatmapset_events.item.discussion_deleted");else{const t=null===(e=this.firstPost)||void 0===e?void 0:e.message;u=BeatmapDiscussionHelper.url({discussion:this.discussion}),c=null!=t?BeatmapDiscussionHelper.previewMessage(t):"[no preview]";const s=this.props.users[this.discussion.user_id];null!=s&&(l=osu.link(Object(o.route)("users.show",{user:s.id}),s.username))}a=osu.link(u,`#${this.discussionId}`,{classNames:["js-beatmap-discussion--jump"]})}else c=BeatmapDiscussionHelper.format(this.props.event.comment,{newlines:!1});if("discussion_lock"!==this.props.event.type&&"remove_from_loved"!==this.props.event.type||(c=BeatmapDiscussionHelper.format(this.props.event.comment.reason,{newlines:!1})),null!=this.props.event.user_id){const e=this.props.users[this.props.event.user_id];r=null==e?Object(i.escape)(n.b.username):osu.link(Object(o.route)("users.show",{user:e.id}),e.username)}const d=Object.assign({discussion:a,discussion_user:l,text:c,user:r},this.props.event.comment);let p="disqualify"===this.props.event.type&&null==this.discussion?"disqualify_legacy":this.props.event.type;if("nominate"===p&&(null===(t=this.props.event.comment)||void 0===t?void 0:t.modes.length)>0){p="nominate_modes";const e=this.props.event.comment.modes.map(e=>osu.trans(`beatmaps.mode.${e}`));d.modes=osu.transArray(e)}if("nsfw_toggle"===p){p+=`.${(null===(s=this.props.event.comment)||void 0===s?void 0:s.new)?"to_1":"to_0"}`}const h=`beatmapset_events.event.${p}`;let m=osu.trans(h,d);return null==r||osu.trans(h).includes(":user")||(m+=` (${r})`),m}}l.defaultProps={mode:"discussions"}},qpPZ:function(e,t,s){"use strict";s.d(t,"a",(function(){return n}));var o=s("/G9H"),i=s("PPOh");class n extends o.Component{render(){let e="header-v4";return this.props.theme&&(e+=` header-v4--${this.props.theme}`),currentUser.is_restricted&&(e+=" header-v4--restricted"),o.createElement("div",{className:e},o.createElement("div",{className:"header-v4__container header-v4__container--main"},o.createElement("div",{className:"header-v4__bg-container"},o.createElement("div",{className:"header-v4__bg",style:{backgroundImage:osu.urlPresence(this.props.backgroundImage)}})),this.props.isCoverUpdating&&o.createElement("div",{className:"header-v4__spinner"},o.createElement(i.a,null)),o.createElement("div",{className:"header-v4__content"},this.props.contentPrepend,o.createElement("div",{className:"header-v4__row header-v4__row--title"},o.createElement("div",{className:"header-v4__icon"}),o.createElement("div",{className:"header-v4__title"},this.title()),this.props.titleAppend),this.props.contentAppend)),this.props.links.length>0&&o.createElement("div",{className:"header-v4__container"},o.createElement("div",{className:"header-v4__content"},o.createElement("div",{className:"header-v4__row header-v4__row--bar"},this.renderLinks(),this.renderLinksMobile()))))}renderLinks(){const e=this.props.links.map(e=>{const t=[];return e.active&&t.push("active"),o.createElement("li",{key:`${e.url}-${e.title}`,className:"header-nav-v4__item"},o.createElement("a",Object.assign({className:osu.classWithModifiers("header-nav-v4__link",t),href:e.url,onClick:this.props.onLinkClick},e.data),o.createElement("span",{className:"fake-bold","data-content":e.title},e.title)))}),t=this.props.linksBreadcrumb?"ol":"ul",s=[];return s.push(this.props.linksBreadcrumb?"breadcrumb":"list"),o.createElement(t,{className:osu.classWithModifiers("header-nav-v4",s)},e)}renderLinksMobile(){if(this.props.linksBreadcrumb)return null;if(0===this.props.links.length)return null;let e=this.props.links[0];const t=this.props.links.map(t=>{const s=[];return t.active&&(s.push("active"),e=t),o.createElement("li",{key:`${t.url}-${t.title}`},o.createElement("a",Object.assign({className:"header-nav-mobile__item js-click-menu--close",href:t.url,onClick:this.props.onLinkClick},t.data),t.title))});return o.createElement("div",{className:"header-nav-mobile"},o.createElement("a",{className:"header-nav-mobile__toggle js-click-menu","data-click-menu-target":"header-nav-mobile",href:e.url},e.title,o.createElement("span",{className:"header-nav-mobile__toggle-icon"},o.createElement("span",{className:"fas fa-chevron-down"}))),o.createElement("ul",{className:"header-nav-mobile__menu js-click-menu","data-click-menu-id":"header-nav-mobile","data-visibility":"hidden"},t))}title(){const e=osu.parseJson("json-route-section");if(null!=e){const t=[`page_title.${e.namespace}.${e.controller}.${e.action}`,`page_title.${e.namespace}.${e.controller}._`,`page_title.${e.namespace}._`];for(const e of t)if(osu.transExists(e,fallbackLocale))return osu.trans(e)}return"unknown"}}n.defaultProps={links:[],linksBreadcrumb:!1}},rLgU:function(e,t,s){"use strict";s.d(t,"a",(function(){return i})),s.d(t,"g",(function(){return n})),s.d(t,"b",(function(){return r})),s.d(t,"c",(function(){return a})),s.d(t,"d",(function(){return l})),s.d(t,"h",(function(){return u})),s.d(t,"f",(function(){return p})),s.d(t,"e",(function(){return h}));var o=s("tSlR");const i=e=>e.length,n=e=>0===e.length||1===e.length&&"paragraph"===e[0].type&&1===e[0].children.length&&""===e[0].children[0].text,r=e=>{var t;return"embed"===(null===(t=c(e))||void 0===t?void 0:t.type)},a=e=>{const t=c(e);return!!t&&o.a.isEmpty(e,t)},l=(e,t)=>{const[s]=o.a.nodes(e,{match:e=>!0===e[t],mode:"all"});return!!s},c=e=>{if(e.selection)return o.c.parent(e,o.f.start(e.selection).path)},u=(e,t)=>{o.h.setNodes(e,{[t]:!l(e,t)||null},{match:e=>o.g.isText(e),split:!0})};function d(e){const t=[],s={bold:!1,italic:!1};return e.children.forEach(e=>{var o,i,n,r;""!==e.text&&(s.bold!==(null!==(o=e.bold)&&void 0!==o&&o)&&(s.bold=null!==(i=e.bold)&&void 0!==i&&i,t.push("**")),s.italic!==(null!==(n=e.italic)&&void 0!==n&&n)&&(s.italic=null!==(r=e.italic)&&void 0!==r&&r,t.push("*"))),t.push(e.text.replace("*","\\*"))}),s.bold&&t.push("**"),s.italic&&t.push("*"),t.join("")}const p=e=>e.some(e=>"embed"===e.type&&"problem"===e.discussionType&&!e.discussionId),h=e=>{const t=[];e.forEach(e=>{switch(e.type){case"paragraph":t.push({text:d(e),type:"paragraph"});break;case"embed":t.push(function(e){return e.discussionId?{discussion_id:e.discussionId,type:"embed"}:{beatmap_id:e.beatmapId,discussion_type:e.discussionType,text:e.children[0].text,timestamp:e.timestamp?BeatmapDiscussionHelper.parseTimestamp(e.timestamp):null,type:"embed"}}(e))}});const s=t[t.length-1];return"paragraph"!==s.type||osu.present(s.text)||t.pop(),JSON.stringify(t)}},sAkl:function(e,t,s){"use strict";s.d(t,"a",(function(){return n}));var o=s("0h6b"),i=s("/G9H");class n extends i.PureComponent{render(){let e="js-usercard";return null!=this.props.className&&(e+=` ${this.props.className}`),i.createElement("a",{className:e,"data-user-id":this.props.user.id,href:Object(o.route)("users.show",{user:this.props.user.id})},this.props.user.username)}}},sTr9:function(e,t,s){"use strict";s.d(t,"a",(function(){return r}));var o=s("Hs9Z"),i=s("EaLk"),n=function(e,t,s,o){var i,n=arguments.length,r=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,s):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,s,o);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(r=(n<3?i(r):n>3?i(t,s,r):i(t,s))||r);return n>3&&r&&Object.defineProperty(t,s,r),r};class r{constructor(e){this.firstMessageId=-1,this.inputText="",this.loaded=!1,this.loading=!1,this.loadingEarlierMessages=!1,this.messages=Object(i.m)([]),this.moderated=!1,this.name="",this.newPmChannel=!1,this.newPmChannelTransient=!1,this.type="NEW",this.users=[],this.updatePresence=e=>{this.updateWithJson(e),this.newPmChannelTransient&&(this.newPmChannelTransient=!1),this.setLastReadId(e.last_read_id)},this.channelId=e}get firstMessage(){return this.messages.length>0?this.messages[0]:void 0}get hasEarlierMessages(){return this.firstMessageId!==this.minMessageId}get isUnread(){return null!=this.lastReadId?this.lastMessageId>this.lastReadId:this.lastMessageId>-1}get lastMessage(){return this.messages[this.messages.length-1]}get lastMessageId(){var e;for(let t=this.messages.length-1;t>=0;t--)if("number"==typeof this.messages[t].messageId)return this.messages[t].messageId;return null!==(e=this.initialLastMessageId)&&void 0!==e?e:-1}get isDisplayable(){return this.name.length>0&&null!=this.icon}get minMessageId(){const e=this.messages.length>0?this.messages[0].messageId:void 0;return"number"==typeof e?e:-1}get pmTarget(){if("PM"===this.type)return this.users.find(e=>e!==currentUser.id)}get transient(){return"NEW"===this.type}static fromJson(e){const t=Object.create(r.prototype);return Object.assign(t,{channelId:e.channel_id,name:e.name,type:e.type,description:e.description,icon:e.icon,lastReadId:e.last_read_id})}static newPM(e,t){const s=new r(null!=t?t:-1);return s.newPmChannel=null==t,s.type="PM",s.name=e.username,s.icon=e.avatarUrl,s.users=[currentUser.id,e.id],s}addMessages(e,t=!1){this.messages.push(...e),t||this.resortMessages()}afterSendMesssage(e,t){null!=t?(e.messageId=t.message_id,e.timestamp=t.timestamp,e.persist(),this.setLastReadId(t.message_id)):e.errored=!0,this.resortMessages()}markAsRead(){this.setLastReadId(this.lastMessageId)}removeMessagesFromUserIds(e){this.messages=this.messages.filter(t=>!e.has(t.senderId))}setInputText(e){this.inputText=e}unload(){this.messages=Object(i.m)([])}updateWithJson(e){var t,s,o;this.name=e.name,this.description=e.description,this.type=e.type,this.icon=null!==(t=null==e?void 0:e.icon)&&void 0!==t?t:r.defaultIcon,this.moderated=e.moderated,this.users=null!==(s=e.users)&&void 0!==s?s:this.users,this.initialLastMessageId=null!==(o=e.last_message_id)&&void 0!==o?o:this.lastMessageId}resortMessages(){this.messages=o(this.messages).sortBy("timestamp").uniqBy("messageId").value()}setLastReadId(e){var t;e>(null!==(t=this.lastReadId)&&void 0!==t?t:0)&&(this.lastReadId=e)}}r.defaultIcon="/images/layout/chat/channel-default.png",n([i.m],r.prototype,"channelId",void 0),n([i.m],r.prototype,"description",void 0),n([i.m],r.prototype,"firstMessageId",void 0),n([i.m],r.prototype,"icon",void 0),n([i.m],r.prototype,"inputText",void 0),n([i.m],r.prototype,"lastReadId",void 0),n([i.m],r.prototype,"loaded",void 0),n([i.m],r.prototype,"loading",void 0),n([i.m],r.prototype,"loadingEarlierMessages",void 0),n([i.m],r.prototype,"messages",void 0),n([i.m],r.prototype,"moderated",void 0),n([i.m],r.prototype,"name",void 0),n([i.m],r.prototype,"newPmChannel",void 0),n([i.m],r.prototype,"type",void 0),n([i.m],r.prototype,"users",void 0),n([i.e],r.prototype,"firstMessage",null),n([i.e],r.prototype,"hasEarlierMessages",null),n([i.e],r.prototype,"isUnread",null),n([i.e],r.prototype,"lastMessage",null),n([i.e],r.prototype,"lastMessageId",null),n([i.e],r.prototype,"isDisplayable",null),n([i.e],r.prototype,"minMessageId",null),n([i.e],r.prototype,"pmTarget",null),n([i.e],r.prototype,"transient",null),n([i.d],r.prototype,"addMessages",null),n([i.d],r.prototype,"afterSendMesssage",null),n([i.d],r.prototype,"markAsRead",null),n([i.d],r.prototype,"removeMessagesFromUserIds",null),n([i.d],r.prototype,"setInputText",null),n([i.d],r.prototype,"unload",null),n([i.d],r.prototype,"updatePresence",void 0),n([i.d],r.prototype,"updateWithJson",null),n([i.d],r.prototype,"resortMessages",null),n([i.d],r.prototype,"setLastReadId",null)},srn7:function(e,t,s){"use strict";s.d(t,"a",(function(){return n})),s.d(t,"b",(function(){return r}));var o=s("EaLk"),i=function(e,t,s,o){var i,n=arguments.length,r=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,s):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,s,o);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(r=(n<3?i(r):n>3?i(t,s,r):i(t,s))||r);return n>3&&r&&Object.defineProperty(t,s,r),r};class n{constructor(e){this.avatarUrl="/images/layout/avatar-guest.png",this.countryCode="XX",this.defaultGroup="",this.isActive=!1,this.isBot=!1,this.isDeleted=!1,this.isOnline=!1,this.isSupporter=!1,this.lastVisit=null,this.loaded=!1,this.pmFriendsOnly=!1,this.profileColour="",this.username="",this.id=e}static fromJson(e){const t=Object.create(n.prototype);return Object.assign(t,{avatarUrl:e.avatar_url,countryCode:e.country_code,defaultGroup:e.default_group,groups:e.groups,id:e.id,isActive:e.is_active,isBot:e.is_bot,isOnline:e.is_online,isSupporter:e.is_supporter,loaded:!0,pmFriendsOnly:e.pm_friends_only,profileColour:e.profile_colour,username:e.username})}is(e){return null!=e&&e.id===this.id}load(){}toJson(){return{avatar_url:this.avatarUrl,country_code:this.countryCode,default_group:this.defaultGroup,groups:this.groups,id:this.id,is_active:this.isActive,is_bot:this.isBot,is_deleted:this.isDeleted,is_online:this.isOnline,is_supporter:this.isSupporter,last_visit:this.lastVisit,pm_friends_only:this.pmFriendsOnly,profile_colour:this.profileColour,username:this.username}}updateFromJson(e){var t;this.username=e.username,this.avatarUrl=e.avatar_url,this.profileColour=null!==(t=e.profile_colour)&&void 0!==t?t:"",this.countryCode=e.country_code,this.isSupporter=e.is_supporter,this.isActive=e.is_active,this.isBot=e.is_bot,this.isOnline=e.is_online,this.pmFriendsOnly=e.pm_friends_only,this.loaded=!0}}i([o.m],n.prototype,"avatarUrl",void 0),i([o.m],n.prototype,"countryCode",void 0),i([o.m],n.prototype,"defaultGroup",void 0),i([o.m],n.prototype,"groups",void 0),i([o.m],n.prototype,"id",void 0),i([o.m],n.prototype,"isActive",void 0),i([o.m],n.prototype,"isBot",void 0),i([o.m],n.prototype,"isDeleted",void 0),i([o.m],n.prototype,"isOnline",void 0),i([o.m],n.prototype,"isSupporter",void 0),i([o.m],n.prototype,"lastVisit",void 0),i([o.m],n.prototype,"loaded",void 0),i([o.m],n.prototype,"pmFriendsOnly",void 0),i([o.m],n.prototype,"profileColour",void 0),i([o.m],n.prototype,"username",void 0),i([o.d],n.prototype,"updateFromJson",null);const r=new n(-1);r.isDeleted=!0,r.username=osu.trans("users.deleted")},ss8h:function(e,t,s){"use strict";s.d(t,"a",(function(){return i}));var o=s("/G9H");const i=o.createContext(null)},stCr:function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return d}));var o,i,n=s("cF9b"),r=s("f4vq"),a=s("/G9H"),l=(s("I8Ok"),s("6e4D")),c=function(e,t){return function(){return e.apply(t,arguments)}},u={}.hasOwnProperty;o=a.createElement,i=r.a.dataStore.uiState;var d=function(t){function s(){return this.render=c(this.render,this),this.handleChange=c(this.handleChange,this),s.__super__.constructor.apply(this,arguments)}return function(e,t){for(var s in t)u.call(t,s)&&(e[s]=t[s]);function o(){this.constructor=e}o.prototype=t.prototype,e.prototype=new o,e.__super__=t.prototype}(s,t),s.prototype.handleChange=function(t){return e.publish("comments:sort",{sort:t.target.dataset.value})},s.prototype.render=function(){return o(n.a,null,(e=this,function(){var t;return o(l.a,{currentValue:null!=(t=i.comments.loadingSort)?t:i.comments.currentSort,modifiers:e.props.modifiers,onChange:e.handleChange,values:["new","old","top"]})}));var e},s}(a.PureComponent)}).call(this,s("5wds"))},svbn:function(e,t,s){"use strict";(function(e,o){s.d(t,"a",(function(){return b}));var i,n,r=s("Yin1"),a=s("6nUW"),l=s("f4vq"),c=s("/G9H"),u=s("LQV2"),d=s.n(u),p=s("I8Ok"),h=s("TY2o"),m=(s("phBA"),function(e,t){return function(){return e.apply(t,arguments)}}),f={}.hasOwnProperty;n=c.createElement,i="beatmap-discussion-post";var b=function(t){var s;function u(t){this.validPost=m(this.validPost,this),this.setMessage=m(this.setMessage,this),this.post=m(this.post,this),this.isTimeline=m(this.isTimeline,this),this.handleKeyDownCallback=m(this.handleKeyDownCallback,this),this.editStart=m(this.editStart,this),this.canResolve=m(this.canResolve,this),this.canReopen=m(this.canReopen,this),this.renderReplyButton=m(this.renderReplyButton,this),this.renderPlaceholder=m(this.renderPlaceholder,this),this.renderCancelButton=m(this.renderCancelButton,this),this.renderBox=m(this.renderBox,this),this.render=m(this.render,this),this.componentWillUnmount=m(this.componentWillUnmount,this),u.__super__.constructor.call(this,t),this.box=c.createRef(),this.throttledPost=e.throttle(this.post,1e3),this.handleKeyDown=InputHandler.textarea(this.handleKeyDownCallback),this.state={editing:!1,message:"",posting:null}}return function(e,t){for(var s in t)f.call(t,s)&&(e[s]=t[s]);function o(){this.constructor=e}o.prototype=t.prototype,e.prototype=new o,e.__super__=t.prototype}(u,t),s={reply_resolve:"fas fa-check",reply_reopen:"fas fa-exclamation-circle",reply:"fas fa-reply"},u.prototype.componentWillUnmount=function(){var e;return this.throttledPost.cancel(),null!=(e=this.postXhr)?e.abort():void 0},u.prototype.render=function(){return this.state.editing?this.renderBox():this.renderPlaceholder()},u.prototype.renderBox=function(){return Object(p.div)({className:i+" "+i+"--reply "+i+"--new-reply"},this.renderCancelButton(),Object(p.div)({className:i+"__content"},Object(p.div)({className:i+"__avatar"},n(h.a,{user:this.props.currentUser,modifiers:["full-rounded"]})),Object(p.div)({className:i+"__message-container"},n(d.a,{disabled:null!=this.state.posting,className:i+"__message "+i+"__message--editor",value:this.state.message,onChange:this.setMessage,onKeyDown:this.handleKeyDown,placeholder:osu.trans("beatmaps.discussions.reply_placeholder"),ref:this.box}))),Object(p.div)({className:i+"__footer "+i+"__footer--notice"},osu.trans("beatmaps.discussions.reply_notice"),n(r.a,{message:this.state.message,isTimeline:this.isTimeline()})),Object(p.div)({className:i+"__footer"},Object(p.div)({className:i+"__actions"},Object(p.div)({className:i+"__actions-group"},this.canResolve()&&!this.props.discussion.resolved?this.renderReplyButton("reply_resolve"):void 0,this.canReopen()&&this.props.discussion.resolved?this.renderReplyButton("reply_reopen"):void 0,this.renderReplyButton("reply")))))},u.prototype.renderCancelButton=function(){return Object(p.button)({className:i+"__action "+i+"__action--cancel",disabled:null!=this.state.posting,onClick:(e=this,function(){return e.setState({editing:!1})})},Object(p.i)({className:"fas fa-times"}));var e},u.prototype.renderPlaceholder=function(){var e,t,s,o;return o=(s=null!=this.props.currentUser.id?[osu.trans("beatmap_discussions.reply.open.user"),"fas fa-reply",this.props.currentUser.is_silenced]:[osu.trans("beatmap_discussions.reply.open.guest"),"fas fa-sign-in-alt",!1])[0],t=s[1],e=s[2],Object(p.div)({className:i+" "+i+"--reply "+i+"--new-reply "+i+"--new-reply-placeholder"},n(a.a,{text:o,icon:t,modifiers:["beatmap-discussion-reply-open"],props:{disabled:e,onClick:this.editStart}}))},u.prototype.renderReplyButton=function(e){return Object(p.div)({className:i+"__action"},n(a.a,{text:osu.trans("common.buttons."+e),icon:s[e],isBusy:this.state.posting===e,props:{disabled:!this.validPost()||null!=this.state.posting,onClick:this.throttledPost,"data-action":e}}))},u.prototype.canReopen=function(){return this.props.discussion.can_be_resolved&&this.props.discussion.current_user_attributes.can_reopen},u.prototype.canResolve=function(){return this.props.discussion.can_be_resolved&&this.props.discussion.current_user_attributes.can_resolve},u.prototype.editStart=function(){var e;if(!l.a.userLogin.showIfGuest(this.editStart))return this.setState({editing:!0},(e=this,function(){var t;return null!=(t=e.box.current)?t.focus():void 0}))},u.prototype.handleKeyDownCallback=function(e,t){switch(e){case InputHandler.CANCEL:return this.setState({editing:!1});case InputHandler.SUBMIT:return this.throttledPost(t)}},u.prototype.isTimeline=function(){return null!=this.props.discussion.timestamp},u.prototype.post=function(e){var t,s,i,n,r;if(this.validPost())return LoadingOverlay.show(),null!=(s=this.postXhr)&&s.abort(),t=null!=(i=e.currentTarget.dataset.action)?i:"reply",this.setState({posting:t}),n=function(){switch(t){case"reply_resolve":return!0;case"reply_reopen":return!1;default:return null}}(),this.postXhr=o.ajax(laroute.route("beatmapsets.discussions.posts.store"),{method:"POST",data:{beatmap_discussion_id:this.props.discussion.id,beatmap_discussion:null!=n?{resolved:n}:{},beatmap_discussion_post:{message:this.state.message}}}).done((r=this,function(e){return r.setState({message:"",editing:!1}),o.publish("beatmapDiscussionPost:markRead",{id:e.beatmap_discussion_post_ids}),o.publish("beatmapsetDiscussions:update",{beatmapset:e.beatmapset})})).fail(osu.ajaxError).always(function(e){return function(){return LoadingOverlay.hide(),e.setState({posting:null})}}(this))},u.prototype.setMessage=function(e){return this.setState({message:e.target.value})},u.prototype.validPost=function(){return BeatmapDiscussionHelper.validMessageLength(this.state.message,this.isTimeline())},u}(c.PureComponent)}).call(this,s("Hs9Z"),s("5wds"))},"tX/w":function(e,t,s){"use strict";s.d(t,"a",(function(){return i}));var o=s("Hs9Z");function i(e,t,s=!1){let i=s?"":e;return null!=t&&(Array.isArray(t)?t.forEach(t=>{null!=t&&(i+=` ${e}--${t}`)}):Object(o.forEach)(t,(t,s)=>{t&&(i+=` ${e}--${s}`)})),i}},tml4:function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return n}));var o=s("fqdx"),i=s("phBA");class n{constructor(t){this.captcha=t,this.show=t=>{this.callback=t,window.setTimeout(()=>{var t;e(document).trigger("gallery:close"),null===(t=e(".js-user-login--menu")[0])||void 0===t||t.click()},0)},this.showIfGuest=e=>null==currentUser.id&&(this.show(e),!0),this.showOnError=(e,t)=>{var s;return 401===e.status&&"basic"===(null===(s=e.responseJSON)||void 0===s?void 0:s.authentication)&&(null!=currentUser.id?osu.reloadPage():this.show(t),!0)},this.clearError=()=>{e(".js-login-form--error").text("")},this.loginError=(t,s)=>{t.preventDefault(),t.stopPropagation(),e(".js-login-form--error").text(osu.xhrErrorMessage(s)),window.setTimeout(()=>{var e;(null===(e=null==s?void 0:s.responseJSON)||void 0===e?void 0:e.captcha_triggered)&&this.captcha.trigger(),this.captcha.reset()},0)},this.loginSuccess=(t,s)=>{const o=this.callback;this.reset(),this.refreshToken(),e.publish("user:update",s.user),window.setTimeout(()=>{var t;null===(t=e(".js-user-login--menu")[0])||void 0===t||t.click(),e(".js-user-header").replaceWith(s.header),e(".js-user-header-popup").html(s.header_popup),this.captcha.untrigger(),(null!=o?o:osu.reloadPage)()},0)},this.onError=(e,t)=>{this.showOnError(t,Object(i.a)(e.target))},this.refreshToken=()=>{var t;const s=null!==(t=o.get("XSRF-TOKEN"))&&void 0!==t?t:null;e('[name="_token"]').attr("value",s),e('[name="csrf-token"]').attr("content",s)},this.reset=()=>{this.callback=void 0},this.showOnClick=e=>{e.preventDefault(),this.show()},this.showOnLoad=()=>{window.showLoginModal&&(window.showLoginModal=void 0,this.show())},this.showToContinue=e=>{if(null!=currentUser.id)return;e.preventDefault();const t=Object(i.a)(e.target);window.setTimeout(()=>{this.show(t)},0)},e(document).on("ajax:success",".js-login-form",this.loginSuccess).on("ajax:error",".js-login-form",this.loginError).on("submit",".js-login-form",this.clearError).on("input",".js-login-form-input",this.clearError).on("click",".js-user-link",this.showOnClick).on("click",".js-login-required--click",this.showToContinue).on("ajax:before",".js-login-required--click",()=>null!=currentUser.id).on("ajax:error",this.onError).on("turbolinks:load",this.showOnLoad),e.subscribe("nav:popup:hidden",this.reset)}}}).call(this,s("5wds"))},txhI:function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return l}));var o=s("/G9H"),i=s("I8Ok"),n=s("WKXC"),r=function(e,t){return function(){return e.apply(t,arguments)}},a={}.hasOwnProperty,l=function(t){function s(){this.renderPortalContent=r(this.renderPortalContent,this),this.render=r(this.render,this),this.hideModal=r(this.hideModal,this),this.handleMouseUp=r(this.handleMouseUp,this),this.handleMouseDown=r(this.handleMouseDown,this),this.handleEsc=r(this.handleEsc,this),this.componentWillUnmount=r(this.componentWillUnmount,this),this.componentDidUpdate=r(this.componentDidUpdate,this),this.componentDidMount=r(this.componentDidMount,this),this.ref=Object(o.createRef)()}return function(e,t){for(var s in t)a.call(t,s)&&(e[s]=t[s]);function o(){this.constructor=e}o.prototype=t.prototype,e.prototype=new o,e.__super__=t.prototype}(s,t),s.isOpen=function(){return document.body.classList.contains("js-react-modal---is-open")},s.prototype.close=function(){return document.body.classList.remove("js-react-modal---is-open"),Blackout.toggle(!1,.5)},s.prototype.componentDidMount=function(){var t;return document.body.appendChild(this.portal),document.addEventListener("keydown",this.handleEsc),e(document).on("turbolinks:before-cache.modal",(t=this,function(){return t.close(),document.body.removeChild(t.portal)})),this.props.visible?this.open():this.close()},s.prototype.componentDidUpdate=function(e){if(e.visible!==this.props.visible)return this.props.visible?this.open():this.close()},s.prototype.componentWillUnmount=function(){return this.close(),document.removeEventListener("keydown",this.handleEsc),e(document).off(".modal")},s.prototype.handleEsc=function(e){var t;if(27===e.keyCode)return"function"==typeof(t=this.props).onClose?t.onClose():void 0},s.prototype.handleMouseDown=function(e){return this.clickStartTarget=e.target},s.prototype.handleMouseUp=function(e){return this.clickEndTarget=e.target},s.prototype.hideModal=function(e){var t;if(0===e.button&&e.target===this.ref.current&&this.clickEndTarget===this.clickStartTarget)return"function"==typeof(t=this.props).onClose?t.onClose():void 0},s.prototype.open=function(){return document.body.classList.add("js-react-modal---is-open"),Blackout.toggle(!0,.5)},s.prototype.render=function(){return null==this.portal&&(this.portal=document.createElement("div")),Object(n.createPortal)(this.renderPortalContent(),this.portal)},s.prototype.renderPortalContent=function(){return Object(i.div)({className:"js-react-modal",onClick:this.hideModal,onMouseDown:this.handleMouseDown,onMouseUp:this.handleMouseUp,ref:this.ref},this.props.children)},s}(o.PureComponent)}).call(this,s("5wds"))},tz7b:function(e,t,s){"use strict";s.d(t,"a",(function(){return i}));var o=s("mkgZ");class i extends o.a{constructor(e){super(),this.message=e}}},"uW+8":function(e,t,s){"use strict";s.d(t,"b",(function(){return n})),s.d(t,"c",(function(){return r})),s.d(t,"a",(function(){return a})),s.d(t,"d",(function(){return l}));var o=s("mkgZ"),i=s("nxXY");class n extends o.a{constructor(e,t){super(),this.data=e,this.context=t}}class r extends o.a{constructor(e){super(),this.data=e}}class a extends o.a{constructor(e,t){super(),this.data=e,this.readCount=t}static fromJson(e){const t=e.data.notifications.map(e=>Object(i.a)(e));return new a(t,e.data.read_count)}}class l extends o.a{constructor(e,t){super(),this.data=e,this.readCount=t}static fromJson(e){const t=e.data.notifications.map(e=>Object(i.a)(e));return new l(t,e.data.read_count)}}},ubBH:function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return l})),s.d(t,"b",(function(){return c})),s.d(t,"c",(function(){return u}));var o=s("I8/e"),i=s("0h6b"),n=s("Hs9Z"),r=s("f4vq"),a=s("/jJF");function l(e,t){return Object(o.b)(e)?e[t]:Object(n.sum)(Object.values(e[t]))}function c(e){var t,s;return!e.nsfw||null!==(s=null===(t=null===currentUser||void 0===currentUser?void 0:currentUser.user_preferences)||void 0===t?void 0:t.beatmapset_show_nsfw)&&void 0!==s&&s}function u(t){const s=()=>u(t);if(r.a.userLogin.showIfGuest(s))return;const o=!t.has_favourited;t.has_favourited=o,t.favourite_count+=o?1:-1,e.ajax(Object(i.route)("beatmapsets.favourites.store",{beatmapset:t.id}),{data:{action:o?"favourite":"unfavourite"},method:"POST"}).fail((e,i)=>{t.has_favourited=!o,t.favourite_count+=o?-1:1,Object(a.a)(e,i,s)}).done(e=>{t.favourite_count=e.favourite_count})}}).call(this,s("5wds"))},ufn5:function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return O}));var o=s("ZJc0"),i=s("PQII"),n=s.n(i),r=s("0h6b"),a=s("Hs9Z"),l=s("/G9H"),c=s("tSlR"),u=s("21/t"),d=s("dTpI"),p=s("PPOh"),h=s("yun6"),m=s("ubBH"),f=s("5AHq"),b=s("BCxl"),v=s("rLgU"),y=s("/cS6"),g=s("BTwX"),_=s("XMjx"),w=s("6b0J"),E=s("ss8h");class O extends l.Component{constructor(t){super(t),this.bn="beatmap-discussion-editor",this.cache={},this.emptyDocTemplate=[{children:[{text:""}],type:"paragraph"}],this.blockWrapper=e=>l.createElement("div",{className:`${this.bn}__block`},e),this.decorateTimestamps=e=>{const[t,s]=e,o=[];if(!c.g.isText(t))return o;const i=RegExp(BeatmapDiscussionHelper.TIMESTAMP_REGEX,"g");let n;for(;null!==(n=i.exec(t.text));)o.push({anchor:{path:s,offset:n.index},focus:{path:s,offset:n.index+n[0].length},timestamp:n[0]});return o},this.isCurrentBeatmap=e=>null!=e&&e.beatmapset_id===this.props.beatmapset.id,this.onChange=e=>{if(0===e.length&&(e=this.emptyDocTemplate),!this.props.editMode){const t=JSON.stringify(e);Object(v.g)(e)?localStorage.removeItem(this.localStorageKey):localStorage.setItem(this.localStorageKey,t)}this.setState({blockCount:Object(v.a)(e),value:e},()=>{var e,t;d.b.isFocused(this.slateEditor)&&this.props.onFocus&&this.props.onFocus(),null===(t=(e=this.props).onChange)||void 0===t||t.call(e)})},this.onKeyDown=e=>{n()("mod+b",e)?(e.preventDefault(),Object(v.h)(this.slateEditor,"bold")):n()("mod+i",e)?(e.preventDefault(),Object(v.h)(this.slateEditor,"italic")):n()("shift+enter",e)?Object(v.b)(this.slateEditor)&&(e.preventDefault(),this.slateEditor.insertText("\n")):(n()("delete",e)||n()("backspace",e))&&Object(v.c)(this.slateEditor)&&(e.preventDefault(),c.h.removeNodes(this.slateEditor))},this.post=()=>{this.showConfirmationIfRequired()&&this.setState({posting:!0},()=>{this.xhr=e.ajax(Object(r.route)("beatmapsets.discussion.review",{beatmapset:this.props.beatmapset.id}),{data:{document:this.serialize()},method:"POST"}).done(t=>{e.publish("beatmapsetDiscussions:update",{beatmapset:t}),this.resetInput()}).fail(osu.ajaxError).always(()=>this.setState({posting:!1}))})},this.renderBlockCount=e=>l.createElement(o.a,{current:this.state.blockCount,max:this.context.max_blocks,onlyShowAsWarning:!0,theme:e,tooltip:osu.trans("beatmap_discussions.review.block_count",{used:this.state.blockCount,max:this.context.max_blocks})}),this.renderElement=e=>{let t;switch(e.element.type){case"embed":t=l.createElement(b.a,Object.assign({beatmaps:this.sortedBeatmaps(),beatmapset:this.props.beatmapset,currentBeatmap:this.props.currentBeatmap,discussions:this.props.discussions,editMode:this.props.editMode,readOnly:this.state.posting},e));break;default:t=e.children}return this.blockWrapper(t)},this.renderLeaf=e=>{let t=e.children;return e.leaf.bold&&(t=l.createElement("strong",Object.assign({},e.attributes),t)),e.leaf.italic&&(t=l.createElement("em",Object.assign({},e.attributes),t)),e.leaf.timestamp?l.createElement("span",Object.assign({className:"beatmap-discussion-timestamp-decoration"},e.attributes),t):l.createElement("span",Object.assign({},e.attributes),t)},this.resetInput=e=>{e&&(e.preventDefault(),!confirm(osu.trans("common.confirmation")))||(c.h.deselect(this.slateEditor),this.onChange(this.emptyDocTemplate))},this.serialize=()=>Object(v.e)(this.state.value),this.showConfirmationIfRequired=()=>{const e=Object(v.f)(this.state.value),t=currentUser.is_admin||currentUser.is_moderator||currentUser.is_full_bn,s="qualified"===this.props.beatmapset.status&&e,o=currentUser.is_admin||currentUser.is_nat||currentUser.is_bng,i="pending"===this.props.beatmapset.status&&this.props.beatmapset.nominations&&Object(m.a)(this.props.beatmapset.nominations,"current")>0&&e;return t&&s?confirm(osu.trans("beatmaps.nominations.reset_confirm.disqualify")):!o||!i||confirm(osu.trans("beatmaps.nominations.reset_confirm.nomination_reset"))},this.sortedBeatmaps=()=>{if(null==this.cache.sortedBeatmaps){const e=a.filter(this.props.beatmaps,this.isCurrentBeatmap);this.cache.sortedBeatmaps=Object(h.i)(e)}return this.cache.sortedBeatmaps},this.updateDrafts=()=>{this.cache.draftEmbeds=this.state.value.filter(e=>"embed"===e.type&&!e.discussion_id)},this.withNormalization=e=>{const{insertData:t,normalizeNode:s}=e;return e.insertData=s=>{Object(v.b)(this.slateEditor)?e.insertText(s.getData("text/plain")):t(s)},e.normalizeNode=t=>{const[o,i]=t;if(c.b.isElement(o)&&"embed"===o.type)for(const[s,n]of c.c.children(e,i)){if(c.b.isElement(s)&&!e.isInline(s))return void c.h.unwrapNodes(e,{at:n});if(s.bold||s.italic)return void c.h.unsetNodes(e,["bold","italic"],{at:n});if(null!=o.beatmapId){const t="number"==typeof o.beatmapId?this.props.beatmaps[o.beatmapId]:void 0;null!=t&&null==t.deleted_at||c.h.setNodes(e,{beatmapId:void 0},{at:i})}}s(t)},e},this.slateEditor=this.withNormalization(Object(u.a)(Object(d.d)(Object(c.i)()))),this.scrollContainerRef=l.createRef(),this.toolbarRef=l.createRef(),this.insertMenuRef=l.createRef(),this.localStorageKey=`newDiscussion-${this.props.beatmapset.id}`;let s=this.emptyDocTemplate;if(t.editMode)s=this.valueFromProps();else{const e=localStorage.getItem(this.localStorageKey);if(null!=e)try{s=JSON.parse(e)}catch(i){console.error("invalid json in localStorage, ignoring"),localStorage.removeItem(this.localStorageKey)}}this.state={blockCount:Object(v.a)(s),posting:!1,value:s}}get canSave(){return!this.state.posting&&this.state.blockCount<=this.context.max_blocks}componentDidMount(){this.scrollContainerRef.current&&(this.toolbarRef.current&&this.toolbarRef.current.setScrollContainer(this.scrollContainerRef.current),this.insertMenuRef.current&&this.insertMenuRef.current.setScrollContainer(this.scrollContainerRef.current))}componentDidUpdate(e,t,s){if(this.props.document!==e.document){const e=this.valueFromProps();this.setState({blockCount:Object(v.a)(e),value:e})}}componentWillUnmount(){this.xhr&&this.xhr.abort()}componentWillUpdate(){this.cache={}}render(){const e="beatmap-discussion-editor",t=this.props.editMode?["edit-mode"]:[];return this.state.posting&&t.push("readonly"),this.updateDrafts(),l.createElement("div",{className:osu.classWithModifiers(e,t)},l.createElement("div",{className:`${e}__content`},l.createElement(E.a.Provider,{value:this.slateEditor},l.createElement(d.c,{editor:this.slateEditor,onChange:this.onChange,value:this.state.value},l.createElement("div",{ref:this.scrollContainerRef,className:`${e}__input-area`},l.createElement(g.a,{ref:this.toolbarRef}),l.createElement(y.a,{ref:this.insertMenuRef,currentBeatmap:this.props.currentBeatmap}),l.createElement(f.a.Provider,{value:this.cache.draftEmbeds||[]},l.createElement(d.a,{decorate:this.decorateTimestamps,onKeyDown:this.onKeyDown,placeholder:osu.trans("beatmaps.discussions.message_placeholder.review"),readOnly:this.state.posting,renderElement:this.renderElement,renderLeaf:this.renderLeaf}))),this.props.editMode&&l.createElement("div",{className:`${e}__inner-block-count`},this.renderBlockCount("lighter")),!this.props.editMode&&l.createElement("div",{className:`${e}__button-bar`},l.createElement("button",{className:"btn-osu-big btn-osu-big--forum-secondary",disabled:this.state.posting,onClick:this.resetInput,type:"button"},osu.trans("common.buttons.clear")),l.createElement("div",null,l.createElement("span",{className:`${e}__block-count`},this.renderBlockCount()),l.createElement("button",{className:"btn-osu-big btn-osu-big--forum-primary",disabled:!this.canSave,onClick:this.post,type:"submit"},this.state.posting?l.createElement(p.a,null):osu.trans("common.buttons.post"))))))))}valueFromProps(){return this.props.editing&&null!=this.props.document&&null!=this.props.discussions?Object(_.a)(this.props.document,this.props.discussions):[]}}O.contextType=w.a,O.defaultProps={editing:!1}}).call(this,s("5wds"))},ukW2:function(e,t,s){"use strict";s.d(t,"a",(function(){return r}));var o,i=s("/G9H"),n=s("I8Ok");i.createElement,o="beatmap-discussion-system-post";var r=function(e){var t,s;return t=function(){switch(e.post.message.type){case"resolved":return osu.trans("beatmap_discussions.system.resolved."+e.post.message.value,{user:osu.link(laroute.route("users.show",{user:e.user.id}),e.user.username,{classNames:[o+"__user"]})})}}(),s=o+" "+o+"--"+e.post.message.type,e.post.deleted_at&&(s+=" "+o+"--deleted"),Object(n.div)({className:s},Object(n.div)({className:o+"__content",dangerouslySetInnerHTML:{__html:t}}))}},va1x:function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return c}));var o=s("bpgk"),i=s("WLnA"),n=s("UZmH"),r=s("0h6b"),a=s("EaLk"),l=function(e,t,s,o){var i,n=arguments.length,r=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,s):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,s,o);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(r=(n<3?i(r):n>3?i(t,s,r):i(t,s))||r);return n>3&&r&&Object.defineProperty(t,s,r),r};let c=class{constructor(e){this.beatmapsetStore=e,this.recommendedDifficulties=new Map,this.resultSets=new Map}cancel(){this.xhr&&this.xhr.abort()}get(e,t=0){if(t<0)throw Error("from must be > 0");const s=e.toKeyString(),o=this.getOrCreate(s);return t>0&&t<o.beatmapsetIds.size||0===t&&!o.isExpired?Promise.resolve(o):this.fetch(e,t).then(s=>(null!=s&&Object(a.o)(()=>{0===t&&o.reset(),this.updateBeatmapsetStore(s),o.append(s),this.recommendedDifficulties.set(e.mode,s.recommended_difficulty)}),o))}getResultSet(e){const t=e.toKeyString();return this.getOrCreate(t)}handleDispatchAction(e){(e instanceof o.a||e instanceof o.b)&&this.clear()}initialize(e,t){this.updateBeatmapsetStore(t);const s=e.toKeyString(),o=this.getOrCreate(s);null==o.fetchedAt&&(o.append(t),this.recommendedDifficulties.set(e.mode,t.recommended_difficulty))}clear(){this.resultSets.clear(),this.recommendedDifficulties.clear()}fetch(t,s){this.cancel();const o=t.queryParams,i=t.toKeyString(),n=this.getOrCreate(i).cursor;if(s>0)if(null!=n)o.cursor=n;else if(null===n)return Promise.resolve(null);const a=Object(r.route)("beatmapsets.search");return this.xhr=e.ajax(a,{data:o,dataType:"json",method:"get"}),this.xhr}getOrCreate(e){let t=this.resultSets.get(e);return null==t&&(t=new n.a,this.resultSets.set(e,t)),t}updateBeatmapsetStore(e){for(const t of e.beatmapsets)this.beatmapsetStore.update(t)}};l([a.m],c.prototype,"recommendedDifficulties",void 0),l([a.m],c.prototype,"resultSets",void 0),l([a.d],c.prototype,"get",null),l([a.d],c.prototype,"initialize",null),l([a.d],c.prototype,"clear",null),c=l([i.b],c)}).call(this,s("5wds"))},vcN5:function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return n}));var o=s("/G9H"),i=s("WKXC");class n extends o.PureComponent{constructor(t){super(t),this.addPortal=()=>document.body.appendChild(this.container),this.componentWillUnmount=()=>{this.removePortal(),e(document).off(`turbolinks:before-cache.${this.uuid}`)},this.removePortal=()=>{this.container.parentElement===document.body&&document.body.removeChild(this.container)},this.render=()=>Object(i.createPortal)(this.props.children,this.container),this.uuid=osu.uuid(),this.container=document.createElement("div")}componentDidMount(){this.addPortal(),e(document).on(`turbolinks:before-cache.${this.uuid}`,this.removePortal)}}}).call(this,s("5wds"))},vp2U:function(e,t,s){"use strict";s.d(t,"a",(function(){return i}));var o=s("/G9H");function i(e){return null==e.score.best_id?o.createElement("span",{title:osu.trans("scores.status.non_best")},"-"):null==e.score.pp?o.createElement("span",{className:"fas fa-exclamation-triangle",title:osu.trans("scores.status.processing")}):o.createElement("span",{title:osu.formatNumber(e.score.pp)},osu.formatNumber(Math.round(e.score.pp)),e.suffix)}},vt1Y:function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return p}));var o,i=s("SYsv"),n=s("/G9H"),r=s("I8Ok"),a=s("Ncbg"),l=s("mk7q"),c=s("+FrL"),u=function(e,t){return function(){return e.apply(t,arguments)}},d={}.hasOwnProperty;o=n.createElement;var p=function(t){function s(){return this.render=u(this.render,this),s.__super__.constructor.apply(this,arguments)}return function(e,t){for(var s in t)d.call(t,s)&&(e[s]=t[s]);function o(){this.constructor=e}o.prototype=t.prototype,e.prototype=new o,e.__super__=t.prototype}(s,t),s.prototype.render=function(){var t,s,n,u;return Object(r.div)({className:"page-extra"},o(i.a,{name:this.props.name,withEdit:this.props.withEdit}),Object(r.div)({className:"kudosu-box"},o(c.a,{modifiers:["kudosu"],label:osu.trans("users.show.extra.kudosu.total"),value:osu.formatNumber(this.props.user.kudosu.total),description:o(l.a,{mappings:{":link":Object(r.a)({href:laroute.route("wiki.show",{path:"Kudosu",locale:currentLocale}),key:"link"},osu.trans("users.show.extra.kudosu.total_info.link"))},pattern:osu.trans("users.show.extra.kudosu.total_info._")})})),(null!=(u=this.props.recentlyReceivedKudosu)?u.length:void 0)?Object(r.ul)({className:"profile-extra-entries profile-extra-entries--kudosu"},function(){var o,i,a,l,c,u,d,p;for(p=[],o=0,i=(a=this.props.recentlyReceivedKudosu).length;o<i;o++)null!=(s=a[o]).id&&(t=null!=s.giver?osu.link(s.giver.url,s.giver.username):e.escape(osu.trans("users.deleted")),n=null!=(null!=(l=s.post)?l.url:void 0)?osu.link(null!=(c=s.post)?c.url:void 0,null!=(u=s.post)?u.title:void 0):null!=(d=s.post)?d.title:void 0,p.push(Object(r.li)({key:"kudosu-"+s.id,className:"profile-extra-entries__item"},Object(r.div)({className:"profile-extra-entries__detail"},Object(r.div)({className:"profile-extra-entries__text",dangerouslySetInnerHTML:{__html:osu.trans("users.show.extra.kudosu.entry."+s.model+"."+s.action,{amount:"<strong class='profile-extra-entries__kudosu-amount'>"+osu.trans("users.show.extra.kudosu.entry.amount",{amount:Math.abs(s.amount)})+"</strong>",giver:t,post:n})}})),Object(r.div)({className:"profile-extra-entries__time",dangerouslySetInnerHTML:{__html:osu.timeago(s.created_at)}}))));return p}.call(this),Object(r.li)({className:"profile-extra-entries__item"},o(a.a,{modifiers:["profile-page","t-greyseafoam-dark"],event:"profile:showMore",hasMore:this.props.pagination.recentlyReceivedKudosu.hasMore,loading:this.props.pagination.recentlyReceivedKudosu.loading,data:{name:"recentlyReceivedKudosu",url:laroute.route("users.kudosu",{user:this.props.user.id})}}))):Object(r.div)({className:"profile-extra-entries profile-extra-entries--kudosu"},osu.trans("users.show.extra.kudosu.entry.empty")))},s}(n.Component)}).call(this,s("Hs9Z"))},w9NC:function(e,t,s){"use strict";(function(e,o,i){s.d(t,"a",(function(){return h}));var n,r,a=s("EaLk"),l=s("cF9b"),c=s("f4vq"),u=function(e,t){return function(){return e.apply(t,arguments)}},d={}.hasOwnProperty,p=[].indexOf||function(e){for(var t=0,s=this.length;t<s;t++)if(t in this&&this[t]===e)return t;return-1};r=c.a.dataStore.uiState,n=e.createElement;var h=function(e){function t(e){var s,o;this.updateSort=u(this.updateSort,this),this.toggleFollow=u(this.toggleFollow,this),this.toggleShowDeleted=u(this.toggleShowDeleted,this),this.saveState=u(this.saveState,this),this.jsonStorageId=u(this.jsonStorageId,this),this.handleCommentUpdated=u(this.handleCommentUpdated,this),this.handleCommentsNew=u(this.handleCommentsNew,this),this.handleCommentsAdded=u(this.handleCommentsAdded,this),this.render=u(this.render,this),this.componentWillUnmount=u(this.componentWillUnmount,this),this.componentDidMount=u(this.componentDidMount,this),t.__super__.constructor.call(this,e),null!=e.commentableType&&null!=e.commentableId&&(null!=(s=osu.parseJson("json-comments-"+e.commentableType+"-"+e.commentableId,!0))&&(c.a.dataStore.updateWithCommentBundleJson(s),r.initializeWithCommentBundleJson(s)),null!=(o=osu.parseJson(this.jsonStorageId()))&&r.importCommentsUIState(o)),this.id="comments-"+osu.uuid()}return function(e,t){for(var s in t)d.call(t,s)&&(e[s]=t[s]);function o(){this.constructor=e}o.prototype=t.prototype,e.prototype=new o,e.__super__=t.prototype}(t,e),t.prototype.SORTS=["new","old","top"],t.prototype.componentDidMount=function(){return o.subscribe("comments:added."+this.id,this.handleCommentsAdded),o.subscribe("comments:new."+this.id,this.handleCommentsNew),o.subscribe("comments:sort."+this.id,this.updateSort),o.subscribe("comments:toggle-show-deleted."+this.id,this.toggleShowDeleted),o.subscribe("comments:toggle-follow."+this.id,this.toggleFollow),o.subscribe("comment:updated."+this.id,this.handleCommentUpdated),o(document).on("turbolinks:before-cache."+this.id,this.saveState)},t.prototype.componentWillUnmount=function(){return o.unsubscribe("."+this.id)},t.prototype.render=function(){return n(l.a,null,(e=this,function(){var t;return(t=i.assign({},e.props.componentProps)).commentableId=e.props.commentableId,t.commentableType=e.props.commentableType,t.user=e.props.user,n(e.props.component,t)}));var e},t.prototype.handleCommentsAdded=function(e,t){return Object(a.o)((function(){return c.a.dataStore.updateWithCommentBundleJson(t),r.updateFromCommentsAdded(t)}))},t.prototype.handleCommentsNew=function(e,t){return Object(a.o)((function(){return c.a.dataStore.updateWithCommentBundleJson(t),r.updateFromCommentsNew(t)}))},t.prototype.handleCommentUpdated=function(e,t){return Object(a.o)((function(){return c.a.dataStore.updateWithCommentBundleJson(t),r.updateFromCommentUpdated(t)}))},t.prototype.jsonStorageId=function(){return"json-comments-manager-state-"+this.props.commentableType+"-"+this.props.commentableId},t.prototype.saveState=function(){if(null!=this.props.commentableType&&null!=this.props.commentableId)return osu.storeJson(this.jsonStorageId(),r.exportCommentsUIState())},t.prototype.toggleShowDeleted=function(){return r.toggleShowDeletedComments()},t.prototype.toggleFollow=function(){var e;if(e={follow:{notifiable_type:this.props.commentableType,notifiable_id:this.props.commentableId,subtype:"comment"}},!r.comments.loadingFollow)return r.comments.loadingFollow=!0,o.ajax(laroute.route("follows.store"),{data:e,dataType:"json",method:r.comments.userFollow?"DELETE":"POST"}).always((function(){return r.comments.loadingFollow=!1})).done((function(){return r.comments.userFollow=!r.comments.userFollow})).fail((function(e,t){if("abort"!==t)return osu.ajaxError(e)}))},t.prototype.updateSort=function(e,t){var s,i;if(i=t.sort,this.props.commentableType&&this.props.commentableId&&!(p.call(this.SORTS,i)<0))return Object(a.o)((function(){return r.comments.loadingSort=i})),s={commentable_type:this.props.commentableType,commentable_id:this.props.commentableId,sort:i,parent_id:0},o.ajax(laroute.route("comments.index"),{data:s,dataType:"json"}).done((function(e){return o.ajax(laroute.route("account.options"),{method:"PUT",data:{user_profile_customization:{comments_sort:i}}}),Object(a.o)((function(){return c.a.dataStore.commentStore.flushStore(),c.a.dataStore.updateWithCommentBundleJson(e),r.initializeWithCommentBundleJson(e)}))})).always((function(){return Object(a.o)((function(){return r.comments.loadingSort=null}))}))},t}(e.PureComponent)}).call(this,s("/G9H"),s("5wds"),s("Hs9Z"))},xmnK:function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return n}));var o=s("iRgH"),i=s("WLnA");class n{constructor(){this.focusChange=e=>{"focus"===e.type?Object(i.a)(new o.b):Object(i.a)(new o.a)},e(window).on("blur focus",this.focusChange)}}}).call(this,s("5wds"))},y2EG:function(e,t,s){"use strict";s.d(t,"a",(function(){return c}));var o=s("Hs9Z"),i=s("EaLk"),n=s("71br"),r=s("5evE");var a=s("f4vq"),l=function(e,t,s,o){var i,n=arguments.length,r=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,s):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,s,o);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(r=(n<3?i(r):n>3?i(t,s,r):i(t,s))||r);return n>3&&r&&Object.defineProperty(t,s,r),r};class c{constructor(e,t){this.id=e,this.objectType=t,this.details=Object(n.a)(),this.isDeleting=!1,this.isMarkingAsRead=!1,this.isRead=!1,this.updateFromJson=e=>{var t;return this.createdAtJson=e.created_at,this.isRead=e.is_read,this.name=e.name,this.objectId=e.object_id,this.sourceUserId=e.source_user_id,this.details=Object(n.a)(),"object"==typeof e.details&&(Object(o.forEach)(e.details,(e,t)=>{this.details[Object(o.camelCase)(t)]=e}),"comment_new"===e.name&&(null===(t=e.details.reply_to)||void 0===t?void 0:t.user_id)===currentUser.id&&(this.name="comment_reply")),this}}get canMarkRead(){return this.id>0&&!this.isRead}get category(){var e;return Object(r.a)(null!==(e=this.name)&&void 0!==e?e:"")}get categoryGroupKey(){return Object(r.b)(this)}get displayType(){return"legacy_pm"===(e=this).name?"legacy_pm":null!=e.objectType&&null!=e.objectId?"user_achievement_unlock"===e.name?"user_achievement":e.objectType:void 0;var e}get identity(){return{category:this.category,id:this.id,objectId:this.objectId,objectType:this.objectType}}get stackId(){return`${this.objectType}-${this.objectId}-${this.category}`}get title(){var e,t;return(null===(e=a.a.currentUser)||void 0===e?void 0:e.user_preferences.beatmapset_title_show_original)&&null!==(t=osu.presence(this.details.titleUnicode))&&void 0!==t?t:this.details.title}static fromJson(e){return new c(e.id,e.object_type).updateFromJson(e)}}l([i.m],c.prototype,"isDeleting",void 0),l([i.m],c.prototype,"isMarkingAsRead",void 0),l([i.m],c.prototype,"isRead",void 0),l([i.e],c.prototype,"canMarkRead",null),l([i.e],c.prototype,"category",null),l([i.e],c.prototype,"categoryGroupKey",null),l([i.e],c.prototype,"displayType",null),l([i.e],c.prototype,"stackId",null),l([i.e],c.prototype,"title",null)},yJmy:function(e,t,s){"use strict";s.d(t,"a",(function(){return c}));var o=s("+AAq"),i=s("/G9H"),n=s("tSlR"),r=s("dTpI"),a=s("TezV"),l=s("ss8h");class c extends i.Component{constructor(){super(...arguments),this.select=e=>{const t="all"!==e?parseInt(e,10):void 0,s=r.b.findPath(this.context,this.props.element);n.h.setNodes(this.context,{beatmapId:t},{at:s})}}render(){var e;const t=[];return t.push({icon:i.createElement("i",{className:"fas fa-fw fa-star-of-life"}),id:"all",label:osu.trans("beatmaps.discussions.mode.scopes.generalAll")}),this.props.beatmaps.forEach(e=>{e.deleted_at||t.push({icon:i.createElement(o.a,{beatmap:e,showTitle:!1}),id:e.id.toString(),label:e.version})}),i.createElement(a.a,{disabled:this.props.disabled,menuOptions:t,onSelect:this.select,selected:null===(e=this.props.element.beatmapId)||void 0===e?void 0:e.toString()})}}c.contextType=l.a},yun6:function(e,t,s){"use strict";(function(e){s.d(t,"g",(function(){return n})),s.d(t,"b",(function(){return r})),s.d(t,"a",(function(){return a})),s.d(t,"d",(function(){return l})),s.d(t,"c",(function(){return c})),s.d(t,"e",(function(){return u})),s.d(t,"f",(function(){return d})),s.d(t,"h",(function(){return p})),s.d(t,"i",(function(){return h}));var o=s("cp7W"),i=s("Hs9Z");const n=["osu","taiko","fruits","mania"];function r(t){var s,a;if(null!=t.items){let r,l=null;const c=function(t){var s,o;null==f&&(f=null!==(s=osu.parseJson("json-recommended-star-difficulty-all"))&&void 0!==s?s:{},e(document).one("turbolinks:before-cache",()=>{f=null}));return null!==(o=f[t])&&void 0!==o?o:1}(null!==(s=t.mode)&&void 0!==s?s:n[0]);return t.items.forEach(e=>{const t=Math.abs(e.difficulty_rating-c);(function(e){return!Object(o.a)(e)||null==e.deleted_at&&!e.convert})(e)&&(null==r||t<r)&&(r=t,l=e)}),null!==(a=null!=l?l:i.last(t.items))&&void 0!==a?a:null}if(null==t.group)return null;const l=null==t.mode?m():[t.mode];for(const e of l){const s=r({items:t.group[e],mode:e});if(null!=s)return s}return null}function a(e){var t;const s=null==e.mode?m():[e.mode];for(const o of s){const s=(null!==(t=e.group[o])&&void 0!==t?t:[]).find(t=>t.id===e.id);if(null!=s)return s}return null}function l(e){return e<2?"easy":e<2.7?"normal":e<4?"hard":e<5.3?"insane":e<6.5?"expert":"expert-plus"}function c(e){var t;return(null===(t=null===currentUser||void 0===currentUser?void 0:currentUser.user_preferences)||void 0===t?void 0:t.beatmapset_title_show_original)?e.artist_unicode:e.artist}function u(e){var t;return(null===(t=null===currentUser||void 0===currentUser?void 0:currentUser.user_preferences)||void 0===t?void 0:t.beatmapset_title_show_original)?e.title_unicode:e.title}function d(e){const t=i.groupBy(e,"mode");return i.forOwn(t,(e,s)=>{t[s]=function(e){if(0===e.length)return[];if("mania"===e[0].mode)return i.orderBy(e,["convert","cs","difficulty_rating"],["desc","asc","asc"]);return i.orderBy(e,["convert","difficulty_rating"],["desc","asc"])}(e)}),t}function p(e){return"ranked"===e.status||"approved"===e.status}function h(e){const t=d(e);return i.flatten(n.map(e=>t[e]||[]))}function m(){const e=currentUser.playmode;if(null==e||!n.includes(e))return n;const t=i.without(n,e);return t.unshift(e),t}let f=null}).call(this,s("5wds"))},zFzD:function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return u}));var o=s("UZmH"),i=s("WD1s"),n=s("0h6b"),r=s("Hs9Z"),a=s("EaLk"),l=function(e,t,s,o){var i,n=arguments.length,r=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,s):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,s,o);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(r=(n<3?i(r):n>3?i(t,s,r):i(t,s))||r);return n>3&&r&&Object.defineProperty(t,s,r),r},c=function(e,t,s,o){return new(s||(s=Promise))((function(i,n){function r(e){try{l(o.next(e))}catch(t){n(t)}}function a(e){try{l(o.throw(e))}catch(t){n(t)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(r,a)}l((o=o.apply(e,t||[])).next())}))};class u{constructor(e){this.beatmapsetSearch=e,this.advancedSearch=!1,this.currentResultSet=new o.a,this.searchStatus={error:null,from:0,state:"completed"},this.debouncedFilterChangedSearch=Object(r.debounce)(this.filterChangedSearch,500),this.filterChangedHandler=e=>{const t=e;t.oldValue!==t.newValue&&("sort"===e.name&&null==t.newValue||(this.searchStatus.state="input",this.debouncedFilterChangedSearch(),"query"!==e.name&&this.debouncedFilterChangedSearch.flush()))}}get currentBeatmapsetIds(){return[...this.currentResultSet.beatmapsetIds]}get error(){return this.searchStatus.error}get hasMore(){return this.currentResultSet.hasMoreForPager}get isBusy(){return"searching"===this.searchStatus.state||"input"===this.searchStatus.state}get isPaging(){return"paging"===this.searchStatus.state}get isSupporterMissing(){return!currentUser.is_supporter&&BeatmapsetFilter.supporterRequired(this.filters).length>0}get recommendedDifficulty(){return this.beatmapsetSearch.recommendedDifficulties.get(this.filters.mode)}get supporterRequiredFilterText(){const e=BeatmapsetFilter.supporterRequired(this.filters),t=Object(r.map)(e,e=>osu.trans(`beatmaps.listing.search.filters.${e}`));return osu.transArray(t)}cancel(){this.debouncedFilterChangedSearch.cancel(),this.beatmapsetSearch.cancel()}initialize(e){this.restoreStateFromUrl(),this.beatmapsetSearch.initialize(this.filters,e),this.initialErrorMessage=e.error}loadMore(){!this.isBusy&&this.hasMore&&this.search(this.currentResultSet.beatmapsetIds.size)}restoreTurbolinks(){this.restoreStateFromUrl(),this.search(0,!0),null!=this.initialErrorMessage&&(osu.popup(this.initialErrorMessage,"danger"),delete this.initialErrorMessage)}search(e=0,t=!1){return c(this,void 0,void 0,(function*(){if(this.isSupporterMissing||e<0)return void(this.searchStatus={state:"completed",error:null,from:e,restore:t});let s;this.searchStatus={from:0,restore:t,state:0===e?"searching":"paging"};try{yield this.beatmapsetSearch.get(this.filters,e)}catch(o){s=0!==o.readyState?o:null}Object(a.o)(()=>{this.searchStatus={state:"completed",error:s,from:e,restore:t},this.currentResultSet=this.beatmapsetSearch.getResultSet(this.filters)})}))}updateFilters(e){this.filters.update(e)}filterChangedSearch(){const t=Object(n.route)("beatmapsets.index",this.filters.queryParams);e.controller.advanceHistory(t),this.search()}restoreStateFromUrl(){const e=BeatmapsetFilter.filtersFromUrl(location.href);null!=this.filtersObserver&&this.filtersObserver(),this.filters=new i.a(location.href),this.filtersObserver=Object(a.n)(this.filters,this.filterChangedHandler),this.isExpanded=Object(r.intersection)(Object.keys(e),BeatmapsetFilter.expand).length>0}}l([a.m],u.prototype,"advancedSearch",void 0),l([a.m],u.prototype,"currentResultSet",void 0),l([a.m],u.prototype,"filters",void 0),l([a.m],u.prototype,"isExpanded",void 0),l([a.m],u.prototype,"searchStatus",void 0),l([a.e],u.prototype,"currentBeatmapsetIds",null),l([a.e],u.prototype,"error",null),l([a.e],u.prototype,"hasMore",null),l([a.e],u.prototype,"isBusy",null),l([a.e],u.prototype,"isPaging",null),l([a.e],u.prototype,"isSupporterMissing",null),l([a.e],u.prototype,"recommendedDifficulty",null),l([a.e],u.prototype,"supporterRequiredFilterText",null),l([a.d],u.prototype,"cancel",null),l([a.d],u.prototype,"loadMore",null),l([a.d],u.prototype,"restoreTurbolinks",null),l([a.d],u.prototype,"search",null),l([a.d],u.prototype,"updateFilters",null),l([a.d],u.prototype,"restoreStateFromUrl",null)}).call(this,s("dMdw"))},zr5c:function(e,t,s){"use strict";s.d(t,"a",(function(){return u}));var o=s("/G9H"),i=s("tSlR"),n=s("dTpI"),r=s("TezV"),a=s("ss8h");const l=["praise","problem","suggestion"],c={hype:"fas fa-fw fa-bullhorn",mapperNote:"far fa-fw fa-sticky-note",praise:"fas fa-fw fa-heart",problem:"fas fa-fw fa-exclamation-circle",suggestion:"far fa-fw fa-circle"};class u extends o.Component{constructor(){super(...arguments),this.select=e=>{const t=n.b.findPath(this.context,this.props.element);i.h.setNodes(this.context,{discussionType:e},{at:t})}}render(){const e=l.map(e=>({icon:o.createElement("span",{className:`beatmap-discussion-message-type beatmap-discussion-message-type--${e}`},o.createElement("i",{className:`${c[e]}`})),id:e,label:osu.trans(`beatmaps.discussions.message_type.${e}`)}));return o.createElement(r.a,{disabled:this.props.disabled,menuOptions:e,onSelect:this.select,selected:this.props.element.discussionType})}}u.contextType=a.a}}]);
//# sourceMappingURL=commons.657ca4a2.js.map